% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analytical_functions.R
\name{segment_mobility_analysis}
\alias{segment_mobility_analysis}
\title{Segment-Level Mobility Analysis}
\usage{
segment_mobility_analysis(
  moneca_results,
  enhanced_membership,
  level_selection = "auto",
  plot_layout = "fr",
  plot_node_color = "mobility_rate",
  node_size_metric = "strength"
)
}
\arguments{
\item{moneca_results}{A MONECA object returned by \code{\link{moneca}} or \code{moneca_fast}.}

\item{enhanced_membership}{A data frame returned by \code{\link{segment.membership.enhanced}}
containing segment membership information with level names.}

\item{level_selection}{Character string or integer specifying which level to analyze:
\itemize{
  \item "auto" (default): Automatically select the level with meaningful segment names
  \item "max": Use the maximum available level
  \item integer: Use specific level number
}}

\item{plot_layout}{Character string specifying the network layout for visualization.
Options include "fr" (Fruchterman-Reingold), "kk" (Kamada-Kawai), "stress", 
"circle", "grid", "tree". Default is "fr".}

\item{plot_node_color}{Character string specifying what metric to use for node coloring:
\itemize{
  \item "mobility_rate": Color by mobility rate (default)
  \item "centrality": Color by total strength centrality
  \item "net_flow": Color by net flow (red = outflow, blue = inflow)
  \item "segment": Use discrete colors for each segment
}}

\item{node_size_metric}{Character string specifying what metric determines node size.
Options: "strength", "mobility_rate", "population", "constant". Default is "strength".}
}
\value{
A list with the following components:
  \describe{
    \item{segment_matrix}{Square matrix of aggregated mobility flows between segments}
    \item{mobility_metrics}{Data frame with mobility rates, net flows, and directional 
      mobility measures for each segment}
    \item{centrality_metrics}{Data frame with various centrality measures (degree, 
      strength, betweenness, eigenvector, PageRank) for each segment}
    \item{segment_plot}{ggplot object showing the segment network visualization}
    \item{metadata}{List containing analysis metadata including level used, 
      number of segments, and analysis parameters}
  }
}
\description{
Performs focused analysis on the final segmentation level from MONECA results,
extracting the aggregated matrix at the maximum level with meaningful segment
names and computing comprehensive mobility and centrality metrics for each segment.
}
\details{
This function focuses specifically on segment-level analysis by:
\enumerate{
  \item Identifying the optimal analysis level based on meaningful segment names
  \item Extracting the aggregated mobility matrix at that level
  \item Computing comprehensive mobility metrics including mobility rates, 
    net flows, and directional mobility patterns
  \item Calculating network centrality measures for segments
  \item Generating a publication-quality network visualization
}

The mobility metrics include:
\itemize{
  \item \strong{Mobility rate}: Proportion of individuals moving out of segment
  \item \strong{Net flow}: Difference between inflow and outflow (positive = net immigration)
  \item \strong{Directional mobility}: Upward, downward, and lateral mobility flows
  \item \strong{Relative mobility share}: Segment's contribution to total mobility
}

The centrality metrics include degree, strength, betweenness, closeness, 
eigenvector centrality, and PageRank, providing comprehensive measures of 
each segment's structural importance in the mobility network.
}
\examples{
# Generate synthetic data and run MONECA analysis
mobility_data <- generate_mobility_data(n_classes = 6, seed = 42)
seg <- moneca(mobility_data, segment.levels = 3)

# Get enhanced membership information
enhanced <- segment.membership.enhanced(seg)

# Perform segment-level analysis
analysis <- segment_mobility_analysis(seg, enhanced)

# Examine results
print(analysis$mobility_metrics)
print(analysis$centrality_metrics)
print(analysis$segment_plot)

# Analyze specific level
analysis_level2 <- segment_mobility_analysis(seg, enhanced, level_selection = 2)

# Custom visualization options
analysis_custom <- segment_mobility_analysis(seg, enhanced, 
                                            plot_layout = "stress",
                                            plot_node_color = "net_flow",
                                            node_size_metric = "mobility_rate")

}
\seealso{
\code{\link{moneca}} for the main analysis function,
\code{\link{segment.membership.enhanced}} for enhanced membership information,
\code{\link{moneca_comprehensive_analysis}} for multi-level comparative analysis
}
