% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/modern_plotting.R
\name{plot_ego_ggraph}
\alias{plot_ego_ggraph}
\title{Ego Network Visualization with ggraph}
\usage{
plot_ego_ggraph(
  segments,
  mobility_matrix,
  ego_id,
  min_weight = 0,
  layout = "stress",
  highlight_color = "red",
  flow_color = "viridis",
  node_size_range = c(2, 8),
  edge_width_range = c(0.2, 3),
  title = NULL,
  segment_naming = "auto",
  ...
)
}
\arguments{
\item{segments}{A moneca object returned by \code{\link{moneca}}.}

\item{mobility_matrix}{The original mobility matrix used in the moneca analysis.
Should include row and column totals.}

\item{ego_id}{Integer or character specifying the focal node. Can be:
\itemize{
  \item Integer: Row/column index in the mobility matrix
  \item Character: Row/column name from the mobility matrix
}}

\item{min_weight}{Numeric threshold for minimum edge weight to include nodes.
Only nodes connected to the ego with edge weights >= min_weight will be shown.
Default is 0 (show all connected nodes). Use higher values to focus on 
stronger mobility flows.}

\item{layout}{Character string specifying the layout algorithm. Default is "stress"
which often works well for ego networks. Other options include "fr", "kk", "dh".}

\item{highlight_color}{Color for the ego (focal) node. Default is "red".}

\item{flow_color}{Character string specifying the color scheme for mobility flows.
Default is "viridis". Can be any viridis variant ("viridis", "plasma", "inferno", etc.).}

\item{node_size_range}{Numeric vector of length 2 specifying the range for node sizes.
Default is c(3, 12).}

\item{edge_width_range}{Numeric vector of length 2 specifying the range for edge widths.
Default is c(0.5, 3).}

\item{title}{Character string for plot title. Default is NULL.}

\item{segment_naming}{Specifies how to name segments in the visualization. Can be:
\itemize{
  \item Character string: "auto" (default), "concat", "pattern", or "custom" - 
    these are passed to \code{\link{segment.membership.enhanced}} for automatic naming
  \item data.frame: Custom segment labels with columns "name" (node names from the 
    mobility matrix) and "segment_label" (desired custom labels). This allows complete 
    control over segment naming
  \item NULL: Uses default "auto" strategy
}
When a data.frame is provided, custom labels override automatically generated names.
The data.frame approach is useful for meaningful business names or multilingual applications.}

\item{...}{Additional arguments passed to the ggraph layout function.}
}
\value{
A ggplot2 object showing the ego network visualization.
}
\description{
Creates focused visualizations of mobility patterns from a single focal node
(ego). This function shows all incoming and outgoing mobility flows for a
specific category, making it ideal for understanding individual position dynamics.
}
\details{
Ego networks are particularly useful for understanding the mobility patterns
of specific social positions. The visualization highlights:
\itemize{
  \item The focal position (ego) in a distinct color
  \item Incoming mobility flows (edges pointing to ego)
  \item Outgoing mobility flows (edges from ego)
  \item The relative strength of different flows through edge width and color
}

Only non-zero mobility flows are displayed to reduce visual clutter.
Edge colors and widths are scaled to represent the volume of mobility flows.
}
\examples{
# Generate synthetic data and run MONECA
mobility_data <- generate_mobility_data(n_classes = 6, seed = 123)
seg <- moneca(mobility_data, segment.levels = 3)

# Ego network for the middle category (index 3)
plot_ego_ggraph(seg, mobility_data, ego_id = 3, 
                title = "Mobility from Middle Class")

# Ego network using category name (if available)
if (!is.null(rownames(mobility_data))) {
  plot_ego_ggraph(seg, mobility_data, ego_id = rownames(mobility_data)[1])
}

# Focus on strong mobility flows only (weight >= 10)
plot_ego_ggraph(seg, mobility_data, 
                ego_id = 2,
                min_weight = 10,
                title = "Strong Mobility Flows")

# Customized ego plot
plot_ego_ggraph(seg, mobility_data, 
                ego_id = 2,
                layout = "fr",
                highlight_color = "orange",
                flow_color = "plasma",
                edge_width_range = c(1, 5),
                title = "Professional Class Mobility")

# Ego plot with custom segment labels
job_labels <- data.frame(
  name = rownames(mobility_data)[-nrow(mobility_data)],
  segment_label = c("CEO", "Director", "Manager", 
                    "Analyst", "Coordinator", "Assistant")[1:length(rownames(mobility_data)[-nrow(mobility_data)])],
  stringsAsFactors = FALSE
)

plot_ego_ggraph(seg, mobility_data, 
                ego_id = 1,
                segment_naming = job_labels,
                title = "CEO Mobility Network with Job Titles")

}
\seealso{
\code{\link{plot_moneca_ggraph}} for full network visualization,
\code{\link{plot_stair_ggraph}} for multi-level visualization,
\code{\link{moneca}} for the main analysis function
}
