<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Log-Linear Models for Professional Mobility: An Application to Italian Occupational Data ‚Ä¢ moneca</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Log-Linear Models for Professional Mobility: An Application to Italian Occupational Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">moneca</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/moneca-introduction.html">Introduction to moneca: Mobility Network Clustering Analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="dropdown-item" href="https://gmontaletti.github.io/MONECA/news/index.html#moneca-105">Version 1.0.5</a></li>
    <li><a class="dropdown-item" href="https://gmontaletti.github.io/MONECA/news/index.html#moneca-100">Version 1.0.0</a></li>
    <li><a class="dropdown-item" href="https://gmontaletti.github.io/MONECA/news/index.html#moneca-09">Version 0.9</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gmontaletti/MONECA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Log-Linear Models for Professional Mobility: An Application to Italian Occupational Data</h1>
                        <h4 data-toc-skip class="author">Giampaolo
Montaletti</h4>
            
            <h4 data-toc-skip class="date">2026-02-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/gmontaletti/MONECA/blob/master/vignettes/loglinear-profession-mobility.Rmd" class="external-link"><code>vignettes/loglinear-profession-mobility.Rmd</code></a></small>
      <div class="d-none name"><code>loglinear-profession-mobility.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This document presents a log-linear model analysis of an Italian
professional mobility table. The objective is to evaluate how well
different structural models account for the observed patterns of
occupational transitions, and in particular to assess whether the
segmentation produced by the MONECA algorithm identifies statistically
meaningful clusters of professions.</p>
<p>Log-linear models provide a standard framework for analyzing mobility
tables. By fitting a sequence of increasingly complex models ‚Äî from full
independence to structured topology models ‚Äî it is possible to quantify
how much of the association between origin and destination professions
is captured by each specification.</p>
<p>The analysis proceeds in four steps: data preparation, MONECA
segmentation, model fitting, and model comparison.</p>
</div>
<div class="section level2">
<h2 id="data-description">Data Description<a class="anchor" aria-label="anchor" href="#data-description"></a>
</h2>
<p>The data consist of an Italian occupational mobility table derived
from administrative records of the Lombardy region. The original matrix
has 129 rows and 129 columns, corresponding to detailed professional
categories. After removing three armed forces categories, the working
matrix has 126 x 126 cells.</p>
<p>Key characteristics of the data:</p>
<ul>
<li>
<strong>Total observations</strong>: 1,591,811 recorded
transitions</li>
<li>
<strong>Immobility rate</strong>: 50.4% of individuals remain in the
same profession</li>
<li>
<strong>Zero cells</strong>: 5,601 out of 15,876 cells (35.3%)
contain no observed transitions</li>
<li>
<strong>Margins</strong>: Added automatically by
<code><a href="../reference/moneca_fast.html">moneca_fast()</a></code> when not present in the input</li>
</ul>
<p>The high proportion of zero cells indicates that many profession
pairs have no observed transitions. This sparsity is consistent with the
nature of occupational mobility: most professions are not directly
connected through labor market flows. The high immobility rate ‚Äî more
than half of all individuals stay in their current profession ‚Äî is a
central feature of the data that any adequate model must account
for.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Load and prepare data -----</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gmontaletti.github.io/MONECA/">moneca</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">mx_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"profession_matrix_8day.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Remove armed forces (last 3 rows/columns)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mx_raw</span><span class="op">)</span></span>
<span><span class="va">mx</span> <span class="op">&lt;-</span> <span class="va">mx_raw</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">3</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Basic descriptives</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mx</span><span class="op">)</span>, <span class="st">"x"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mx</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Total observations:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">mx</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Immobility rate:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">mx</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">mx</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Zero cells:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">mx</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>, <span class="st">"out of"</span>, <span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">mx</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="moneca-segmentation">MONECA Segmentation<a class="anchor" aria-label="anchor" href="#moneca-segmentation"></a>
</h2>
<p>Before fitting log-linear models, the MONECA algorithm is applied to
the mobility table to identify clusters of professions with high
internal mobility. The <code><a href="../reference/moneca_fast.html">moneca_fast()</a></code> function is used with
NMF-based density reduction (default parameters), which is appropriate
for a matrix of this size given its density level.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 2. Run MONECA with NMF density reduction -----</span></span>
<span><span class="va">seg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca_fast.html">moneca_fast</a></span><span class="op">(</span></span>
<span>  <span class="va">mx</span>,</span>
<span>  segment.levels <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  reduce_density <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  density_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"nmf"</span>, seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">seg</span><span class="op">)</span></span></code></pre></div>
<p>The segmentation produces three hierarchical levels beyond the
base:</p>
<table class="table">
<thead><tr class="header">
<th align="right">Level</th>
<th align="right">Segments</th>
<th align="right">Categories in segments</th>
<th align="right">Unassigned categories</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">126</td>
<td align="right">126</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">32</td>
<td align="right">81</td>
<td align="right">45</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">19</td>
<td align="right">99</td>
<td align="right">27</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">14</td>
<td align="right">106</td>
<td align="right">20</td>
</tr>
</tbody>
</table>
<p>Level 1 is the identity partition: each of the 126 categories forms
its own singleton segment. Level 2, with 32 multi-member segments,
provides the first substantively meaningful grouping: 81 professions are
assigned to segments, while 45 remain unassigned. At Level 3, further
aggregation produces 19 segments covering 99 professions. At Level 4, 14
segments account for 106 of the 126 original categories, leaving 20
unassigned.</p>
<p>These segment assignments serve as the structural topology in the
log-linear models below.</p>
</div>
<div class="section level2">
<h2 id="log-linear-models">Log-Linear Models<a class="anchor" aria-label="anchor" href="#log-linear-models"></a>
</h2>
<p>Five Poisson log-linear models are fitted using
<code>glm(family = poisson)</code>. Each represents a different
hypothesis about the structure of the mobility table.</p>
<div class="section level3">
<h3 id="model-specifications">Model Specifications<a class="anchor" aria-label="anchor" href="#model-specifications"></a>
</h3>
<p><strong>Independence model.</strong> Origin and destination
professions are statistically independent. All off-diagonal flows are
predicted solely from the marginal distributions:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><msub><mi>F</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>Œº</mi><mo>+</mo><msub><mi>Œ±</mi><mi>i</mi></msub><mo>+</mo><msub><mi>Œ≤</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\log F_{ij} = \mu + \alpha_i + \beta_j</annotation></semantics></math></p>
<p><strong>Quasi-independence model.</strong> Origin and destination are
independent conditional on being off-diagonal. A separate parameter is
added for each diagonal cell, allowing the model to account for
immobility without constraining the off-diagonal structure:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><msub><mi>F</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>Œº</mi><mo>+</mo><msub><mi>Œ±</mi><mi>i</mi></msub><mo>+</mo><msub><mi>Œ≤</mi><mi>j</mi></msub><mo>+</mo><msub><mi>Œ¥</mi><mi>i</mi></msub><mo>‚ãÖ</mo><mn>ùüè</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>=</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log F_{ij} = \mu + \alpha_i + \beta_j + \delta_i \cdot \mathbf{1}(i = j)</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ¥</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\delta_i</annotation></semantics></math>
captures the immobility effect for profession
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.</p>
<p><strong>Uniform association model.</strong> A single parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œï</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>
measures the overall strength of association, treating professions as
ordered on an integer scale:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><msub><mi>F</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>Œº</mi><mo>+</mo><msub><mi>Œ±</mi><mi>i</mi></msub><mo>+</mo><msub><mi>Œ≤</mi><mi>j</mi></msub><mo>+</mo><mi>œï</mi><mo>‚ãÖ</mo><msub><mi>u</mi><mi>i</mi></msub><mo>‚ãÖ</mo><msub><mi>v</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\log F_{ij} = \mu + \alpha_i + \beta_j + \phi \cdot u_i \cdot v_j</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>i</mi></msub><mo>=</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">u_i = i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>j</mi></msub><mo>=</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">v_j = j</annotation></semantics></math>
are integer scores.</p>
<p><strong>MONECA topology models.</strong> The segment assignments from
MONECA define a block structure. Within-segment and between-segment
flows receive separate parameters:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><msub><mi>F</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>Œº</mi><mo>+</mo><msub><mi>Œ±</mi><mi>i</mi></msub><mo>+</mo><msub><mi>Œ≤</mi><mi>j</mi></msub><mo>+</mo><msub><mi>Œ¥</mi><mi>i</mi></msub><mo>‚ãÖ</mo><mn>ùüè</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>=</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>Œ≥</mi><mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub></mrow><annotation encoding="application/x-tex">\log F_{ij} = \mu + \alpha_i + \beta_j + \delta_i \cdot \mathbf{1}(i = j) + \gamma_{S(i), S(j)}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">S(i)</annotation></semantics></math>
is the segment assignment of profession
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ≥</mi><mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><annotation encoding="application/x-tex">\gamma_{S(i), S(j)}</annotation></semantics></math>
captures the interaction between segment pairs. Two versions are fitted:
one using Level 2 assignments (32 segments) and one using Level 3
assignments (19 segments).</p>
</div>
<div class="section level3">
<h3 id="code">Code<a class="anchor" aria-label="anchor" href="#code"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3. Fit log-linear models -----</span></span>
<span><span class="va">m_ind</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_mobility_model.html">fit_mobility_model</a></span><span class="op">(</span><span class="va">mx</span>, type <span class="op">=</span> <span class="st">"independence"</span><span class="op">)</span></span>
<span><span class="va">m_qi</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_mobility_model.html">fit_mobility_model</a></span><span class="op">(</span><span class="va">mx</span>, type <span class="op">=</span> <span class="st">"quasi_independence"</span><span class="op">)</span></span>
<span><span class="va">m_ua</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_mobility_model.html">fit_mobility_model</a></span><span class="op">(</span><span class="va">mx</span>, type <span class="op">=</span> <span class="st">"uniform_association"</span><span class="op">)</span></span>
<span><span class="va">m_top2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_mobility_model.html">fit_mobility_model</a></span><span class="op">(</span><span class="va">seg</span>, type <span class="op">=</span> <span class="st">"moneca_topology"</span>, level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">m_top3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_mobility_model.html">fit_mobility_model</a></span><span class="op">(</span><span class="va">seg</span>, type <span class="op">=</span> <span class="st">"moneca_topology"</span>, level <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>Each call returns a <code>moneca_loglinear</code> object containing
the fitted <code>glm</code>, deviance, degrees of freedom, AIC, BIC,
p-value, dissimilarity index, and the fitted/residual matrices reshaped
to the original dimensions.</p>
</div>
<div class="section level3">
<h3 id="model-comparison">Model Comparison<a class="anchor" aria-label="anchor" href="#model-comparison"></a>
</h3>
<p>The following table summarizes the fit statistics for all five
models.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>G</mi><mn>2</mn></msup><annotation encoding="application/x-tex">G^2</annotation></semantics></math>
is the likelihood-ratio deviance (lower indicates better fit). The
dissimilarity index (DI) measures the proportion of cases that would
need to be reclassified to achieve a perfect fit.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 4. Compare models -----</span></span>
<span><span class="va">comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_mobility_models.html">compare_mobility_models</a></span><span class="op">(</span><span class="va">m_ind</span>, <span class="va">m_qi</span>, <span class="va">m_ua</span>, <span class="va">m_top2</span>, <span class="va">m_top3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comp</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="11%">
<col width="30%">
<col width="12%">
<col width="17%">
<col width="17%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left">Model</th>
<th align="right">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>G</mi><mn>2</mn></msup><annotation encoding="application/x-tex">G^2</annotation></semantics></math>
(deviance)</th>
<th align="right">df</th>
<th align="right">AIC</th>
<th align="right">BIC</th>
<th align="right">DI</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Independence</td>
<td align="right">4,929,394</td>
<td align="right">15,625</td>
<td align="right">4,973,191</td>
<td align="right">4,975,116</td>
<td align="right">0.600</td>
</tr>
<tr class="even">
<td align="left">Quasi-independence</td>
<td align="right">959,392</td>
<td align="right">15,499</td>
<td align="right">1,003,441</td>
<td align="right">1,006,333</td>
<td align="right">0.190</td>
</tr>
<tr class="odd">
<td align="left">Uniform association</td>
<td align="right">3,939,442</td>
<td align="right">15,624</td>
<td align="right">3,983,241</td>
<td align="right">3,985,174</td>
<td align="right">0.576</td>
</tr>
<tr class="even">
<td align="left">MONECA topology L2</td>
<td align="right">157,377</td>
<td align="right">14,971</td>
<td align="right">182,495</td>
<td align="right">189,438</td>
<td align="right">0.062</td>
</tr>
<tr class="odd">
<td align="left">MONECA topology L3</td>
<td align="right">272,938</td>
<td align="right">15,309</td>
<td align="right">297,380</td>
<td align="right">301,730</td>
<td align="right">0.092</td>
</tr>
</tbody>
</table>
<p><strong>Note on quasi-symmetry.</strong> A quasi-symmetry model was
not fitted. With 126 categories, it would require approximately 8,000
symmetric pair parameters
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>126</mn><mo>√ó</mo><mn>125</mn><mi>/</mi><mn>2</mn><mo>=</mo><mn>7</mn><mo>,</mo><mn>875</mn></mrow><annotation encoding="application/x-tex">126 \times 125 / 2 = 7{,}875</annotation></semantics></math>),
which exceeds the numerical stability limits of the GLM solver for a
matrix of this size.</p>
</div>
<div class="section level3">
<h3 id="likelihood-ratio-tests">Likelihood-Ratio Tests<a class="anchor" aria-label="anchor" href="#likelihood-ratio-tests"></a>
</h3>
<p>Nested models are compared using the likelihood-ratio test
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œî</mi><msup><mi>G</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\Delta G^2</annotation></semantics></math>).
Each test evaluates whether the additional parameters in the more
complex model provide a statistically significant improvement in
fit.</p>
<p>Likelihood-ratio tests are computed automatically by
<code><a href="../reference/compare_mobility_models.html">compare_mobility_models()</a></code> for known nesting relationships.
The <code>$lr_tests</code> component of the comparison object contains
the results:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 5. Likelihood-ratio tests -----</span></span>
<span><span class="co"># Extracted from the comparison object</span></span>
<span><span class="va">comp</span><span class="op">$</span><span class="va">lr_tests</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Simpler model</th>
<th align="left">Complex model</th>
<th align="right"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œî</mi><msup><mi>G</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\Delta G^2</annotation></semantics></math></th>
<th align="right">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œî</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>df</th>
<th align="left">p-value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Independence</td>
<td align="left">Quasi-independence</td>
<td align="right">3,970,002</td>
<td align="right">126</td>
<td align="left">&lt; 2.2e-16</td>
</tr>
<tr class="even">
<td align="left">Independence</td>
<td align="left">Uniform association</td>
<td align="right">989,952</td>
<td align="right">1</td>
<td align="left">&lt; 2.2e-16</td>
</tr>
<tr class="odd">
<td align="left">Quasi-independence</td>
<td align="left">MONECA topology L2</td>
<td align="right">802,015</td>
<td align="right">528</td>
<td align="left">&lt; 2.2e-16</td>
</tr>
<tr class="even">
<td align="left">Quasi-independence</td>
<td align="left">MONECA topology L3</td>
<td align="right">686,455</td>
<td align="right">190</td>
<td align="left">&lt; 2.2e-16</td>
</tr>
</tbody>
</table>
<p>All comparisons are statistically significant at conventional
levels.</p>
</div>
</div>
<div class="section level2">
<h2 id="interpretation">Interpretation<a class="anchor" aria-label="anchor" href="#interpretation"></a>
</h2>
<div class="section level3">
<h3 id="the-structure-of-the-data">The Structure of the Data<a class="anchor" aria-label="anchor" href="#the-structure-of-the-data"></a>
</h3>
<p>The Italian professional mobility table contains 126 occupational
categories and 1.6 million observed transitions. Half of all individuals
remain in the same profession over the observation period. More than a
third of all cell pairs (35.3%) have no observed transitions, reflecting
the fact that most professions are not connected by direct mobility
flows. This combination ‚Äî high diagonal concentration and widespread
zero cells ‚Äî is characteristic of large, detailed occupational
classifications.</p>
</div>
<div class="section level3">
<h3 id="independence-model-a-baseline">Independence Model: A Baseline<a class="anchor" aria-label="anchor" href="#independence-model-a-baseline"></a>
</h3>
<p>The independence model assumes that origin and destination
professions are unrelated. Its dissimilarity index of 0.60 indicates
that 60% of all cases would need to be reclassified to match the
observed data. This is expected: people do not move randomly between
professions. Occupational transitions are structured by skills,
credentials, industry, and labor market segmentation. The independence
model serves as a lower bound against which other models are
compared.</p>
</div>
<div class="section level3">
<h3 id="diagonal-immobility-is-the-dominant-pattern">Diagonal Immobility Is the Dominant Pattern<a class="anchor" aria-label="anchor" href="#diagonal-immobility-is-the-dominant-pattern"></a>
</h3>
<p>The transition from independence to quasi-independence provides the
single largest improvement in fit across all model comparisons. Adding
126 diagonal parameters reduces
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>G</mi><mn>2</mn></msup><annotation encoding="application/x-tex">G^2</annotation></semantics></math>
by 3,970,002, and the dissimilarity index drops from 0.60 to 0.19. The
fact that half the population stays in the same profession is the
dominant feature of the table, and the diagonal parameters capture this
effect directly.</p>
<p>However, a dissimilarity index of 0.19 means that quasi-independence
still misclassifies 19% of transitions. There is substantial structure
in the off-diagonal flows ‚Äî the pattern of who moves where ‚Äî that the
quasi-independence model does not capture. The remaining analysis
focuses on this off-diagonal structure.</p>
</div>
<div class="section level3">
<h3 id="ordinal-ranking-has-limited-explanatory-power">Ordinal Ranking Has Limited Explanatory Power<a class="anchor" aria-label="anchor" href="#ordinal-ranking-has-limited-explanatory-power"></a>
</h3>
<p>The uniform association model adds a single parameter measuring the
overall strength of linear-by-linear association, treating professions
as ordered on an integer scale. This model reduces
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>G</mi><mn>2</mn></msup><annotation encoding="application/x-tex">G^2</annotation></semantics></math>
by approximately 990,000 from independence, but its dissimilarity index
remains at 0.576 ‚Äî only marginally better than independence.</p>
<p>This result indicates that professional mobility in Italy does not
follow a simple ordinal gradient. If professions could be arranged along
a single hierarchy such that adjacent professions exchanged members more
frequently, the uniform association model would perform well. It does
not. The mobility structure is multidimensional: professions cluster by
sector, skill type, and institutional boundaries rather than along a
single ranking. A single association parameter cannot capture this
complexity.</p>
</div>
<div class="section level3">
<h3 id="moneca-segments-capture-genuine-mobility-barriers">MONECA Segments Capture Genuine Mobility Barriers<a class="anchor" aria-label="anchor" href="#moneca-segments-capture-genuine-mobility-barriers"></a>
</h3>
<p>The central finding of this analysis concerns the MONECA topology
models. Starting from quasi-independence (DI = 0.190), the MONECA Level
2 topology model reduces the dissimilarity index to 0.062 by adding 528
parameters representing segment-pair interactions. The improvement in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>G</mi><mn>2</mn></msup><annotation encoding="application/x-tex">G^2</annotation></semantics></math>
is 802,015, which is statistically overwhelming
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&lt;</mo><mn>2.2</mn><mo>√ó</mo><msup><mn>10</mn><mrow><mo>‚àí</mo><mn>16</mn></mrow></msup></mrow><annotation encoding="application/x-tex">p &lt; 2.2 \times 10^{-16}</annotation></semantics></math>).</p>
<p>The practical significance of DI = 0.062 is that only 6.2% of
transitions are misclassified by the model. The 32 segments identified
by MONECA at Level 2 ‚Äî representing clusters of professions with
elevated internal mobility ‚Äî account for the large majority of the
off-diagonal structure in the table. Moving from quasi-independence (DI
= 0.190) to the MONECA topology (DI = 0.062) eliminates roughly
two-thirds of the remaining misfit. These segments correspond to
recognizable professional clusters: groups of manual trades,
administrative and commercial occupations, education-related
professions, agricultural specializations, and similar groupings.</p>
<p>The segments are not arbitrary. They are derived from the observed
mobility network itself, and the log-linear analysis confirms that the
boundaries they define correspond to statistically meaningful
discontinuities in the flow of workers between occupations.</p>
</div>
<div class="section level3">
<h3 id="coarser-segmentation-still-works-but-fits-worse">Coarser Segmentation Still Works but Fits Worse<a class="anchor" aria-label="anchor" href="#coarser-segmentation-still-works-but-fits-worse"></a>
</h3>
<p>The MONECA Level 3 topology model, with 19 segments, achieves DI =
0.092. This is substantially better than quasi-independence (0.190) but
worse than the Level 2 model (0.062). The additional granularity at
Level 2 captures real mobility boundaries, not simply noise: the 13
additional segment distinctions between Level 3 and Level 2 correspond
to genuine differences in mobility patterns.</p>
<p>The likelihood-ratio test comparing quasi-independence to Level 3
topology
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œî</mi><msup><mi>G</mi><mn>2</mn></msup><mo>=</mo><mn>686</mn><mo>,</mo><mn>455</mn></mrow><annotation encoding="application/x-tex">\Delta G^2 = 686{,}455</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œî</mi><mtext mathvariant="normal">df</mtext><mo>=</mo><mn>190</mn></mrow><annotation encoding="application/x-tex">\Delta \text{df} = 190</annotation></semantics></math>)
is also highly significant. Both topology models represent large
improvements over the baseline, but Level 2 provides the better fit.</p>
</div>
<div class="section level3">
<h3 id="largest-model-residuals-reveal-cross-segment-flows">Largest Model Residuals Reveal Cross-Segment Flows<a class="anchor" aria-label="anchor" href="#largest-model-residuals-reveal-cross-segment-flows"></a>
</h3>
<p>Even the best-fitting model (MONECA topology L2) does not capture all
mobility flows. Examination of the largest positive Pearson residuals
identifies specific profession pairs where observed flows substantially
exceed model predictions. These are transitions that occur across
segment boundaries ‚Äî ‚Äúbridge flows‚Äù that the cluster structure does not
predict:</p>
<ul>
<li>Agricultural machine operators and specialized farmers
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>65.9</mn></mrow><annotation encoding="application/x-tex">r = 65.9</annotation></semantics></math>)</li>
<li>Cultural service technicians and artistic specialists
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>54.7</mn></mrow><annotation encoding="application/x-tex">r = 54.7</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>47.0</mn><annotation encoding="application/x-tex">47.0</annotation></semantics></math>
in both directions)</li>
<li>Travel assistants and qualified commercial workers
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>53.5</mn></mrow><annotation encoding="application/x-tex">r = 53.5</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>51.4</mn><annotation encoding="application/x-tex">51.4</annotation></semantics></math>
in both directions)</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 6. Examine largest residuals -----</span></span>
<span><span class="co"># The residuals matrix is stored in the moneca_loglinear object</span></span>
<span><span class="va">resid_mx</span> <span class="op">&lt;-</span> <span class="va">m_top2</span><span class="op">$</span><span class="va">residuals</span></span>
<span></span>
<span><span class="co"># Find largest positive residuals (flows exceeding prediction)</span></span>
<span><span class="va">resid_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Origin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">resid_mx</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">resid_mx</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Destination <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">resid_mx</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">resid_mx</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Residual <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">resid_mx</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">resid_long</span> <span class="op">&lt;-</span> <span class="va">resid_long</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="op">-</span><span class="va">resid_long</span><span class="op">$</span><span class="va">Residual</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">resid_long</span>, <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<p>These residuals identify specific mobility channels that cross the
segment boundaries identified by MONECA. They represent career pathways
‚Äî often involving related but distinct occupational fields ‚Äî that
connect otherwise separate clusters. Such cross-segment flows are
informative: they point to labor market connections that a purely
cluster-based model cannot capture and may warrant further
investigation.</p>
</div>
<div class="section level3">
<h3 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<p>The results demonstrate that Italian professional mobility is
organized into recognizable clusters of occupations. Within these
clusters, workers move between similar professions at rates higher than
expected under independence. Between clusters, mobility barriers limit
the flow of workers.</p>
<p>The MONECA topology model provides a substantially better fit than
standard log-linear baselines:</p>
<ul>
<li>The independence model misclassifies 60% of transitions.</li>
<li>Quasi-independence (accounting for immobility) reduces this to
19%.</li>
<li>The MONECA Level 2 topology further reduces misclassification to
6.2%.</li>
</ul>
<p>The network-based segmentation identifies statistically meaningful
professional boundaries. The improvement over quasi-independence is not
merely statistically significant (which, given 1.6 million observations,
is a low bar) but practically substantial: two-thirds of the
off-diagonal misfit is eliminated by the segment structure.</p>
<p>These findings confirm the utility of MONECA as a preprocessing step
for mobility table analysis. The segments it identifies are not only
descriptively useful for visualizing occupational clusters but also
correspond to genuine structural features of the mobility table as
measured by standard log-linear model criteria.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Agresti, A. (2002). <em>Categorical Data Analysis</em>. 2nd edition.
Wiley.</li>
<li>Goodman, L. A. (1979). Simple models for the analysis of association
in cross-classifications having ordered categories. <em>Journal of the
American Statistical Association</em>, 74(367), 537‚Äì552.</li>
<li>Touboel, J. &amp; Larsen, A. G. (2017). MONECA: MObility NEtwork
Clustering Analysis. R package.</li>
</ul>
</div>
<div class="section level2">
<h2 id="session-information">Session Information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Giampaolo Montaletti, Jonas Touboel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
