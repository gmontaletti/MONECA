<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to moneca: Mobility Network Clustering Analysis â€¢ moneca</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to moneca: Mobility Network Clustering Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">moneca</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/moneca-introduction.html">Introduction to moneca: Mobility Network Clustering Analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="dropdown-item" href="https://gmontaletti.github.io/MONECA/news/index.html#moneca-105">Version 1.0.5</a></li>
    <li><a class="dropdown-item" href="https://gmontaletti.github.io/MONECA/news/index.html#moneca-100">Version 1.0.0</a></li>
    <li><a class="dropdown-item" href="https://gmontaletti.github.io/MONECA/news/index.html#moneca-09">Version 0.9</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gmontaletti/MONECA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to moneca: Mobility Network Clustering Analysis</h1>
                        <h4 data-toc-skip class="author">Giampaolo
Montaletti</h4>
            
            <h4 data-toc-skip class="date">2026-02-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/gmontaletti/MONECA/blob/master/vignettes/moneca-introduction.Rmd" class="external-link"><code>vignettes/moneca-introduction.Rmd</code></a></small>
      <div class="d-none name"><code>moneca-introduction.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>moneca (Mobility Network Clustering Analysis) is an R package that
analyzes social mobility patterns through graph-theoretic approaches.
The package creates weighted networks from mobility tables and uses
cliques to identify discrete and nested clusters of positions with high
internal mobility.</p>
<div class="section level3">
<h3 id="about-this-vignette">About This Vignette<a class="anchor" aria-label="anchor" href="#about-this-vignette"></a>
</h3>
<p>This vignette was written by <strong>Giampaolo Montaletti</strong> as
part of the comprehensive modernization of the moneca package (2024). It
provides a complete guide to using the modern features and capabilities
of the package, including the new visualization system, synthetic data
generation, and enhanced analysis tools.</p>
</div>
<div class="section level3">
<h3 id="package-background">Package Background<a class="anchor" aria-label="anchor" href="#package-background"></a>
</h3>
<p>The <strong>moneca</strong> package (lowercase) is a complete rewrite
and modernization of the original MONECA package. While it implements
the clustering algorithm originally developed by Touboel &amp; Larsen
(2017), the current package features entirely new code for
visualization, testing, data generation, and documentation authored by
Giampaolo Montaletti.</p>
</div>
<div class="section level3">
<h3 id="key-features">Key Features<a class="anchor" aria-label="anchor" href="#key-features"></a>
</h3>
<ul>
<li>
<strong>Network-based clustering</strong> of mobility tables</li>
<li>
<strong>Hierarchical segmentation</strong> at multiple levels</li>
<li>
<strong>Modern visualization</strong> with ggplot2 and ggraph</li>
<li>
<strong>Quality metrics</strong> for assessing segmentation
performance</li>
<li>
<strong>Synthetic data generation</strong> for testing and
demonstrations</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="basic-concepts">Basic Concepts<a class="anchor" aria-label="anchor" href="#basic-concepts"></a>
</h2>
<p>Social mobility can be represented as a network where:</p>
<ul>
<li>
<strong>Nodes</strong> represent social positions (occupations,
classes, etc.)</li>
<li>
<strong>Edges</strong> represent mobility flows between
positions</li>
<li>
<strong>Edge weights</strong> represent the strength of mobility
connections</li>
<li>
<strong>Clusters</strong> represent groups of positions with high
internal mobility</li>
</ul>
<p>MONECA identifies these clusters by:</p>
<ol style="list-style-type: decimal">
<li>Converting mobility tables to relative risk matrices</li>
<li>Finding cliques in the weighted network</li>
<li>Iteratively aggregating positions into segments</li>
<li>Creating hierarchical segmentation levels</li>
</ol>
</div>
<div class="section level2">
<h2 id="installation-and-setup">Installation and Setup<a class="anchor" aria-label="anchor" href="#installation-and-setup"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install from GitHub</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"gmontaletti/moneca"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gmontaletti.github.io/MONECA/">moneca</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load additional packages for visualization</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com" class="external-link">ggraph</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="working-with-synthetic-data">Working with Synthetic Data<a class="anchor" aria-label="anchor" href="#working-with-synthetic-data"></a>
</h2>
<p>MONECA includes functions to generate synthetic mobility data for
demonstrations and testing.</p>
<div class="section level3">
<h3 id="creating-basic-synthetic-data">Creating Basic Synthetic Data<a class="anchor" aria-label="anchor" href="#creating-basic-synthetic-data"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate a large 30-class mobility table for better statistical analysis</span></span>
<span><span class="va">basic_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_mobility_data.html">generate_mobility_data</a></span><span class="op">(</span></span>
<span>  n_classes <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  n_total <span class="op">=</span> <span class="fl">50000</span>,  <span class="co"># Larger population for better statistical power</span></span>
<span>  immobility_strength <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  class_clustering <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  class_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Class"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%02d"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View a subset of the structure to show key portions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Mobility matrix dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">basic_data</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Mobility matrix dimensions: 31 31</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Total population:"</span>, <span class="va">basic_data</span><span class="op">[</span><span class="fl">31</span>, <span class="fl">31</span><span class="op">]</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Total population: 50000</span></span>
<span></span>
<span><span class="co"># Show first 8x8 corner with totals to demonstrate structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"First 8x8 corner of mobility matrix with marginal totals:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; First 8x8 corner of mobility matrix with marginal totals:</span></span>
<span><span class="va">subset_matrix</span> <span class="op">&lt;-</span> <span class="va">basic_data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, <span class="fl">31</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, <span class="fl">31</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">subset_matrix</span><span class="op">)</span></span>
<span><span class="co">#&gt;          Class 01 Class 02 Class 03 Class 04 Class 05 Class 06 Class 07</span></span>
<span><span class="co">#&gt; Class 01     2377      388      156       11       14        7       11</span></span>
<span><span class="co">#&gt; Class 02       78      500       78       41        8        3        7</span></span>
<span><span class="co">#&gt; Class 03       73      140      855      141       57        2        5</span></span>
<span><span class="co">#&gt; Class 04        3       20       26      266       39       16        1</span></span>
<span><span class="co">#&gt; Class 05        2        2       65      121      785       95       52</span></span>
<span><span class="co">#&gt; Class 06        1        1        6       22       72      465       60</span></span>
<span><span class="co">#&gt; Class 07       19       12        8        9      239      434     2793</span></span>
<span><span class="co">#&gt; Class 08        3        1        3        5        3       54      118</span></span>
<span><span class="co">#&gt; Total        2667     1189     1303      742     1313     1199     3178</span></span>
<span><span class="co">#&gt;          Class 08 Total</span></span>
<span><span class="co">#&gt; Class 01        7  3231</span></span>
<span><span class="co">#&gt; Class 02        2   782</span></span>
<span><span class="co">#&gt; Class 03        4  1374</span></span>
<span><span class="co">#&gt; Class 04        2   398</span></span>
<span><span class="co">#&gt; Class 05        2  1210</span></span>
<span><span class="co">#&gt; Class 06       25   707</span></span>
<span><span class="co">#&gt; Class 07      395  4399</span></span>
<span><span class="co">#&gt; Class 08      809  1255</span></span>
<span><span class="co">#&gt; Total        1411 50000</span></span>
<span></span>
<span><span class="co"># Show diagonal (immobility) for first 10 classes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nImmobility rates for first 10 classes:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Immobility rates for first 10 classes:</span></span>
<span><span class="va">diagonal_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">basic_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="va">row_totals</span> <span class="op">&lt;-</span> <span class="va">basic_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">31</span><span class="op">]</span></span>
<span><span class="va">immobility_rates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">diagonal_values</span> <span class="op">/</span> <span class="va">row_totals</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">immobility_rates</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Class"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%02d"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">immobility_rates</span><span class="op">)</span></span>
<span><span class="co">#&gt; Class 01 Class 02 Class 03 Class 04 Class 05 Class 06 Class 07 Class 08 </span></span>
<span><span class="co">#&gt;     73.6     63.9     62.2     66.8     64.9     65.8     63.5     64.5 </span></span>
<span><span class="co">#&gt; Class 09 Class 10 </span></span>
<span><span class="co">#&gt;     60.1     60.7</span></span></code></pre></div>
<p>The mobility matrix shows: - <strong>Rows</strong>: Origin classes
(where people start) - <strong>Columns</strong>: Destination classes
(where people end up) - <strong>Last row/column</strong>: Marginal
totals - <strong>Diagonal</strong>: Immobility (staying in same
class)</p>
</div>
<div class="section level3">
<h3 id="creating-different-mobility-scenarios">Creating Different Mobility Scenarios<a class="anchor" aria-label="anchor" href="#creating-different-mobility-scenarios"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create example datasets with different mobility patterns</span></span>
<span><span class="co"># Using generate_mobility_data() with different parameters</span></span>
<span></span>
<span><span class="co"># For demonstration of larger networks, create custom 30x30 examples</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Creating custom 30x30 examples for comparison:\\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Creating custom 30x30 examples for comparison:\n</span></span>
<span></span>
<span><span class="co"># Create 30x30 rigid system</span></span>
<span><span class="va">examples_30x30</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">examples_30x30</span><span class="op">$</span><span class="va">rigid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_mobility_data.html">generate_mobility_data</a></span><span class="op">(</span></span>
<span>  n_classes <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  n_total <span class="op">=</span> <span class="fl">45000</span>,</span>
<span>  immobility_strength <span class="op">=</span> <span class="fl">0.85</span>,  <span class="co"># Very rigid</span></span>
<span>  class_clustering <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  class_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Class"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%02d"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create 30x30 fluid system</span></span>
<span><span class="va">examples_30x30</span><span class="op">$</span><span class="va">fluid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_mobility_data.html">generate_mobility_data</a></span><span class="op">(</span></span>
<span>  n_classes <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  n_total <span class="op">=</span> <span class="fl">45000</span>,</span>
<span>  immobility_strength <span class="op">=</span> <span class="fl">0.4</span>,  <span class="co"># Very fluid</span></span>
<span>  class_clustering <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  class_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Class"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%02d"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">200</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine the rigid class system - show key portions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Rigid class system (30x30 matrix):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rigid class system (30x30 matrix):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Matrix dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">examples_30x30</span><span class="op">$</span><span class="va">rigid</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Matrix dimensions: 31 31</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Total population:"</span>, <span class="va">examples_30x30</span><span class="op">$</span><span class="va">rigid</span><span class="op">[</span><span class="fl">31</span>, <span class="fl">31</span><span class="op">]</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Total population: 45000</span></span>
<span></span>
<span><span class="co"># Show first 6x6 corner with totals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"First 6x6 corner with marginal totals:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; First 6x6 corner with marginal totals:</span></span>
<span><span class="va">rigid_subset</span> <span class="op">&lt;-</span> <span class="va">examples_30x30</span><span class="op">$</span><span class="va">rigid</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">31</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">31</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rigid_subset</span><span class="op">)</span></span>
<span><span class="co">#&gt;          Class 01 Class 02 Class 03 Class 04 Class 05 Class 06 Total</span></span>
<span><span class="co">#&gt; Class 01      435      239      122        1        2        0   848</span></span>
<span><span class="co">#&gt; Class 02       28       63       39       21        0        1   164</span></span>
<span><span class="co">#&gt; Class 03      238      479      926      480      234        1  2448</span></span>
<span><span class="co">#&gt; Class 04        4      144      287      543      279      142  1448</span></span>
<span><span class="co">#&gt; Class 05        2        3      153      339      632      328  1685</span></span>
<span><span class="co">#&gt; Class 06        3        0        5       84      149      292   767</span></span>
<span><span class="co">#&gt; Total         768      976     1603     1521     1520     1275 45000</span></span>
<span></span>
<span><span class="co"># Show immobility rates for first 8 classes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nImmobility rates (%) for first 8 classes in rigid system:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Immobility rates (%) for first 8 classes in rigid system:</span></span>
<span><span class="va">rigid_diag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">examples_30x30</span><span class="op">$</span><span class="va">rigid</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span></span>
<span><span class="va">rigid_totals</span> <span class="op">&lt;-</span> <span class="va">examples_30x30</span><span class="op">$</span><span class="va">rigid</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, <span class="fl">31</span><span class="op">]</span></span>
<span><span class="va">rigid_rates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">rigid_diag</span> <span class="op">/</span> <span class="va">rigid_totals</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">rigid_rates</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Class"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%02d"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rigid_rates</span><span class="op">)</span></span>
<span><span class="co">#&gt; Class 01 Class 02 Class 03 Class 04 Class 05 Class 06 Class 07 Class 08 </span></span>
<span><span class="co">#&gt;     51.3     38.4     37.8     37.5     37.5     38.1     36.6     36.5</span></span>
<span></span>
<span><span class="co"># Examine the fluid (highly mobile) system</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nFluid mobility system (30x30 matrix):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fluid mobility system (30x30 matrix):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Matrix dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">examples_30x30</span><span class="op">$</span><span class="va">fluid</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Matrix dimensions: 31 31</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Total population:"</span>, <span class="va">examples_30x30</span><span class="op">$</span><span class="va">fluid</span><span class="op">[</span><span class="fl">31</span>, <span class="fl">31</span><span class="op">]</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Total population: 45000</span></span>
<span></span>
<span><span class="co"># Show first 6x6 corner with totals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"First 6x6 corner with marginal totals:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; First 6x6 corner with marginal totals:</span></span>
<span><span class="va">fluid_subset</span> <span class="op">&lt;-</span> <span class="va">examples_30x30</span><span class="op">$</span><span class="va">fluid</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">31</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">31</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fluid_subset</span><span class="op">)</span></span>
<span><span class="co">#&gt;          Class 01 Class 02 Class 03 Class 04 Class 05 Class 06 Total</span></span>
<span><span class="co">#&gt; Class 01      599      508      220        7        8        3  1448</span></span>
<span><span class="co">#&gt; Class 02      381      517      381      192        8        1  1597</span></span>
<span><span class="co">#&gt; Class 03      209      372      564      394      203        7  1853</span></span>
<span><span class="co">#&gt; Class 04        3      230      435      546      455      237  2017</span></span>
<span><span class="co">#&gt; Class 05        0        4      141      320      400      281  1404</span></span>
<span><span class="co">#&gt; Class 06        3        2        2      125      295      336  1216</span></span>
<span><span class="co">#&gt; Total        1285     1710     1821     1662     1632     1424 45000</span></span>
<span></span>
<span><span class="co"># Show immobility rates for first 8 classes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nImmobility rates (%) for first 8 classes in fluid system:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Immobility rates (%) for first 8 classes in fluid system:</span></span>
<span><span class="va">fluid_diag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">examples_30x30</span><span class="op">$</span><span class="va">fluid</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span></span>
<span><span class="va">fluid_totals</span> <span class="op">&lt;-</span> <span class="va">examples_30x30</span><span class="op">$</span><span class="va">fluid</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, <span class="fl">31</span><span class="op">]</span></span>
<span><span class="va">fluid_rates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fluid_diag</span> <span class="op">/</span> <span class="va">fluid_totals</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fluid_rates</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Class"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%02d"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fluid_rates</span><span class="op">)</span></span>
<span><span class="co">#&gt; Class 01 Class 02 Class 03 Class 04 Class 05 Class 06 Class 07 Class 08 </span></span>
<span><span class="co">#&gt;     41.4     32.4     30.4     27.1     28.5     27.6     29.0     27.8</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="running-moneca-analysis">Running MONECA Analysis<a class="anchor" aria-label="anchor" href="#running-moneca-analysis"></a>
</h2>
<div class="section level3">
<h3 id="basic-analysis">Basic Analysis<a class="anchor" aria-label="anchor" href="#basic-analysis"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run MONECA on the basic dataset</span></span>
<span><span class="va">seg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca.html">moneca</a></span><span class="op">(</span><span class="va">basic_data</span>, segment.levels <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |====                                                                  |   5%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  12%  |                                                                              |==========                                                            |  14%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  21%  |                                                                              |================                                                      |  22%  |                                                                              |=================                                                     |  24%</span></span>
<span><span class="co">#&gt; 25% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  28%  |                                                                              |=====================                                                 |  29%  |                                                                              |======================                                                |  31%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |=========================                                             |  36%  |                                                                              |===========================                                           |  38%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  45%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |===================================                                   |  50%</span></span>
<span><span class="co">#&gt; 51% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |=======================================                               |  55%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  62%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  71%  |                                                                              |===================================================                   |  72%  |                                                                              |====================================================                  |  74%</span></span>
<span><span class="co">#&gt; 75% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  78%  |                                                                              |========================================================              |  79%  |                                                                              |=========================================================             |  81%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  86%  |                                                                              |==============================================================        |  88%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  95%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; 100% ready!</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%</span></span>
<span><span class="co">#&gt; 27% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%</span></span>
<span><span class="co">#&gt; 55% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%</span></span>
<span><span class="co">#&gt; 82% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; 100% ready!</span></span>
<span></span>
<span><span class="co"># View the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">seg</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ================================================================================</span></span>
<span><span class="co">#&gt;                         moneca MOBILITY ANALYSIS RESULTS                        </span></span>
<span><span class="co">#&gt; ================================================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; OVERALL MOBILITY PATTERNS</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Overall Population Mobility Rate:                    35.4%</span></span>
<span><span class="co">#&gt; Average Mobility Concentration (all levels):         90.9%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; HIERARCHICAL SEGMENTATION ANALYSIS</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Internal Mobility Within Segments (%):</span></span>
<span><span class="co">#&gt; Level 1 Level 2 Level 3 Level 4 </span></span>
<span><span class="co">#&gt;    64.6    76.8    85.3   100.0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mobility Concentration in Significant Pathways by Level (%):</span></span>
<span><span class="co">#&gt; Level 1 Level 2 Level 3 Level 4 </span></span>
<span><span class="co">#&gt;    91.0    87.4    85.3   100.0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Network Structure by Level:</span></span>
<span><span class="co">#&gt;                                    Level 1      Level 2      Level 3      Level 4 </span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Active Segments/Classes:                30           12            6            1 </span></span>
<span><span class="co">#&gt; Significant Edges:                     104           12            0            0 </span></span>
<span><span class="co">#&gt; Network Density:                     0.120        0.091        0.000          NaN </span></span>
<span><span class="co">#&gt; Isolated Segments:                       0            0            6            1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; DETAILED WEIGHTED DEGREE DISTRIBUTIONS (STRENGTH)</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total Weighted Connections (Strength In + Out):</span></span>
<span><span class="co">#&gt;          Min    Q1 Median  Mean    Q3   Max</span></span>
<span><span class="co">#&gt; Level 1 8.77 15.32  20.14 20.55 25.81 39.11</span></span>
<span><span class="co">#&gt; Level 2 1.07  2.03   2.57  2.75  3.25  5.56</span></span>
<span><span class="co">#&gt; Level 3 0.00  0.00   0.00  0.00  0.00  0.00</span></span>
<span><span class="co">#&gt; Level 4 0.00  0.00   0.00  0.00  0.00  0.00</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Outward Mobility Strength (Weighted Out-Degree):</span></span>
<span><span class="co">#&gt;          Min   Q1 Median  Mean    Q3   Max</span></span>
<span><span class="co">#&gt; Level 1 5.36 7.81  10.64 10.27 12.05 15.58</span></span>
<span><span class="co">#&gt; Level 2 0.00 0.00   1.14  1.37  2.67  3.31</span></span>
<span><span class="co">#&gt; Level 3 0.00 0.00   0.00  0.00  0.00  0.00</span></span>
<span><span class="co">#&gt; Level 4 0.00 0.00   0.00  0.00  0.00  0.00</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Inward Mobility Strength (Weighted In-Degree):</span></span>
<span><span class="co">#&gt;          Min   Q1 Median  Mean    Q3   Max</span></span>
<span><span class="co">#&gt; Level 1 1.87 6.55   9.69 10.27 14.24 26.51</span></span>
<span><span class="co">#&gt; Level 2 0.00 0.78   1.12  1.37  1.71  4.39</span></span>
<span><span class="co">#&gt; Level 3 0.00 0.00   0.00  0.00  0.00  0.00</span></span>
<span><span class="co">#&gt; Level 4 0.00 0.00   0.00  0.00  0.00  0.00</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Edge Weight Distribution (Relative Risk Values):</span></span>
<span><span class="co">#&gt;          Min   Q1 Median Mean   Q3  Max</span></span>
<span><span class="co">#&gt; Level 1 1.02 1.61   2.42 2.96 3.76 8.35</span></span>
<span><span class="co">#&gt; Level 2 1.04 1.07   1.16 1.37 1.51 2.23</span></span>
<span><span class="co">#&gt; Level 3   NA   NA     NA  NaN   NA   NA</span></span>
<span><span class="co">#&gt; Level 4   NA   NA     NA  NaN   NA   NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ================================================================================</span></span></code></pre></div>
<p>The MONECA object contains: - <code>segment.list</code>: Hierarchical
clusters for each level - <code>mat.list</code>: Aggregated mobility
matrices for each level</p>
</div>
<div class="section level3">
<h3 id="understanding-the-results">Understanding the Results<a class="anchor" aria-label="anchor" href="#understanding-the-results"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View segment membership</span></span>
<span><span class="va">membership</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/segment.membership.html">segment.membership</a></span><span class="op">(</span><span class="va">seg</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Segment membership summary:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Segment membership summary:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Number of levels:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">membership</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of levels: 2</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">membership</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Level"</span>, <span class="va">i</span>, <span class="st">"- Number of segments:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">membership</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Level 1 - Number of segments: 30 </span></span>
<span><span class="co">#&gt; Level 2 - Number of segments: 1</span></span>
<span></span>
<span><span class="co"># Show first 15 class memberships at each level</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nSegment membership for first 15 classes:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Segment membership for first 15 classes:</span></span>
<span><span class="va">membership_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Class"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%02d"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Level_1 <span class="op">=</span> <span class="va">membership</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>,</span>
<span>  Level_2 <span class="op">=</span> <span class="va">membership</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">membership</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">membership_subset</span><span class="op">$</span><span class="va">Level_3</span> <span class="op">&lt;-</span> <span class="va">membership</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">membership_subset</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Class  Level_1 Level_2</span></span>
<span><span class="co">#&gt; 1  Class 01 Class 01     4.1</span></span>
<span><span class="co">#&gt; 2  Class 02 Class 02     4.1</span></span>
<span><span class="co">#&gt; 3  Class 03 Class 03     4.1</span></span>
<span><span class="co">#&gt; 4  Class 04 Class 04     4.1</span></span>
<span><span class="co">#&gt; 5  Class 05 Class 05     4.1</span></span>
<span><span class="co">#&gt; 6  Class 06 Class 06     4.1</span></span>
<span><span class="co">#&gt; 7  Class 07 Class 07     4.1</span></span>
<span><span class="co">#&gt; 8  Class 08 Class 08     4.1</span></span>
<span><span class="co">#&gt; 9  Class 09 Class 09     4.1</span></span>
<span><span class="co">#&gt; 10 Class 10 Class 10     4.1</span></span>
<span><span class="co">#&gt; 11 Class 11 Class 11     4.1</span></span>
<span><span class="co">#&gt; 12 Class 12 Class 12     4.1</span></span>
<span><span class="co">#&gt; 13 Class 13 Class 13     4.1</span></span>
<span><span class="co">#&gt; 14 Class 14 Class 14     4.1</span></span>
<span><span class="co">#&gt; 15 Class 15 Class 15     4.1</span></span>
<span></span>
<span><span class="co"># View the aggregated matrix for level 2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nLevel 2 aggregated matrix dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">seg</span><span class="op">$</span><span class="va">mat.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Level 2 aggregated matrix dimensions: 13 13</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Level 2 aggregated matrix:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Level 2 aggregated matrix:"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">seg</span><span class="op">$</span><span class="va">mat.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;       1    2    3    4    5    6    7    8    9   10   11   12    31</span></span>
<span><span class="co">#&gt; 1  1203   15   12   15   14    6    9  149   82   12    6    7  1530</span></span>
<span><span class="co">#&gt; 2    21 1688   22   16   16   15   20   19  177   22    5    7  2028</span></span>
<span><span class="co">#&gt; 3    21   10 1516   16   16    6  196   28   25   25   46    6  1911</span></span>
<span><span class="co">#&gt; 4    22   32   26 2355   28  240  171   30   39   20   15    4  2982</span></span>
<span><span class="co">#&gt; 5    42   45   32   47 3257   23   21   92   53  420   10  129  4171</span></span>
<span><span class="co">#&gt; 6    51   37   46  308   47 3343   28   42   37   43   12   19  4013</span></span>
<span><span class="co">#&gt; 7    41   49  680  356   36   33 3752   42   39   42   21   15  5106</span></span>
<span><span class="co">#&gt; 8   397   62   60   66  225   46   47 5715   78   75   30  442  7243</span></span>
<span><span class="co">#&gt; 9   452  523   64   64   58   40   54   52 5303   82   16   19  6727</span></span>
<span><span class="co">#&gt; 10   65   71  173   58  424   43   38   70   51 5567  342   26  6928</span></span>
<span><span class="co">#&gt; 11   32   30  431   23   22   25   15   21   20  456 2036   12  3123</span></span>
<span><span class="co">#&gt; 12   59   48   29   34  629   36   26  609   42   34   14 2678  4238</span></span>
<span><span class="co">#&gt; 31 2406 2610 3091 3358 4772 3856 4377 6869 5946 6798 2553 3364 50000</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="modern-visualization-with-ggraph">Modern Visualization with ggraph<a class="anchor" aria-label="anchor" href="#modern-visualization-with-ggraph"></a>
</h2>
<p>MONECA now includes modern visualization functions using ggplot2 and
ggraph, designed with accessibility and clarity as primary concerns.</p>
<div class="section level3">
<h3 id="visualization-design-principles">Visualization Design Principles<a class="anchor" aria-label="anchor" href="#visualization-design-principles"></a>
</h3>
<p>All MONECA plotting functions follow evidence-based design principles
for maximum accessibility and clarity:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Colorblind Accessibility</strong>: Uses viridis, plasma, and
ColorBrewer palettes that are perceptually uniform and distinguishable
for all types of color vision</li>
<li>
<strong>High Contrast</strong>: Maintains WCAG AA contrast ratios
for text and visual elements</li>
<li>
<strong>Redundant Encoding</strong>: Uses both color and other
visual properties (size, shape, position) to encode information</li>
<li>
<strong>Clear Visual Hierarchy</strong>: Guides attention through
strategic use of size, transparency, and positioning</li>
<li>
<strong>Minimal Cognitive Load</strong>: Reduces visual clutter
while maintaining analytical depth</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example of accessibility-focused plotting</span></span>
<span><span class="fu"><a href="../reference/plot_moneca_ggraph.html">plot_moneca_ggraph</a></span><span class="op">(</span></span>
<span>  <span class="va">seg</span>,</span>
<span>  color_palette <span class="op">=</span> <span class="st">"Set2"</span>,       <span class="co"># Colorblind-safe qualitative palette</span></span>
<span>  node_alpha <span class="op">=</span> <span class="fl">0.85</span>,            <span class="co"># High contrast</span></span>
<span>  edge_alpha <span class="op">=</span> <span class="fl">0.6</span>,             <span class="co"># Balanced visibility</span></span>
<span>  show_segments <span class="op">=</span> <span class="cn">TRUE</span>,         <span class="co"># Visual grouping</span></span>
<span>  segment_alpha <span class="op">=</span> <span class="fl">0.2</span>,          <span class="co"># Subtle boundaries</span></span>
<span>  label_size <span class="op">=</span> <span class="fl">3.5</span>              <span class="co"># Readable text</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For continuous variables, use viridis family</span></span>
<span><span class="fu"><a href="../reference/plot_moneca_ggraph.html">plot_moneca_ggraph</a></span><span class="op">(</span></span>
<span>  <span class="va">seg</span>,</span>
<span>  node_color <span class="op">=</span> <span class="st">"mobility"</span>,      <span class="co"># Color by mobility rates</span></span>
<span>  color_palette <span class="op">=</span> <span class="st">"viridis"</span>,    <span class="co"># Colorblind-safe continuous scale</span></span>
<span>  node_alpha <span class="op">=</span> <span class="fl">0.85</span>,</span>
<span>  edge_alpha <span class="op">=</span> <span class="fl">0.6</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="basic-network-plot-with-colorblind-friendly-design">Basic Network Plot with Colorblind-Friendly Design<a class="anchor" aria-label="anchor" href="#basic-network-plot-with-colorblind-friendly-design"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a basic network plot with improved accessibility</span></span>
<span><span class="co"># Using viridis color palette (colorblind-friendly) and optimized layout</span></span>
<span><span class="co"># Note: Node colors represent segment membership, sizes show total mobility</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_moneca_ggraph.html">plot_moneca_ggraph</a></span><span class="op">(</span></span>
<span>  <span class="va">seg</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Social Mobility Network: Hierarchical Segmentation"</span>,</span>
<span>  layout <span class="op">=</span> <span class="st">"stress"</span>,  <span class="co"># Better layout for clear network structure</span></span>
<span>  node_color <span class="op">=</span> <span class="st">"segment"</span>,</span>
<span>  node_size <span class="op">=</span> <span class="st">"total"</span>,</span>
<span>  color_palette <span class="op">=</span> <span class="st">"Set2"</span>,  <span class="co"># Colorblind-friendly palette</span></span>
<span>  node_alpha <span class="op">=</span> <span class="fl">0.85</span>,</span>
<span>  edge_alpha <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  show_segments <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  segment_alpha <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  label_size <span class="op">=</span> <span class="fl">3.5</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/plot_basic-1.png" class="r-plt" alt="" width="100%"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span>
<span><span class="co">#&gt; TableGrob (3 x 2) "arrange": 4 grobs</span></span>
<span><span class="co">#&gt;   z     cells    name                grob</span></span>
<span><span class="co">#&gt; 1 1 (2-2,1-1) arrange      gtable[layout]</span></span>
<span><span class="co">#&gt; 2 2 (2-2,2-2) arrange      gtable[layout]</span></span>
<span><span class="co">#&gt; 3 3 (3-3,1-1) arrange      gtable[layout]</span></span>
<span><span class="co">#&gt; 4 4 (1-1,1-2) arrange text[GRID.text.101]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="advanced-network-visualization-with-clear-segment-boundaries">Advanced Network Visualization with Clear Segment Boundaries<a class="anchor" aria-label="anchor" href="#advanced-network-visualization-with-clear-segment-boundaries"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create an advanced plot emphasizing segment structure for 30-node network</span></span>
<span><span class="co"># Note: For larger networks, reduce label clutter and focus on structure</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_moneca_ggraph.html">plot_moneca_ggraph</a></span><span class="op">(</span></span>
<span>  <span class="va">seg</span>,</span>
<span>  layout <span class="op">=</span> <span class="st">"fr"</span>,  <span class="co"># Force-directed layout for balanced positioning</span></span>
<span>  node_color <span class="op">=</span> <span class="st">"segment"</span>,</span>
<span>  node_size <span class="op">=</span> <span class="st">"mobility"</span>,  <span class="co"># Size by mobility rate for analytical insight</span></span>
<span>  edge_width <span class="op">=</span> <span class="st">"weight"</span>,</span>
<span>  color_palette <span class="op">=</span> <span class="st">"Dark2"</span>,  <span class="co"># High-contrast ColorBrewer palette</span></span>
<span>  edge_color <span class="op">=</span> <span class="st">"grey30"</span>,  <span class="co"># Darker edges for better visibility</span></span>
<span>  theme_style <span class="op">=</span> <span class="st">"minimal"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Advanced MONECA Network Analysis (30 Classes)"</span>,</span>
<span>  show_labels <span class="op">=</span> <span class="cn">FALSE</span>,  <span class="co"># Turn off labels for 30-node network to reduce clutter</span></span>
<span>  show_segments <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  segment_alpha <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>  node_alpha <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  edge_alpha <span class="op">=</span> <span class="fl">0.6</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/plot_custom-1.png" class="r-plt" alt="" width="100%"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span>
<span><span class="co">#&gt; TableGrob (3 x 2) "arrange": 4 grobs</span></span>
<span><span class="co">#&gt;   z     cells    name                grob</span></span>
<span><span class="co">#&gt; 1 1 (2-2,1-1) arrange      gtable[layout]</span></span>
<span><span class="co">#&gt; 2 2 (2-2,2-2) arrange      gtable[layout]</span></span>
<span><span class="co">#&gt; 3 3 (3-3,1-1) arrange      gtable[layout]</span></span>
<span><span class="co">#&gt; 4 4 (1-1,1-2) arrange text[GRID.text.405]</span></span>
<span></span>
<span><span class="co"># Also create a subset visualization focusing on the largest segments</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nLargest segments at Level 2:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Largest segments at Level 2:</span></span>
<span><span class="va">level2_segments</span> <span class="op">&lt;-</span> <span class="va">seg</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">segment_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">level2_segments</span>, <span class="va">length</span><span class="op">)</span></span>
<span><span class="va">largest_segments</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">segment_sizes</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Segment sizes:"</span>, <span class="va">segment_sizes</span><span class="op">[</span><span class="va">largest_segments</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Segment sizes: 3 3 3</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ego-network-analysis-focus-on-individual-position-dynamics">Ego Network Analysis: Focus on Individual Position Dynamics<a class="anchor" aria-label="anchor" href="#ego-network-analysis-focus-on-individual-position-dynamics"></a>
</h3>
<p>Ego networks reveal mobility patterns from a single focal position,
showing both incoming and outgoing flows:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create ego network for class 15 (middle of the range) with enhanced accessibility</span></span>
<span><span class="co"># Note: Red nodes show focal position and same-segment connections; Flow width indicates volume</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_ego_ggraph.html">plot_ego_ggraph</a></span><span class="op">(</span></span>
<span>  <span class="va">seg</span>,</span>
<span>  <span class="va">basic_data</span>,</span>
<span>  ego_id <span class="op">=</span> <span class="fl">15</span>,  <span class="co"># Class 15 out of 30 classes</span></span>
<span>  layout <span class="op">=</span> <span class="st">"stress"</span>,  <span class="co"># Stress layout for cleaner ego networks</span></span>
<span>  title <span class="op">=</span> <span class="st">"Ego Network Analysis: Class 15 Mobility Patterns (30-Class System)"</span>,</span>
<span>  highlight_color <span class="op">=</span> <span class="st">"#D55E00"</span>,  <span class="co"># Colorblind-safe orange-red</span></span>
<span>  flow_color <span class="op">=</span> <span class="st">"plasma"</span>,  <span class="co"># Perceptually uniform color scale</span></span>
<span>  node_size_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>  edge_width_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  min_weight <span class="op">=</span> <span class="fl">50</span>  <span class="co"># Higher threshold for 30-class system to filter weak connections</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p3</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/ego_plot-1.png" class="r-plt" alt="" width="100%"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Show ego network statistics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nEgo network statistics for Class 15:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Ego network statistics for Class 15:</span></span>
<span><span class="va">ego_connections</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">basic_data</span><span class="op">[</span><span class="fl">15</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">50</span> <span class="op">|</span> <span class="va">basic_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="fl">15</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Classes connected to Class 15 (flows &gt; 50):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ego_connections</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Classes connected to Class 15 (flows &gt; 50): 5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Connected classes:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">ego_connections</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Connected classes: 13, 14, 15, 16, 17</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="multi-level-segmentation-hierarchical-structure-visualization">Multi-Level Segmentation: Hierarchical Structure Visualization<a class="anchor" aria-label="anchor" href="#multi-level-segmentation-hierarchical-structure-visualization"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create stair plots showing progressive segmentation for 30-class system</span></span>
<span><span class="co"># Using consistent positioning to track segment evolution across levels</span></span>
<span><span class="va">stair_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_stair_ggraph.html">plot_stair_ggraph</a></span><span class="op">(</span></span>
<span>  <span class="va">seg</span>, </span>
<span>  levels <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>  layout <span class="op">=</span> <span class="cn">NULL</span>,  <span class="co"># Use consistent layout.matrix for position stability</span></span>
<span>  segment_naming <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  color_palette <span class="op">=</span> <span class="st">"Set2"</span>,  <span class="co"># Colorblind-friendly qualitative palette</span></span>
<span>  node_size <span class="op">=</span> <span class="st">"total"</span>,</span>
<span>  edge_alpha <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  node_alpha <span class="op">=</span> <span class="fl">0.85</span>,</span>
<span>  segment_alpha <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  label_size <span class="op">=</span> <span class="fl">2.5</span>  <span class="co"># Smaller labels for 30-node network</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display individual plots with improved spacing</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">stair_plots</span><span class="op">$</span><span class="va">`Level 2`</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/stair_plot-1.png" class="r-plt" alt="" width="100%"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">stair_plots</span><span class="op">$</span><span class="va">`Level 3`</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/stair_plot-2.png" class="r-plt" alt="" width="100%"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Provide numerical summary of segmentation progression</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nSegmentation progression summary:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Segmentation progression summary:</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">level</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">n_segments</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">seg</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="va">level</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">avg_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">seg</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="va">level</span><span class="op">]</span><span class="op">]</span>, <span class="va">length</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Level"</span>, <span class="va">level</span>, <span class="st">":"</span>, <span class="va">n_segments</span>, <span class="st">"segments, average size"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">avg_size</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"classes\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Level 2 : 10 segments, average size 2.8 classes</span></span>
<span><span class="co">#&gt; Level 3 : 6 segments, average size 5 classes</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="advanced-analysis-examples">Advanced Analysis Examples<a class="anchor" aria-label="anchor" href="#advanced-analysis-examples"></a>
</h2>
<div class="section level3">
<h3 id="comparing-different-mobility-regimes">Comparing Different Mobility Regimes<a class="anchor" aria-label="anchor" href="#comparing-different-mobility-regimes"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Analyze the rigid class system (30x30)</span></span>
<span><span class="va">rigid_seg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca.html">moneca</a></span><span class="op">(</span><span class="va">examples_30x30</span><span class="op">$</span><span class="va">rigid</span>, segment.levels <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  11%  |                                                                              |=========                                                             |  12%  |                                                                              |==========                                                            |  14%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  18%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |================                                                      |  23%</span></span>
<span><span class="co">#&gt; 25% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |==================                                                    |  25%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  32%  |                                                                              |========================                                              |  34%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  38%  |                                                                              |============================                                          |  39%  |                                                                              |=============================                                         |  41%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  48%  |                                                                              |===================================                                   |  50%</span></span>
<span><span class="co">#&gt; 51% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |====================================                                  |  52%  |                                                                              |======================================                                |  54%  |                                                                              |=======================================                               |  55%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  61%  |                                                                              |============================================                          |  62%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  66%  |                                                                              |================================================                      |  68%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  75%</span></span>
<span><span class="co">#&gt; 75% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |==========================================================            |  82%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |================================================================      |  91%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  95%  |                                                                              |====================================================================  |  96%  |                                                                              |===================================================================== |  98%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; 100% ready!</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=========                                                             |  12%  |                                                                              |==================                                                    |  25%</span></span>
<span><span class="co">#&gt; 33% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |==========================                                            |  38%  |                                                                              |===================================                                   |  50%</span></span>
<span><span class="co">#&gt; 56% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |============================================                          |  62%  |                                                                              |====================================================                  |  75%</span></span>
<span><span class="co">#&gt; 78% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |=============================================================         |  88%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; 100% ready!</span></span>
<span></span>
<span><span class="co"># Analyze the fluid mobility system (30x30)</span></span>
<span><span class="va">fluid_seg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca.html">moneca</a></span><span class="op">(</span><span class="va">examples_30x30</span><span class="op">$</span><span class="va">fluid</span>, segment.levels <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  11%  |                                                                              |=========                                                             |  12%  |                                                                              |==========                                                            |  14%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  18%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |================                                                      |  23%</span></span>
<span><span class="co">#&gt; 25% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |==================                                                    |  25%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  32%  |                                                                              |========================                                              |  34%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  38%  |                                                                              |============================                                          |  39%  |                                                                              |=============================                                         |  41%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  48%  |                                                                              |===================================                                   |  50%</span></span>
<span><span class="co">#&gt; 51% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |====================================                                  |  52%  |                                                                              |======================================                                |  54%  |                                                                              |=======================================                               |  55%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  61%  |                                                                              |============================================                          |  62%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  66%  |                                                                              |================================================                      |  68%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  75%</span></span>
<span><span class="co">#&gt; 75% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |==========================================================            |  82%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |================================================================      |  91%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  95%  |                                                                              |====================================================================  |  96%  |                                                                              |===================================================================== |  98%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; 100% ready!</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%</span></span>
<span><span class="co">#&gt; 27% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%</span></span>
<span><span class="co">#&gt; 55% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%</span></span>
<span><span class="co">#&gt; 82% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; 100% ready!</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |==============                                                        |  20%</span></span>
<span><span class="co">#&gt; 33% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |============================                                          |  40%</span></span>
<span><span class="co">#&gt; 50% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |==========================================                            |  60%  |                                                                              |========================================================              |  80%</span></span>
<span><span class="co">#&gt; 83% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; 100% ready!</span></span>
<span></span>
<span><span class="co"># Compare segment memberships - show summary statistics</span></span>
<span><span class="va">rigid_membership</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/segment.membership.html">segment.membership</a></span><span class="op">(</span><span class="va">rigid_seg</span><span class="op">)</span></span>
<span><span class="va">fluid_membership</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/segment.membership.html">segment.membership</a></span><span class="op">(</span><span class="va">fluid_seg</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Rigid system segmentation summary:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rigid system segmentation summary:</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">rigid_membership</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">n_segments</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">rigid_membership</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">segment_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">rigid_membership</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">avg_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">segment_sizes</span><span class="op">)</span></span>
<span>  <span class="va">max_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">segment_sizes</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Level"</span>, <span class="va">i</span>, <span class="st">":"</span>, <span class="va">n_segments</span>, <span class="st">"segments, avg size"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">avg_size</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>      <span class="st">", largest segment"</span>, <span class="va">max_size</span>, <span class="st">"classes\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Level 1 : 30 segments, avg size 1 , largest segment 1 classes</span></span>
<span><span class="co">#&gt; Level 2 : 1 segments, avg size 30 , largest segment 30 classes</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nFluid system segmentation summary:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fluid system segmentation summary:</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fluid_membership</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">n_segments</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">fluid_membership</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">segment_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">fluid_membership</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">avg_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">segment_sizes</span><span class="op">)</span></span>
<span>  <span class="va">max_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">segment_sizes</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Level"</span>, <span class="va">i</span>, <span class="st">":"</span>, <span class="va">n_segments</span>, <span class="st">"segments, avg size"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">avg_size</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>      <span class="st">", largest segment"</span>, <span class="va">max_size</span>, <span class="st">"classes\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Level 1 : 30 segments, avg size 1 , largest segment 1 classes</span></span>
<span><span class="co">#&gt; Level 2 : 4 segments, avg size 7.5 , largest segment 10 classes</span></span>
<span></span>
<span><span class="co"># Show first 12 class memberships for comparison</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nSegment membership comparison for first 12 classes:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Segment membership comparison for first 12 classes:</span></span>
<span><span class="va">comparison_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Class"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%02d"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Rigid_L2 <span class="op">=</span> <span class="va">rigid_membership</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span>,</span>
<span>  Fluid_L2 <span class="op">=</span> <span class="va">fluid_membership</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">rigid_membership</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">3</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fluid_membership</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">comparison_df</span><span class="op">$</span><span class="va">Rigid_L3</span> <span class="op">&lt;-</span> <span class="va">rigid_membership</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span></span>
<span>  <span class="va">comparison_df</span><span class="op">$</span><span class="va">Fluid_L3</span> <span class="op">&lt;-</span> <span class="va">fluid_membership</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comparison_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Class Rigid_L2 Fluid_L2</span></span>
<span><span class="co">#&gt; 1  Class 01      4.1      4.1</span></span>
<span><span class="co">#&gt; 2  Class 02      4.1      4.1</span></span>
<span><span class="co">#&gt; 3  Class 03      4.1      4.1</span></span>
<span><span class="co">#&gt; 4  Class 04      4.1      4.1</span></span>
<span><span class="co">#&gt; 5  Class 05      4.1      4.1</span></span>
<span><span class="co">#&gt; 6  Class 06      4.1      4.1</span></span>
<span><span class="co">#&gt; 7  Class 07      4.1      4.1</span></span>
<span><span class="co">#&gt; 8  Class 08      4.1      4.2</span></span>
<span><span class="co">#&gt; 9  Class 09      4.1      4.2</span></span>
<span><span class="co">#&gt; 10 Class 10      4.1      4.2</span></span>
<span><span class="co">#&gt; 11 Class 11      4.1      4.2</span></span>
<span><span class="co">#&gt; 12 Class 12      4.1      4.2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="comparing-mobility-regimes-accessibility-focused-visualizations">Comparing Mobility Regimes: Accessibility-Focused
Visualizations<a class="anchor" aria-label="anchor" href="#comparing-mobility-regimes-accessibility-focused-visualizations"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare rigid vs fluid systems for 30-class networks</span></span>
<span><span class="co"># Using colorblind-safe palettes and clear differentiation</span></span>
<span></span>
<span><span class="co"># Plot rigid system - emphasis on strong boundaries</span></span>
<span><span class="co"># Note: High immobility rates create distinct, well-separated segments</span></span>
<span><span class="va">p_rigid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_moneca_ggraph.html">plot_moneca_ggraph</a></span><span class="op">(</span></span>
<span>  <span class="va">rigid_seg</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Rigid Class System: Strong Internal Cohesion (30 Classes)"</span>,</span>
<span>  layout <span class="op">=</span> <span class="st">"stress"</span>,</span>
<span>  node_color <span class="op">=</span> <span class="st">"segment"</span>,</span>
<span>  node_size <span class="op">=</span> <span class="st">"total"</span>,</span>
<span>  color_palette <span class="op">=</span> <span class="st">"Oranges"</span>,  <span class="co"># Sequential palette for rigid structure</span></span>
<span>  edge_color <span class="op">=</span> <span class="st">"grey20"</span>,</span>
<span>  show_segments <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  segment_alpha <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  node_alpha <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  edge_alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  show_labels <span class="op">=</span> <span class="cn">FALSE</span>  <span class="co"># No labels for 30-node network</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/compare_plots-1.png" class="r-plt" alt="" width="100%"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Plot fluid system - emphasis on connectivity</span></span>
<span><span class="co"># Note: Strong cross-segment mobility creates overlapping, less distinct boundaries</span></span>
<span><span class="va">p_fluid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_moneca_ggraph.html">plot_moneca_ggraph</a></span><span class="op">(</span></span>
<span>  <span class="va">fluid_seg</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Fluid Mobility System: High Inter-Segment Flow (30 Classes)"</span>,</span>
<span>  layout <span class="op">=</span> <span class="st">"stress"</span>,</span>
<span>  node_color <span class="op">=</span> <span class="st">"segment"</span>,</span>
<span>  node_size <span class="op">=</span> <span class="st">"mobility"</span>,  <span class="co"># Size by mobility rate to show fluidity</span></span>
<span>  color_palette <span class="op">=</span> <span class="st">"Purples"</span>,  <span class="co"># Different sequential palette for contrast</span></span>
<span>  edge_color <span class="op">=</span> <span class="st">"grey30"</span>,</span>
<span>  show_segments <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  segment_alpha <span class="op">=</span> <span class="fl">0.15</span>,  <span class="co"># Lower alpha for fluid boundaries</span></span>
<span>  node_alpha <span class="op">=</span> <span class="fl">0.85</span>,</span>
<span>  edge_alpha <span class="op">=</span> <span class="fl">0.7</span>,  <span class="co"># Higher edge alpha to show connectivity</span></span>
<span>  show_labels <span class="op">=</span> <span class="cn">FALSE</span>  <span class="co"># No labels for 30-node network</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/compare_plots-2.png" class="r-plt" alt="" width="100%"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p_rigid</span><span class="op">)</span></span>
<span><span class="co">#&gt; TableGrob (3 x 2) "arrange": 4 grobs</span></span>
<span><span class="co">#&gt;   z     cells    name                grob</span></span>
<span><span class="co">#&gt; 1 1 (2-2,1-1) arrange      gtable[layout]</span></span>
<span><span class="co">#&gt; 2 2 (2-2,2-2) arrange      gtable[layout]</span></span>
<span><span class="co">#&gt; 3 3 (3-3,1-1) arrange      gtable[layout]</span></span>
<span><span class="co">#&gt; 4 4 (1-1,1-2) arrange text[GRID.text.834]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p_fluid</span><span class="op">)</span></span>
<span><span class="co">#&gt; TableGrob (3 x 2) "arrange": 4 grobs</span></span>
<span><span class="co">#&gt;   z     cells    name                grob</span></span>
<span><span class="co">#&gt; 1 1 (2-2,1-1) arrange      gtable[layout]</span></span>
<span><span class="co">#&gt; 2 2 (2-2,2-2) arrange      gtable[layout]</span></span>
<span><span class="co">#&gt; 3 3 (3-3,1-1) arrange      gtable[layout]</span></span>
<span><span class="co">#&gt; 4 4 (1-1,1-2) arrange text[GRID.text.948]</span></span>
<span></span>
<span><span class="co"># Add network density comparison</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nNetwork characteristics comparison:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Network characteristics comparison:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Rigid system - segments at Level 2:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">rigid_seg</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rigid system - segments at Level 2: 10</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Fluid system - segments at Level 2:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fluid_seg</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fluid system - segments at Level 2: 10</span></span>
<span></span>
<span><span class="co"># Calculate edge densities</span></span>
<span><span class="va">rigid_edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu"><a href="../reference/segment.edges.html">segment.edges</a></span><span class="op">(</span><span class="va">rigid_seg</span>, level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="../reference/segment.edges.html">segment.edges</a></span><span class="op">(</span><span class="va">rigid_seg</span>, level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">fluid_edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu"><a href="../reference/segment.edges.html">segment.edges</a></span><span class="op">(</span><span class="va">fluid_seg</span>, level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="../reference/segment.edges.html">segment.edges</a></span><span class="op">(</span><span class="va">fluid_seg</span>, level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">max_edges</span> <span class="op">&lt;-</span> <span class="fl">30</span> <span class="op">*</span> <span class="fl">29</span>  <span class="co"># Directed graph</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Rigid system edge density:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">rigid_edges</span> <span class="op">/</span> <span class="va">max_edges</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rigid system edge density: 13.1 %</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Fluid system edge density:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fluid_edges</span> <span class="op">/</span> <span class="va">max_edges</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fluid system edge density: 13.1 %</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="advanced-visualization-techniques">Advanced Visualization Techniques<a class="anchor" aria-label="anchor" href="#advanced-visualization-techniques"></a>
</h3>
<div class="section level4">
<h4 id="dendrogram-visualization-for-hierarchical-structure">Dendrogram Visualization for Hierarchical Structure<a class="anchor" aria-label="anchor" href="#dendrogram-visualization-for-hierarchical-structure"></a>
</h4>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a dendrogram showing the hierarchical clustering structure</span></span>
<span><span class="co"># This provides a clear view of how categories are progressively aggregated</span></span>
<span><span class="va">dendro_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_moneca_dendrogram.html">plot_moneca_dendrogram</a></span><span class="op">(</span></span>
<span>  <span class="va">seg</span>,</span>
<span>  height_method <span class="op">=</span> <span class="st">"uniform"</span>,          <span class="co"># Equal spacing between levels</span></span>
<span>  color_segments <span class="op">=</span> <span class="cn">TRUE</span>,              <span class="co"># Color branches by final segments</span></span>
<span>  show_labels <span class="op">=</span> <span class="cn">TRUE</span>,                 <span class="co"># Show category names</span></span>
<span>  label_size <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>  branch_width <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"MONECA Hierarchical Structure"</span>,</span>
<span>  subtitle <span class="op">=</span> <span class="st">"Shows progressive aggregation from individual categories to segments"</span>,</span>
<span>  color_palette <span class="op">=</span> <span class="st">"Set2"</span>,             <span class="co"># Colorblind-friendly palette</span></span>
<span>  theme_style <span class="op">=</span> <span class="st">"minimal"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">dendro_plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/dendrogram_plot-1.png" class="r-plt" alt="" width="100%"></p>
</div>
<div class="section level4">
<h4 id="quality-assessment-visualization">Quality Assessment Visualization<a class="anchor" aria-label="anchor" href="#quality-assessment-visualization"></a>
</h4>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Comprehensive segment quality analysis</span></span>
<span><span class="va">quality_overview</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_segment_quality.html">plot_segment_quality</a></span><span class="op">(</span></span>
<span>  <span class="va">seg</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="st">"overview"</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  color_palette <span class="op">=</span> <span class="st">"Set3"</span>,</span>
<span>  theme_style <span class="op">=</span> <span class="st">"minimal"</span>,</span>
<span>  show_labels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  label_size <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/quality_plots-1.png" class="r-plt" alt="" width="100%"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">quality_overview</span><span class="op">)</span></span>
<span><span class="co">#&gt; TableGrob (3 x 2) "arrange": 5 grobs</span></span>
<span><span class="co">#&gt;   z     cells    name                 grob</span></span>
<span><span class="co">#&gt; 1 1 (2-2,1-1) arrange       gtable[layout]</span></span>
<span><span class="co">#&gt; 2 2 (2-2,2-2) arrange       gtable[layout]</span></span>
<span><span class="co">#&gt; 3 3 (3-3,1-1) arrange       gtable[layout]</span></span>
<span><span class="co">#&gt; 4 4 (3-3,2-2) arrange       gtable[layout]</span></span>
<span><span class="co">#&gt; 5 5 (1-1,1-2) arrange text[GRID.text.1169]</span></span>
<span></span>
<span><span class="co"># Cohesion vs Size Analysis</span></span>
<span><span class="va">cohesion_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_segment_quality.html">plot_segment_quality</a></span><span class="op">(</span></span>
<span>  <span class="va">seg</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="st">"cohesion"</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Segment Quality Analysis: Cohesion vs Size"</span>,</span>
<span>  color_palette <span class="op">=</span> <span class="st">"Dark2"</span>,</span>
<span>  show_labels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  label_size <span class="op">=</span> <span class="fl">3.5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cohesion_plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/quality_plots-2.png" class="r-plt" alt="" width="100%"></p>
</div>
</div>
<div class="section level3">
<h3 id="custom-segment-naming-for-enhanced-interpretation">Custom Segment Naming for Enhanced Interpretation<a class="anchor" aria-label="anchor" href="#custom-segment-naming-for-enhanced-interpretation"></a>
</h3>
<p>MONECA includes enhanced segment naming functionality that allows you
to provide meaningful, domain-specific labels for your mobility
categories. This feature dramatically improves the interpretability of
visualizations by replacing generic class names with substantive
descriptions.</p>
<div class="section level4">
<h4 id="basic-naming-strategies">Basic Naming Strategies<a class="anchor" aria-label="anchor" href="#basic-naming-strategies"></a>
</h4>
<p>The <code>segment_naming</code> parameter accepts several types of
input:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate example data with meaningful class names</span></span>
<span><span class="va">occupational_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_mobility_data.html">generate_mobility_data</a></span><span class="op">(</span></span>
<span>  n_classes <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  class_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Executive"</span>, <span class="st">"Professional"</span>, <span class="st">"Manager"</span>, <span class="st">"Technical"</span>, </span>
<span>                  <span class="st">"Skilled Worker"</span>, <span class="st">"Service Worker"</span>, <span class="st">"Clerical"</span>, <span class="st">"Manual Worker"</span><span class="op">)</span>,</span>
<span>  n_total <span class="op">=</span> <span class="fl">8000</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run MONECA analysis</span></span>
<span><span class="va">occ_seg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca.html">moneca</a></span><span class="op">(</span><span class="va">occupational_data</span>, segment.levels <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%</span></span>
<span><span class="co">#&gt; 27% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%</span></span>
<span><span class="co">#&gt; 55% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%</span></span>
<span><span class="co">#&gt; 82% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; 100% ready!</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%</span></span>
<span><span class="co">#&gt; 100% ready!</span></span>
<span></span>
<span><span class="co"># Example 1: Auto strategy (default) - uses intelligent pattern recognition</span></span>
<span><span class="va">auto_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_moneca_ggraph.html">plot_moneca_ggraph</a></span><span class="op">(</span></span>
<span>  <span class="va">occ_seg</span>,</span>
<span>  segment_naming <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Auto Naming Strategy: Pattern Recognition"</span>,</span>
<span>  node_color <span class="op">=</span> <span class="st">"segment"</span>,</span>
<span>  show_segments <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  color_palette <span class="op">=</span> <span class="st">"Set2"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/segment_naming_basic-1.png" class="r-plt" alt="" width="100%"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">auto_plot</span><span class="op">)</span></span>
<span><span class="co">#&gt; TableGrob (3 x 2) "arrange": 4 grobs</span></span>
<span><span class="co">#&gt;   z     cells    name                 grob</span></span>
<span><span class="co">#&gt; 1 1 (2-2,1-1) arrange       gtable[layout]</span></span>
<span><span class="co">#&gt; 2 2 (2-2,2-2) arrange       gtable[layout]</span></span>
<span><span class="co">#&gt; 3 3 (3-3,1-1) arrange       gtable[layout]</span></span>
<span><span class="co">#&gt; 4 4 (1-1,1-2) arrange text[GRID.text.1309]</span></span>
<span></span>
<span><span class="co"># Example 2: Concatenation strategy - joins names with separator</span></span>
<span><span class="va">concat_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_moneca_ggraph.html">plot_moneca_ggraph</a></span><span class="op">(</span></span>
<span>  <span class="va">occ_seg</span>,</span>
<span>  segment_naming <span class="op">=</span> <span class="st">"concat"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Concatenation Strategy: Joined Names"</span>,</span>
<span>  node_color <span class="op">=</span> <span class="st">"segment"</span>,</span>
<span>  show_segments <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  color_palette <span class="op">=</span> <span class="st">"Dark2"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/segment_naming_basic-2.png" class="r-plt" alt="" width="100%"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">concat_plot</span><span class="op">)</span></span>
<span><span class="co">#&gt; TableGrob (3 x 2) "arrange": 4 grobs</span></span>
<span><span class="co">#&gt;   z     cells    name                 grob</span></span>
<span><span class="co">#&gt; 1 1 (2-2,1-1) arrange       gtable[layout]</span></span>
<span><span class="co">#&gt; 2 2 (2-2,2-2) arrange       gtable[layout]</span></span>
<span><span class="co">#&gt; 3 3 (3-3,1-1) arrange       gtable[layout]</span></span>
<span><span class="co">#&gt; 4 4 (1-1,1-2) arrange text[GRID.text.1428]</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="advanced-custom-naming-with-data-frames">Advanced Custom Naming with Data Frames<a class="anchor" aria-label="anchor" href="#advanced-custom-naming-with-data-frames"></a>
</h4>
<p>The most powerful feature is the ability to provide custom labels
using a data.frame:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create custom segment labels that provide analytical insight</span></span>
<span><span class="va">custom_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Executive"</span>, <span class="st">"Professional"</span>, <span class="st">"Manager"</span>, <span class="st">"Technical"</span>, </span>
<span>           <span class="st">"Skilled Worker"</span>, <span class="st">"Service Worker"</span>, <span class="st">"Clerical"</span>, <span class="st">"Manual Worker"</span><span class="op">)</span>,</span>
<span>  segment_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Senior Leadership"</span>,      <span class="co"># Executive</span></span>
<span>    <span class="st">"Knowledge Workers"</span>,      <span class="co"># Professional  </span></span>
<span>    <span class="st">"Middle Management"</span>,      <span class="co"># Manager</span></span>
<span>    <span class="st">"Technical Specialists"</span>,  <span class="co"># Technical</span></span>
<span>    <span class="st">"Craft Workers"</span>,         <span class="co"># Skilled Worker</span></span>
<span>    <span class="st">"Service Industry"</span>,      <span class="co"># Service Worker</span></span>
<span>    <span class="st">"Administrative Staff"</span>,  <span class="co"># Clerical</span></span>
<span>    <span class="st">"Production Workers"</span>     <span class="co"># Manual Worker</span></span>
<span>  <span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Custom segment labels mapping:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Custom segment labels mapping:"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">custom_labels</span><span class="op">)</span></span>
<span><span class="co">#&gt;             name         segment_label</span></span>
<span><span class="co">#&gt; 1      Executive     Senior Leadership</span></span>
<span><span class="co">#&gt; 2   Professional     Knowledge Workers</span></span>
<span><span class="co">#&gt; 3        Manager     Middle Management</span></span>
<span><span class="co">#&gt; 4      Technical Technical Specialists</span></span>
<span><span class="co">#&gt; 5 Skilled Worker         Craft Workers</span></span>
<span><span class="co">#&gt; 6 Service Worker      Service Industry</span></span>
<span><span class="co">#&gt; 7       Clerical  Administrative Staff</span></span>
<span><span class="co">#&gt; 8  Manual Worker    Production Workers</span></span>
<span></span>
<span><span class="co"># Use custom labels in main network plot</span></span>
<span><span class="va">custom_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_moneca_ggraph.html">plot_moneca_ggraph</a></span><span class="op">(</span></span>
<span>  <span class="va">occ_seg</span>,</span>
<span>  segment_naming <span class="op">=</span> <span class="va">custom_labels</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Custom Segment Naming: Occupational Class Structure"</span>,</span>
<span>  node_color <span class="op">=</span> <span class="st">"segment"</span>,</span>
<span>  node_size <span class="op">=</span> <span class="st">"total"</span>,</span>
<span>  show_segments <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  segment_alpha <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  color_palette <span class="op">=</span> <span class="st">"Set3"</span>,</span>
<span>  show_labels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  label_size <span class="op">=</span> <span class="fl">3.5</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/segment_naming_custom-1.png" class="r-plt" alt="" width="100%"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">custom_plot</span><span class="op">)</span></span>
<span><span class="co">#&gt; TableGrob (3 x 2) "arrange": 4 grobs</span></span>
<span><span class="co">#&gt;   z     cells    name                 grob</span></span>
<span><span class="co">#&gt; 1 1 (2-2,1-1) arrange       gtable[layout]</span></span>
<span><span class="co">#&gt; 2 2 (2-2,2-2) arrange       gtable[layout]</span></span>
<span><span class="co">#&gt; 3 3 (3-3,1-1) arrange       gtable[layout]</span></span>
<span><span class="co">#&gt; 4 4 (1-1,1-2) arrange text[GRID.text.1605]</span></span>
<span></span>
<span><span class="co"># Show how this works across different plot types</span></span>
<span><span class="co"># Ego network with custom naming</span></span>
<span><span class="va">ego_custom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_ego_ggraph.html">plot_ego_ggraph</a></span><span class="op">(</span></span>
<span>  <span class="va">occ_seg</span>,</span>
<span>  <span class="va">occupational_data</span>,</span>
<span>  ego_id <span class="op">=</span> <span class="fl">4</span>,  <span class="co"># Technical worker</span></span>
<span>  segment_naming <span class="op">=</span> <span class="va">custom_labels</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Technical Specialists: Mobility Patterns"</span>,</span>
<span>  highlight_color <span class="op">=</span> <span class="st">"#E31A1C"</span>,</span>
<span>  flow_color <span class="op">=</span> <span class="st">"viridis"</span>,</span>
<span>  min_weight <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ego_custom</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/segment_naming_custom-2.png" class="r-plt" alt="" width="100%"></p>
</div>
<div class="section level4">
<h4 id="partial-custom-naming">Partial Custom Naming<a class="anchor" aria-label="anchor" href="#partial-custom-naming"></a>
</h4>
<p>You can provide custom names for only some categories, with others
using default strategies:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Partial custom naming - focus on key categories</span></span>
<span><span class="va">key_positions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Executive"</span>, <span class="st">"Professional"</span>, <span class="st">"Manual Worker"</span><span class="op">)</span>,</span>
<span>  segment_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Corporate Elite"</span>, <span class="st">"Professional Class"</span>, <span class="st">"Working Class"</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">partial_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_moneca_ggraph.html">plot_moneca_ggraph</a></span><span class="op">(</span></span>
<span>  <span class="va">occ_seg</span>,</span>
<span>  segment_naming <span class="op">=</span> <span class="va">key_positions</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Partial Custom Naming: Highlighting Key Social Classes"</span>,</span>
<span>  node_color <span class="op">=</span> <span class="st">"segment"</span>,</span>
<span>  node_size <span class="op">=</span> <span class="st">"mobility"</span>,</span>
<span>  color_palette <span class="op">=</span> <span class="st">"Spectral"</span>,</span>
<span>  show_segments <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  segment_alpha <span class="op">=</span> <span class="fl">0.15</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/segment_naming_partial-1.png" class="r-plt" alt="" width="100%"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">partial_plot</span><span class="op">)</span></span>
<span><span class="co">#&gt; TableGrob (3 x 2) "arrange": 4 grobs</span></span>
<span><span class="co">#&gt;   z     cells    name                 grob</span></span>
<span><span class="co">#&gt; 1 1 (2-2,1-1) arrange       gtable[layout]</span></span>
<span><span class="co">#&gt; 2 2 (2-2,2-2) arrange       gtable[layout]</span></span>
<span><span class="co">#&gt; 3 3 (3-3,1-1) arrange       gtable[layout]</span></span>
<span><span class="co">#&gt; 4 4 (1-1,1-2) arrange text[GRID.text.1821]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\\nPartial custom naming allows focus on analytically important categories\\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; \nPartial custom naming allows focus on analytically important categories\n</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"while maintaining readability for other positions.\\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; while maintaining readability for other positions.\n</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="multi-level-analysis-with-custom-naming">Multi-Level Analysis with Custom Naming<a class="anchor" aria-label="anchor" href="#multi-level-analysis-with-custom-naming"></a>
</h4>
<p>Custom naming works seamlessly across hierarchical levels:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Multi-level visualization with consistent custom naming</span></span>
<span><span class="va">multilevel_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_stair_ggraph.html">plot_stair_ggraph</a></span><span class="op">(</span></span>
<span>  <span class="va">occ_seg</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  segment_naming <span class="op">=</span> <span class="va">custom_labels</span>,</span>
<span>  color_palette <span class="op">=</span> <span class="st">"Set2"</span>,</span>
<span>  node_size <span class="op">=</span> <span class="st">"total"</span>,</span>
<span>  show_segments <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  segment_alpha <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  label_size <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">multilevel_plots</span><span class="op">$</span><span class="va">`Level 2`</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/segment_naming_multilevel-1.png" class="r-plt" alt="" width="100%"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">multilevel_plots</span><span class="op">$</span><span class="va">`Level 3`</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/segment_naming_multilevel-2.png" class="r-plt" alt="" width="100%"></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Show progression of segmentation with meaningful names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\\nMulti-level segmentation progression with custom names:\\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; \nMulti-level segmentation progression with custom names:\n</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">level</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">n_segments</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">occ_seg</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="va">level</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">avg_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">occ_seg</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="va">level</span><span class="op">]</span><span class="op">]</span>, <span class="va">length</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Level"</span>, <span class="va">level</span>, <span class="st">":"</span>, <span class="va">n_segments</span>, <span class="st">"occupational segments,"</span>, </span>
<span>      <span class="st">"average"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">avg_size</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"classes per segment\\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Level 2 : 3 occupational segments, average 2.7 classes per segment\nLevel 3 : 1 occupational segments, average 5 classes per segment\n</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="practical-applications">Practical Applications<a class="anchor" aria-label="anchor" href="#practical-applications"></a>
</h4>
<p>Custom segment naming is particularly valuable for:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Occupational Mobility</strong>: Use job titles or
occupational categories</li>
<li>
<strong>Educational Analysis</strong>: Replace generic levels with
degree types</li>
<li>
<strong>Geographic Studies</strong>: Use meaningful place names
instead of codes</li>
<li>
<strong>Industry Analysis</strong>: Employ sector names or industry
classifications</li>
<li>
<strong>International Comparisons</strong>: Apply country-specific
terminology</li>
</ol>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example applications for different research contexts</span></span>
<span></span>
<span><span class="co"># Educational mobility</span></span>
<span><span class="va">education_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Level1"</span>, <span class="st">"Level2"</span>, <span class="st">"Level3"</span>, <span class="st">"Level4"</span><span class="op">)</span>,</span>
<span>  segment_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"No Degree"</span>, <span class="st">"High School"</span>, <span class="st">"Bachelor's"</span>, <span class="st">"Graduate"</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Geographic mobility  </span></span>
<span><span class="va">geographic_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Region_A"</span>, <span class="st">"Region_B"</span>, <span class="st">"Region_C"</span><span class="op">)</span>,</span>
<span>  segment_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Metropolitan"</span>, <span class="st">"Suburban"</span>, <span class="st">"Rural"</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Industry sectors</span></span>
<span><span class="va">industry_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sector1"</span>, <span class="st">"Sector2"</span>, <span class="st">"Sector3"</span>, <span class="st">"Sector4"</span><span class="op">)</span>,</span>
<span>  segment_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Manufacturing"</span>, <span class="st">"Services"</span>, <span class="st">"Technology"</span>, <span class="st">"Healthcare"</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use in analysis</span></span>
<span><span class="fu"><a href="../reference/plot_moneca_ggraph.html">plot_moneca_ggraph</a></span><span class="op">(</span><span class="va">seg</span>, segment_naming <span class="op">=</span> <span class="va">education_labels</span>, </span>
<span>                  title <span class="op">=</span> <span class="st">"Educational Mobility Networks"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="interpretation-guidelines-for-visualizations">Interpretation Guidelines for Visualizations<a class="anchor" aria-label="anchor" href="#interpretation-guidelines-for-visualizations"></a>
</h3>
<p>When interpreting MONECA network visualizations, consider these key
elements:</p>
<div class="section level4">
<h4 id="network-layout-interpretation">Network Layout Interpretation<a class="anchor" aria-label="anchor" href="#network-layout-interpretation"></a>
</h4>
<ul>
<li>
<strong>Node Position</strong>: Reflects mathematical similarity in
mobility patterns</li>
<li>
<strong>Edge Thickness</strong>: Proportional to relative risk of
mobility between positions<br>
</li>
<li>
<strong>Cluster Proximity</strong>: Positions with similar mobility
profiles appear closer together</li>
<li>
<strong>Segment Boundaries</strong>: Convex hulls show positions
with high internal mobility</li>
</ul>
</div>
<div class="section level4">
<h4 id="color-and-size-encoding">Color and Size Encoding<a class="anchor" aria-label="anchor" href="#color-and-size-encoding"></a>
</h4>
<ul>
<li>
<strong>Node Colors</strong>: Represent segment membership at the
specified hierarchical level</li>
<li>
<strong>Node Sizes</strong>: Can represent total mobility volume,
mobility rates, or custom metrics</li>
<li>
<strong>Edge Colors</strong>: Often represent flow direction or
connection strength</li>
<li>
<strong>Transparency</strong>: Used to manage visual complexity
while preserving information</li>
</ul>
</div>
<div class="section level4">
<h4 id="custom-naming-benefits">Custom Naming Benefits<a class="anchor" aria-label="anchor" href="#custom-naming-benefits"></a>
</h4>
<ul>
<li>
<strong>Enhanced Readability</strong>: Meaningful labels improve
immediate comprehension</li>
<li>
<strong>Domain Relevance</strong>: Context-specific terminology aids
interpretation</li>
<li>
<strong>Professional Presentation</strong>: Polished visualizations
for publications and reports</li>
<li>
<strong>Analytical Focus</strong>: Highlight theoretically important
distinctions</li>
</ul>
</div>
<div class="section level4">
<h4 id="accessibility-features">Accessibility Features<a class="anchor" aria-label="anchor" href="#accessibility-features"></a>
</h4>
<p>All plots include several accessibility enhancements:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example showing all accessibility features</span></span>
<span><span class="va">accessible_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_moneca_ggraph.html">plot_moneca_ggraph</a></span><span class="op">(</span></span>
<span>  <span class="va">seg</span>,</span>
<span>  <span class="co"># Colorblind-safe palettes</span></span>
<span>  color_palette <span class="op">=</span> <span class="st">"Set2"</span>,           <span class="co"># For categorical: "Set2", "Dark2", "Paired"</span></span>
<span>                                    <span class="co"># For continuous: "viridis", "plasma", "inferno"</span></span>
<span>  </span>
<span>  <span class="co"># High contrast settings</span></span>
<span>  node_alpha <span class="op">=</span> <span class="fl">0.85</span>,               <span class="co"># Strong node visibility</span></span>
<span>  edge_alpha <span class="op">=</span> <span class="fl">0.6</span>,                <span class="co"># Balanced edge visibility</span></span>
<span>  edge_color <span class="op">=</span> <span class="st">"grey30"</span>,           <span class="co"># Dark edges for contrast</span></span>
<span>  </span>
<span>  <span class="co"># Redundant encoding (color + size + position)</span></span>
<span>  node_color <span class="op">=</span> <span class="st">"segment"</span>,          <span class="co"># Color by segment</span></span>
<span>  node_size <span class="op">=</span> <span class="st">"total"</span>,             <span class="co"># Size by mobility volume</span></span>
<span>  </span>
<span>  <span class="co"># Clear labeling</span></span>
<span>  show_labels <span class="op">=</span> <span class="cn">TRUE</span>,              <span class="co"># Display node names</span></span>
<span>  label_size <span class="op">=</span> <span class="fl">3.5</span>,                <span class="co"># Readable text size</span></span>
<span>  show_segments <span class="op">=</span> <span class="cn">TRUE</span>,            <span class="co"># Segment boundaries</span></span>
<span>  </span>
<span>  <span class="co"># Informative titles</span></span>
<span>  title <span class="op">=</span> <span class="st">"Descriptive Title"</span>      <span class="co"># Clear context</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="analytical-functions">Analytical Functions<a class="anchor" aria-label="anchor" href="#analytical-functions"></a>
</h2>
<div class="section level3">
<h3 id="segment-quality-assessment">Segment Quality Assessment<a class="anchor" aria-label="anchor" href="#segment-quality-assessment"></a>
</h3>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assess the quality of segmentation for 30-class system</span></span>
<span><span class="va">level2_matrix</span> <span class="op">&lt;-</span> <span class="va">seg</span><span class="op">$</span><span class="va">mat.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Level 2 aggregated matrix dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">level2_matrix</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Level 2 aggregated matrix dimensions: 13 13</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Level 2 mobility matrix (aggregated):"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Level 2 mobility matrix (aggregated):"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">level2_matrix</span><span class="op">)</span></span>
<span><span class="co">#&gt;       1    2    3    4    5    6    7    8    9   10   11   12    31</span></span>
<span><span class="co">#&gt; 1  1203   15   12   15   14    6    9  149   82   12    6    7  1530</span></span>
<span><span class="co">#&gt; 2    21 1688   22   16   16   15   20   19  177   22    5    7  2028</span></span>
<span><span class="co">#&gt; 3    21   10 1516   16   16    6  196   28   25   25   46    6  1911</span></span>
<span><span class="co">#&gt; 4    22   32   26 2355   28  240  171   30   39   20   15    4  2982</span></span>
<span><span class="co">#&gt; 5    42   45   32   47 3257   23   21   92   53  420   10  129  4171</span></span>
<span><span class="co">#&gt; 6    51   37   46  308   47 3343   28   42   37   43   12   19  4013</span></span>
<span><span class="co">#&gt; 7    41   49  680  356   36   33 3752   42   39   42   21   15  5106</span></span>
<span><span class="co">#&gt; 8   397   62   60   66  225   46   47 5715   78   75   30  442  7243</span></span>
<span><span class="co">#&gt; 9   452  523   64   64   58   40   54   52 5303   82   16   19  6727</span></span>
<span><span class="co">#&gt; 10   65   71  173   58  424   43   38   70   51 5567  342   26  6928</span></span>
<span><span class="co">#&gt; 11   32   30  431   23   22   25   15   21   20  456 2036   12  3123</span></span>
<span><span class="co">#&gt; 12   59   48   29   34  629   36   26  609   42   34   14 2678  4238</span></span>
<span><span class="co">#&gt; 31 2406 2610 3091 3358 4772 3856 4377 6869 5946 6798 2553 3364 50000</span></span>
<span></span>
<span><span class="co"># Calculate internal mobility rates for each segment</span></span>
<span><span class="co"># Use actual number of segments from segment.list instead of matrix dimensions</span></span>
<span><span class="va">actual_n_segments</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">seg</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">n_segments</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">level2_matrix</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># Ensure we use the correct number of segments (the smaller of the two)</span></span>
<span><span class="va">active_segments</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">actual_n_segments</span>, <span class="va">n_segments</span><span class="op">)</span></span>
<span></span>
<span><span class="va">internal_mobility</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">level2_matrix</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">active_segments</span>, <span class="fl">1</span><span class="op">:</span><span class="va">active_segments</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">total_mobility</span> <span class="op">&lt;-</span> <span class="va">level2_matrix</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">active_segments</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">level2_matrix</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">immobility_rates</span> <span class="op">&lt;-</span> <span class="va">internal_mobility</span> <span class="op">/</span> <span class="va">total_mobility</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nImmobility rates by segment at Level 2:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Immobility rates by segment at Level 2:</span></span>
<span><span class="va">segment_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Segment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Segment"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">active_segments</span><span class="op">)</span>,</span>
<span>  Size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">seg</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="va">length</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">active_segments</span><span class="op">]</span>,</span>
<span>  Total_Population <span class="op">=</span> <span class="va">total_mobility</span>,</span>
<span>  Internal_Mobility <span class="op">=</span> <span class="va">internal_mobility</span>,</span>
<span>  Immobility_Rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">immobility_rates</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">segment_summary</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Segment Size Total_Population Internal_Mobility Immobility_Rate</span></span>
<span><span class="co">#&gt; 1   Segment 1    3             1530              1203            78.6</span></span>
<span><span class="co">#&gt; 2   Segment 2    3             2028              1688            83.2</span></span>
<span><span class="co">#&gt; 3   Segment 3    3             1911              1516            79.3</span></span>
<span><span class="co">#&gt; 4   Segment 4    3             2982              2355            79.0</span></span>
<span><span class="co">#&gt; 5   Segment 5    3             4171              3257            78.1</span></span>
<span><span class="co">#&gt; 6   Segment 6    2             4013              3343            83.3</span></span>
<span><span class="co">#&gt; 7   Segment 7    2             5106              3752            73.5</span></span>
<span><span class="co">#&gt; 8   Segment 8    3             7243              5715            78.9</span></span>
<span><span class="co">#&gt; 9   Segment 9    3             6727              5303            78.8</span></span>
<span><span class="co">#&gt; 10 Segment 10    3             6928              5567            80.4</span></span>
<span></span>
<span><span class="co"># Calculate overall segmentation quality metrics</span></span>
<span><span class="va">overall_internal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">internal_mobility</span><span class="op">)</span></span>
<span><span class="va">overall_total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">level2_matrix</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">active_segments</span>, <span class="fl">1</span><span class="op">:</span><span class="va">active_segments</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">overall_immobility_rate</span> <span class="op">&lt;-</span> <span class="va">overall_internal</span> <span class="op">/</span> <span class="va">overall_total</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nOverall Level 2 segmentation quality:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Overall Level 2 segmentation quality:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Total segments:"</span>, <span class="va">active_segments</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Total segments: 10</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Average segment size:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">segment_summary</span><span class="op">$</span><span class="va">Size</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"classes\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Average segment size: 2.8 classes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Overall internal mobility rate:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">overall_immobility_rate</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Overall internal mobility rate: 81.3 %</span></span>
<span></span>
<span><span class="co"># Compare to Level 1 (original classes)</span></span>
<span><span class="va">level1_internal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">basic_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">level1_total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">basic_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">level1_rate</span> <span class="op">&lt;-</span> <span class="va">level1_internal</span> <span class="op">/</span> <span class="va">level1_total</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Level 1 internal mobility rate:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">level1_rate</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Level 1 internal mobility rate: 64.6 %</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Improvement in clustering:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="va">overall_immobility_rate</span> <span class="op">-</span> <span class="va">level1_rate</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"percentage points\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Improvement in clustering: 16.7 percentage points</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="edge-analysis">Edge Analysis<a class="anchor" aria-label="anchor" href="#edge-analysis"></a>
</h3>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Examine edge weights between classes (Level 1) for 30-class system</span></span>
<span><span class="va">edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/segment.edges.html">segment.edges</a></span><span class="op">(</span><span class="va">seg</span>, level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Edge weights matrix dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">edges</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Edge weights matrix dimensions: 30 30</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Number of significant edges (RR &gt; 1):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">edges</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">edges</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of significant edges (RR &gt; 1): 104</span></span>
<span></span>
<span><span class="co"># Show subset of edge weights matrix (first 10x10)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nEdge weights matrix (first 10x10 subset):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Edge weights matrix (first 10x10 subset):</span></span>
<span><span class="va">edges_subset</span> <span class="op">&lt;-</span> <span class="va">edges</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">edges_subset</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;          Class 01 Class 02 Class 03 Class 04 Class 05 Class 06 Class 07</span></span>
<span><span class="co">#&gt; Class 01     0.00     5.05     1.85     0.00     0.00     0.00     0.00</span></span>
<span><span class="co">#&gt; Class 02     1.87     0.00     3.83     3.53     0.00     0.00     0.00</span></span>
<span><span class="co">#&gt; Class 03     0.00     4.28     0.00     6.92     1.58     0.00     0.00</span></span>
<span><span class="co">#&gt; Class 04     0.00     2.11     2.51     0.00     3.73     1.68     0.00</span></span>
<span><span class="co">#&gt; Class 05     0.00     0.00     2.06     6.74     0.00     3.27     0.00</span></span>
<span><span class="co">#&gt; Class 06     0.00     0.00     0.00     2.10     3.88     0.00     1.34</span></span>
<span><span class="co">#&gt; Class 07     0.00     0.00     0.00     0.00     2.07     4.11     0.00</span></span>
<span><span class="co">#&gt; Class 08     0.00     0.00     0.00     0.00     0.00     1.79     1.48</span></span>
<span><span class="co">#&gt; Class 09     0.00     0.00     0.00     0.00     0.00     0.00     0.00</span></span>
<span><span class="co">#&gt; Class 10     0.00     0.00     0.00     0.00     0.00     0.00     0.00</span></span>
<span><span class="co">#&gt;          Class 08 Class 09 Class 10</span></span>
<span><span class="co">#&gt; Class 01     0.00     0.00     0.00</span></span>
<span><span class="co">#&gt; Class 02     0.00     0.00     0.00</span></span>
<span><span class="co">#&gt; Class 03     0.00     0.00     0.00</span></span>
<span><span class="co">#&gt; Class 04     0.00     0.00     0.00</span></span>
<span><span class="co">#&gt; Class 05     0.00     0.00     0.00</span></span>
<span><span class="co">#&gt; Class 06     1.25     0.00     0.00</span></span>
<span><span class="co">#&gt; Class 07     3.18     3.00     0.00</span></span>
<span><span class="co">#&gt; Class 08     0.00     5.23     2.96</span></span>
<span><span class="co">#&gt; Class 09     3.55     0.00     7.36</span></span>
<span><span class="co">#&gt; Class 10     2.44     6.76     0.00</span></span>
<span></span>
<span><span class="co"># Focus on strongest connections</span></span>
<span><span class="va">strong_edges</span> <span class="op">&lt;-</span> <span class="va">edges</span></span>
<span><span class="va">strong_edges</span><span class="op">[</span><span class="va">strong_edges</span> <span class="op">&lt;</span> <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">strong_connections</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">strong_edges</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nNumber of strong connections (relative risk &gt; 2):"</span>, <span class="va">strong_connections</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of strong connections (relative risk &gt; 2): 66</span></span>
<span></span>
<span><span class="co"># Show distribution of edge weights</span></span>
<span><span class="va">all_edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">edges</span><span class="op">)</span></span>
<span><span class="va">valid_edges</span> <span class="op">&lt;-</span> <span class="va">all_edges</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">all_edges</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">all_edges</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nEdge weight distribution (RR &gt; 1):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Edge weight distribution (RR &gt; 1):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Min:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">valid_edges</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Min: 1.02</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Median:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">valid_edges</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Median: 2.42</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Mean:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">valid_edges</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Mean: 2.96</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Max:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">valid_edges</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Max: 8.35</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"95th percentile:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">valid_edges</span>, <span class="fl">0.95</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 95th percentile: 6.75</span></span>
<span></span>
<span><span class="co"># Show strongest connections in the network</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">valid_edges</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">threshold_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">valid_edges</span>, <span class="fl">0.95</span><span class="op">)</span></span>
<span>  <span class="va">strongest_indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">edges</span> <span class="op">&gt;</span> <span class="va">threshold_95</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">strongest_indices</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nStrongest connections (top 5% of edge weights):\n"</span><span class="op">)</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">strongest_indices</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">row</span> <span class="op">&lt;-</span> <span class="va">strongest_indices</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span><span class="op">]</span></span>
<span>      <span class="va">col</span> <span class="op">&lt;-</span> <span class="va">strongest_indices</span><span class="op">[</span><span class="va">i</span>, <span class="fl">2</span><span class="op">]</span></span>
<span>      <span class="va">weight</span> <span class="op">&lt;-</span> <span class="va">edges</span><span class="op">[</span><span class="va">row</span>, <span class="va">col</span><span class="op">]</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Class"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%02d"</span>, <span class="va">row</span><span class="op">)</span>, <span class="st">"-&gt; Class"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%02d"</span>, <span class="va">col</span><span class="op">)</span>, </span>
<span>          <span class="st">": RR ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">weight</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Strongest connections (top 5% of edge weights):</span></span>
<span><span class="co">#&gt; Class 03 -&gt; Class 04 : RR = 6.92 </span></span>
<span><span class="co">#&gt; Class 10 -&gt; Class 09 : RR = 6.76 </span></span>
<span><span class="co">#&gt; Class 09 -&gt; Class 10 : RR = 7.36 </span></span>
<span><span class="co">#&gt; Class 22 -&gt; Class 23 : RR = 8.35 </span></span>
<span><span class="co">#&gt; Class 24 -&gt; Class 23 : RR = 8.29 </span></span>
<span><span class="co">#&gt; Class 29 -&gt; Class 30 : RR = 7.48</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="working-with-real-data">Working with Real Data<a class="anchor" aria-label="anchor" href="#working-with-real-data"></a>
</h2>
<p>When working with your own mobility data, ensure it follows the
MONECA format:</p>
<div class="section level3">
<h3 id="data-format-requirements">Data Format Requirements<a class="anchor" aria-label="anchor" href="#data-format-requirements"></a>
</h3>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Your data should be a matrix with:</span></span>
<span><span class="co"># - Rows: origin positions</span></span>
<span><span class="co"># - Columns: destination positions  </span></span>
<span><span class="co"># - Last row: column totals</span></span>
<span><span class="co"># - Last column: row totals</span></span>
<span><span class="co"># - Bottom-right cell: grand total</span></span>
<span></span>
<span><span class="co"># Example of properly formatted data structure (showing 5x5 for clarity):</span></span>
<span><span class="va">example_structure</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">180</span>, <span class="fl">25</span>, <span class="fl">15</span>, <span class="fl">8</span>, <span class="fl">2</span>, <span class="fl">230</span>,    <span class="co"># Origin 1: mostly immobile with some movement</span></span>
<span>  <span class="fl">20</span>, <span class="fl">190</span>, <span class="fl">30</span>, <span class="fl">12</span>, <span class="fl">3</span>, <span class="fl">255</span>,   <span class="co"># Origin 2: similar pattern</span></span>
<span>  <span class="fl">12</span>, <span class="fl">28</span>, <span class="fl">175</span>, <span class="fl">25</span>, <span class="fl">10</span>, <span class="fl">250</span>,  <span class="co"># Origin 3: high diagonal mobility</span></span>
<span>  <span class="fl">6</span>, <span class="fl">15</span>, <span class="fl">20</span>, <span class="fl">160</span>, <span class="fl">19</span>, <span class="fl">220</span>,   <span class="co"># Origin 4: concentrated mobility</span></span>
<span>  <span class="fl">3</span>, <span class="fl">8</span>, <span class="fl">12</span>, <span class="fl">22</span>, <span class="fl">145</span>, <span class="fl">190</span>,    <span class="co"># Origin 5: strong immobility</span></span>
<span>  <span class="fl">221</span>, <span class="fl">266</span>, <span class="fl">252</span>, <span class="fl">227</span>, <span class="fl">179</span>, <span class="fl">1145</span>  <span class="co"># Column totals and grand total</span></span>
<span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">6</span>, ncol <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">example_structure</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Class_A"</span>, <span class="st">"Class_B"</span>, <span class="st">"Class_C"</span>, <span class="st">"Class_D"</span>, <span class="st">"Class_E"</span>, <span class="st">"Total"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">example_structure</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Class_A"</span>, <span class="st">"Class_B"</span>, <span class="st">"Class_C"</span>, <span class="st">"Class_D"</span>, <span class="st">"Class_E"</span>, <span class="st">"Total"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Properly formatted mobility matrix (5x5 example):"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Properly formatted mobility matrix (5x5 example):"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">example_structure</span><span class="op">)</span></span>
<span><span class="co">#&gt;         Class_A Class_B Class_C Class_D Class_E Total</span></span>
<span><span class="co">#&gt; Class_A     180      20      12       6       3   221</span></span>
<span><span class="co">#&gt; Class_B      25     190      28      15       8   266</span></span>
<span><span class="co">#&gt; Class_C      15      30     175      20      12   252</span></span>
<span><span class="co">#&gt; Class_D       8      12      25     160      22   227</span></span>
<span><span class="co">#&gt; Class_E       2       3      10      19     145   179</span></span>
<span><span class="co">#&gt; Total       230     255     250     220     190  1145</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nKey features of mobility matrix format:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Key features of mobility matrix format:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Matrix size: (n+1) x (n+1) where n is number of classes\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - Matrix size: (n+1) x (n+1) where n is number of classes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Diagonal: immobility (people staying in same class)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - Diagonal: immobility (people staying in same class)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Off-diagonal: mobility between classes\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - Off-diagonal: mobility between classes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Row totals: total outflow from each origin class\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - Row totals: total outflow from each origin class</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Column totals: total inflow to each destination class\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - Column totals: total inflow to each destination class</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Grand total: total population in the mobility table\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - Grand total: total population in the mobility table</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-validation">Data Validation<a class="anchor" aria-label="anchor" href="#data-validation"></a>
</h3>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check if your data is properly formatted</span></span>
<span><span class="va">validate_mobility_matrix</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span>  </span>
<span>  <span class="co"># Check row totals</span></span>
<span>  <span class="va">calculated_row_totals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">mat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">actual_row_totals</span> <span class="op">&lt;-</span> <span class="va">mat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="va">n</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># Check column totals  </span></span>
<span>  <span class="va">calculated_col_totals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">mat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">actual_col_totals</span> <span class="op">&lt;-</span> <span class="va">mat</span><span class="op">[</span><span class="va">n</span> <span class="op">+</span> <span class="fl">1</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># Check grand total</span></span>
<span>  <span class="va">calculated_grand_total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">mat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">actual_grand_total</span> <span class="op">&lt;-</span> <span class="va">mat</span><span class="op">[</span><span class="va">n</span> <span class="op">+</span> <span class="fl">1</span>, <span class="va">n</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># Additional validation checks for larger matrices</span></span>
<span>  <span class="va">validation_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    matrix_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">" x "</span><span class="op">)</span>,</span>
<span>    n_classes <span class="op">=</span> <span class="va">n</span>,</span>
<span>    row_totals_match <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">calculated_row_totals</span>, <span class="va">actual_row_totals</span><span class="op">)</span>,</span>
<span>    col_totals_match <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">calculated_col_totals</span>, <span class="va">actual_col_totals</span><span class="op">)</span>,</span>
<span>    grand_total_matches <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">calculated_grand_total</span>, <span class="va">actual_grand_total</span><span class="op">)</span>,</span>
<span>    has_negative_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">mat</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    total_population <span class="op">=</span> <span class="va">actual_grand_total</span>,</span>
<span>    sparsity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">mat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">]</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">n</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">validation_results</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Validate our 5x5 example</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Validation of 5x5 example matrix:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Validation of 5x5 example matrix:</span></span>
<span><span class="va">validation_small</span> <span class="op">&lt;-</span> <span class="fu">validate_mobility_matrix</span><span class="op">(</span><span class="va">example_structure</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">validation_small</span><span class="op">)</span></span>
<span><span class="co">#&gt; $matrix_size</span></span>
<span><span class="co">#&gt; [1] "6 x 6"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_classes</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $row_totals_match</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $col_totals_match</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $grand_total_matches</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $has_negative_values</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $total_population</span></span>
<span><span class="co">#&gt; [1] 1145</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sparsity</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span></span>
<span><span class="co"># Validate our large 30x30 synthetic data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nValidation of 30x30 synthetic mobility matrix:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Validation of 30x30 synthetic mobility matrix:</span></span>
<span><span class="va">validation_large</span> <span class="op">&lt;-</span> <span class="fu">validate_mobility_matrix</span><span class="op">(</span><span class="va">basic_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">validation_large</span><span class="op">)</span></span>
<span><span class="co">#&gt; $matrix_size</span></span>
<span><span class="co">#&gt; [1] "31 x 31"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_classes</span></span>
<span><span class="co">#&gt; [1] 30</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $row_totals_match</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $col_totals_match</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $grand_total_matches</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $has_negative_values</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $total_population</span></span>
<span><span class="co">#&gt; [1] 50000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sparsity</span></span>
<span><span class="co">#&gt; [1] 7.9</span></span>
<span></span>
<span><span class="co"># Show validation function usage for user data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nTo validate your own data:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To validate your own data:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"validation_results &lt;- validate_mobility_matrix(your_matrix)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; validation_results &lt;- validate_mobility_matrix(your_matrix)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"print(validation_results)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; print(validation_results)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="best-practices-and-tips">Best Practices and Tips<a class="anchor" aria-label="anchor" href="#best-practices-and-tips"></a>
</h2>
<div class="section level3">
<h3 id="choosing-parameters">Choosing Parameters<a class="anchor" aria-label="anchor" href="#choosing-parameters"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Number of levels</strong>: Start with 3-4 levels, adjust
based on your data size</li>
<li>
<strong>Cut-off values</strong>: Default (1.0) works well for
relative risk; adjust for sensitivity</li>
<li>
<strong>Small cell reduction</strong>: Use to handle sparse data in
large matrices</li>
</ol>
</div>
<div class="section level3">
<h3 id="visualization-best-practices">Visualization Best Practices<a class="anchor" aria-label="anchor" href="#visualization-best-practices"></a>
</h3>
<div class="section level4">
<h4 id="color-palette-selection">Color Palette Selection<a class="anchor" aria-label="anchor" href="#color-palette-selection"></a>
</h4>
<p>Choose palettes based on your data type and accessibility needs:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For categorical data (segments)</span></span>
<span><span class="fu"><a href="../reference/plot_moneca_ggraph.html">plot_moneca_ggraph</a></span><span class="op">(</span><span class="va">seg</span>, color_palette <span class="op">=</span> <span class="st">"Set2"</span><span class="op">)</span>    <span class="co"># Colorblind-safe qualitative</span></span>
<span><span class="fu"><a href="../reference/plot_moneca_ggraph.html">plot_moneca_ggraph</a></span><span class="op">(</span><span class="va">seg</span>, color_palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span>   <span class="co"># High contrast qualitative</span></span>
<span></span>
<span><span class="co"># For continuous data (mobility rates)</span></span>
<span><span class="fu"><a href="../reference/plot_moneca_ggraph.html">plot_moneca_ggraph</a></span><span class="op">(</span><span class="va">seg</span>, node_color <span class="op">=</span> <span class="st">"mobility"</span>, color_palette <span class="op">=</span> <span class="st">"viridis"</span><span class="op">)</span>  <span class="co"># Perceptually uniform</span></span>
<span><span class="fu"><a href="../reference/plot_moneca_ggraph.html">plot_moneca_ggraph</a></span><span class="op">(</span><span class="va">seg</span>, node_color <span class="op">=</span> <span class="st">"mobility"</span>, color_palette <span class="op">=</span> <span class="st">"plasma"</span><span class="op">)</span>   <span class="co"># Alternative continuous</span></span>
<span></span>
<span><span class="co"># For comparing different systems</span></span>
<span><span class="fu"><a href="../reference/plot_moneca_ggraph.html">plot_moneca_ggraph</a></span><span class="op">(</span><span class="va">rigid_seg</span>, color_palette <span class="op">=</span> <span class="st">"Oranges"</span><span class="op">)</span>   <span class="co"># Sequential for one system</span></span>
<span><span class="fu"><a href="../reference/plot_moneca_ggraph.html">plot_moneca_ggraph</a></span><span class="op">(</span><span class="va">fluid_seg</span>, color_palette <span class="op">=</span> <span class="st">"Purples"</span><span class="op">)</span>   <span class="co"># Different sequential for comparison</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="layout-algorithm-selection">Layout Algorithm Selection<a class="anchor" aria-label="anchor" href="#layout-algorithm-selection"></a>
</h4>
<p>Different layouts work better for different network
characteristics:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Force-directed layouts</span></span>
<span><span class="fu"><a href="../reference/plot_moneca_ggraph.html">plot_moneca_ggraph</a></span><span class="op">(</span><span class="va">seg</span>, layout <span class="op">=</span> <span class="st">"fr"</span><span class="op">)</span>      <span class="co"># Fruchterman-Reingold (balanced)</span></span>
<span><span class="fu"><a href="../reference/plot_moneca_ggraph.html">plot_moneca_ggraph</a></span><span class="op">(</span><span class="va">seg</span>, layout <span class="op">=</span> <span class="st">"kk"</span><span class="op">)</span>      <span class="co"># Kamada-Kawai (minimize edge crossings)</span></span>
<span></span>
<span><span class="co"># Optimization-based layouts</span></span>
<span><span class="fu"><a href="../reference/plot_moneca_ggraph.html">plot_moneca_ggraph</a></span><span class="op">(</span><span class="va">seg</span>, layout <span class="op">=</span> <span class="st">"stress"</span><span class="op">)</span>  <span class="co"># Stress majorization (clean, clear)</span></span>
<span><span class="fu"><a href="../reference/plot_moneca_ggraph.html">plot_moneca_ggraph</a></span><span class="op">(</span><span class="va">seg</span>, layout <span class="op">=</span> <span class="st">"mds"</span><span class="op">)</span>     <span class="co"># Multidimensional scaling</span></span>
<span></span>
<span><span class="co"># For consistent comparisons</span></span>
<span><span class="va">consistent_layout</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/layout.matrix.html">layout.matrix</a></span><span class="op">(</span><span class="va">seg</span><span class="op">)</span>     <span class="co"># MONECA's specialized layout</span></span>
<span><span class="fu"><a href="../reference/plot_moneca_ggraph.html">plot_moneca_ggraph</a></span><span class="op">(</span><span class="va">seg</span>, layout <span class="op">=</span> <span class="va">consistent_layout</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="node-and-edge-styling">Node and Edge Styling<a class="anchor" aria-label="anchor" href="#node-and-edge-styling"></a>
</h4>
<p>Optimize visual elements for clarity and accessibility:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># High contrast for presentations</span></span>
<span><span class="fu"><a href="../reference/plot_moneca_ggraph.html">plot_moneca_ggraph</a></span><span class="op">(</span><span class="va">seg</span>,</span>
<span>  node_alpha <span class="op">=</span> <span class="fl">0.9</span>,        <span class="co"># Strong nodes</span></span>
<span>  edge_alpha <span class="op">=</span> <span class="fl">0.4</span>,        <span class="co"># Subtle edges</span></span>
<span>  edge_color <span class="op">=</span> <span class="st">"grey20"</span>,   <span class="co"># Dark edges</span></span>
<span>  label_size <span class="op">=</span> <span class="fl">4</span>           <span class="co"># Large labels</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Detailed analysis version</span></span>
<span><span class="fu"><a href="../reference/plot_moneca_ggraph.html">plot_moneca_ggraph</a></span><span class="op">(</span><span class="va">seg</span>,</span>
<span>  node_size <span class="op">=</span> <span class="st">"mobility"</span>,  <span class="co"># Size by analytical variable</span></span>
<span>  edge_width <span class="op">=</span> <span class="st">"weight"</span>,   <span class="co"># Width by connection strength</span></span>
<span>  show_segments <span class="op">=</span> <span class="cn">TRUE</span>,    <span class="co"># Show cluster boundaries</span></span>
<span>  segment_alpha <span class="op">=</span> <span class="fl">0.15</span>     <span class="co"># Subtle boundaries</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="interpretation-guidelines">Interpretation Guidelines<a class="anchor" aria-label="anchor" href="#interpretation-guidelines"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Segments represent groups</strong> with high internal
mobility</li>
<li>
<strong>Hierarchical structure</strong> shows nested clustering at
different scales<br>
</li>
<li>
<strong>Edge weights</strong> indicate relative risk compared to
independence</li>
<li>
<strong>Layout algorithms</strong> can emphasize different network
properties</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="advanced-features">Advanced Features<a class="anchor" aria-label="anchor" href="#advanced-features"></a>
</h2>
<div class="section level3">
<h3 id="fast-implementation-with-moneca_fast">Fast Implementation with moneca_fast()<a class="anchor" aria-label="anchor" href="#fast-implementation-with-moneca_fast"></a>
</h3>
<p>For large datasets or when computational speed is important, moneca
provides a fast implementation that produces identical results to the
standard algorithm:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Standard implementation</span></span>
<span><span class="va">seg_standard</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca.html">moneca</a></span><span class="op">(</span><span class="va">basic_data</span>, segment.levels <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fast implementation (identical results)</span></span>
<span><span class="va">seg_fast</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca_fast.html">moneca_fast</a></span><span class="op">(</span><span class="va">basic_data</span>, segment.levels <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Both produce the same clustering</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">seg_standard</span><span class="op">$</span><span class="va">segment.list</span>, <span class="va">seg_fast</span><span class="op">$</span><span class="va">segment.list</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="../reference/moneca_fast.html">moneca_fast()</a></code> function uses optimized algorithms
while maintaining full compatibility with all visualization and analysis
functions.</p>
</div>
<div class="section level3">
<h3 id="auto-tuning-automatic-parameter-optimization">Auto-Tuning: Automatic Parameter Optimization<a class="anchor" aria-label="anchor" href="#auto-tuning-automatic-parameter-optimization"></a>
</h3>
<p>The package includes auto-tuning capabilities to automatically
optimize the <code>small.cell.reduction</code> parameter:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Auto-tune using stability method (recommended)</span></span>
<span><span class="va">seg_tuned</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca.html">moneca</a></span><span class="op">(</span></span>
<span>  <span class="va">basic_data</span>,</span>
<span>  segment.levels <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  auto_tune <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the selected parameter</span></span>
<span><span class="va">auto_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">seg_tuned</span>, <span class="st">"auto_tune_result"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Optimal parameter:"</span>, <span class="va">auto_result</span><span class="op">$</span><span class="va">best_parameter</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<p>For most applications, the default auto-tuning settings work well.
Advanced users can explore different tuning methods through the
<code><a href="../reference/auto_tune_small_cell_reduction.html">auto_tune_small_cell_reduction()</a></code> function.</p>
</div>
<div class="section level3">
<h3 id="performance-considerations">Performance Considerations<a class="anchor" aria-label="anchor" href="#performance-considerations"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Large matrices</strong> (&gt;50x50) may require increased
computation time</li>
<li>
<strong>Use moneca_fast()</strong> for improved performance on large
datasets</li>
<li>
<strong>Memory usage</strong> grows with number of levels and matrix
size</li>
<li>
<strong>Auto-tuning adds overhead</strong>: Consider using manual
parameters if speed is critical</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>MONECA provides a powerful framework for analyzing social mobility
through network-based clustering. The combination of:</p>
<ul>
<li>Flexible clustering algorithms</li>
<li>Modern visualization capabilities<br>
</li>
<li>Hierarchical segmentation</li>
<li>Quality assessment tools</li>
</ul>
<p>Makes it suitable for exploring mobility patterns in diverse social
contexts.</p>
<div class="section level3">
<h3 id="further-reading">Further Reading<a class="anchor" aria-label="anchor" href="#further-reading"></a>
</h3>
<ul>
<li>Original MONECA methodology papers</li>
<li>Network analysis in social mobility research</li>
<li>Graph-theoretic approaches to social structure</li>
</ul>
</div>
<div class="section level3">
<h3 id="getting-help">Getting Help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h3>
<ul>
<li>Use <code>?function_name</code> for detailed function
documentation</li>
<li>Check the package website for updates and examples</li>
<li>Report issues on the GitHub repository</li>
</ul>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Session information for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.2 (2025-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices datasets  utils     methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] moneca_1.1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] viridis_0.6.5      sass_0.4.10        generics_0.1.4     tidyr_1.3.2       </span></span>
<span><span class="co">#&gt;  [5] renv_1.1.4         digest_0.6.39      magrittr_2.0.4     evaluate_1.0.5    </span></span>
<span><span class="co">#&gt;  [9] grid_4.5.2         RColorBrewer_1.1-3 fastmap_1.2.0      jsonlite_2.0.0    </span></span>
<span><span class="co">#&gt; [13] toOrdinal_1.4-0.0  ggrepel_0.9.6      gridExtra_2.3      purrr_1.2.1       </span></span>
<span><span class="co">#&gt; [17] viridisLite_0.4.3  scales_1.4.0       tweenr_2.0.3       textshaping_1.0.4 </span></span>
<span><span class="co">#&gt; [21] jquerylib_0.1.4    cli_3.6.5          crayon_1.5.3       rlang_1.1.7       </span></span>
<span><span class="co">#&gt; [25] graphlayouts_1.2.2 polyclip_1.10-7    tidygraph_1.3.1    withr_3.0.2       </span></span>
<span><span class="co">#&gt; [29] cachem_1.1.0       yaml_2.3.12        tools_4.5.2        memoise_2.0.1     </span></span>
<span><span class="co">#&gt; [33] dplyr_1.2.0        ggplot2_4.0.2      vctrs_0.7.1        R6_2.6.1          </span></span>
<span><span class="co">#&gt; [37] lifecycle_1.0.5    fs_1.6.6           MASS_7.3-65        ragg_1.5.0        </span></span>
<span><span class="co">#&gt; [41] ggraph_2.2.2       pkgconfig_2.0.3    desc_1.4.3         pkgdown_2.2.0     </span></span>
<span><span class="co">#&gt; [45] pillar_1.11.1      bslib_0.10.0       gtable_0.3.6       glue_1.8.0        </span></span>
<span><span class="co">#&gt; [49] Rcpp_1.1.1         ggforce_0.5.0      systemfonts_1.3.1  xfun_0.56         </span></span>
<span><span class="co">#&gt; [53] tibble_3.3.1       tidyselect_1.2.1   knitr_1.51         farver_2.1.2      </span></span>
<span><span class="co">#&gt; [57] htmltools_0.5.9    igraph_2.2.2       labeling_0.4.3     rmarkdown_2.30    </span></span>
<span><span class="co">#&gt; [61] compiler_4.5.2     S7_0.2.1</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Giampaolo Montaletti, Jonas Touboel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
