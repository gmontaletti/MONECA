<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>moneca Algorithm Comparison: moneca() vs moneca_fast() • moneca</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="moneca Algorithm Comparison: moneca() vs moneca_fast()">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">moneca</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.8.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/moneca-introduction.html">Introduction to moneca: Mobility Network Clustering Analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="dropdown-item" href="https://gmontaletti.github.io/MONECA/news/index.html#moneca-08">Version 0.8</a></li>
    <li><a class="dropdown-item" href="https://gmontaletti.github.io/MONECA/news/index.html#moneca-07">Version 0.7</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gmontaletti/MONECA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>moneca Algorithm Comparison: moneca() vs moneca_fast()</h1>
                        <h4 data-toc-skip class="author">Giampaolo
Montaletti</h4>
            
            <h4 data-toc-skip class="date">2025-10-26</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/gmontaletti/MONECA/blob/master/vignettes/algorithm-comparison.Rmd" class="external-link"><code>vignettes/algorithm-comparison.Rmd</code></a></small>
      <div class="d-none name"><code>algorithm-comparison.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The moneca package provides two main algorithms for mobility network
clustering analysis: the original <code><a href="../reference/moneca.html">moneca()</a></code> function and the
optimized <code><a href="../reference/moneca_fast.html">moneca_fast()</a></code> function. This vignette provides a
detailed comparison of both algorithms, explaining their internal
workflows, differences, and trade-offs to help users choose the most
appropriate method for their analysis.</p>
<p>Both algorithms implement the same core MONECA methodology but with
different optimization strategies and computational approaches.
Understanding these differences is crucial for selecting the right tool
based on your data size, computational resources, and accuracy
requirements.</p>
</div>
<div class="section level2">
<h2 id="overview-of-the-moneca-methodology">Overview of the MONECA Methodology<a class="anchor" aria-label="anchor" href="#overview-of-the-moneca-methodology"></a>
</h2>
<p>Before diving into the specific implementations, it’s important to
understand the core MONECA methodology that both algorithms
implement:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Relative Risk Calculation</strong>: Convert mobility tables
to relative risk matrices</li>
<li>
<strong>Network Construction</strong>: Create weighted networks from
relative risk values</li>
<li>
<strong>Clique Detection</strong>: Identify complete subgraphs
(cliques) in the network</li>
<li>
<strong>Segmentation</strong>: Group nodes into segments based on
clique membership</li>
<li>
<strong>Aggregation</strong>: Create new mobility tables aggregated
by segments</li>
<li>
<strong>Iteration</strong>: Repeat the process for multiple
hierarchical levels</li>
</ol>
<p>The key differences between <code><a href="../reference/moneca.html">moneca()</a></code> and
<code><a href="../reference/moneca_fast.html">moneca_fast()</a></code> lie in how they implement steps 3 (clique
detection) and 4 (segmentation).</p>
</div>
<div class="section level2">
<h2 id="the-original-moneca-algorithm">The Original moneca() Algorithm<a class="anchor" aria-label="anchor" href="#the-original-moneca-algorithm"></a>
</h2>
<div class="section level3">
<h3 id="workflow-overview">Workflow Overview<a class="anchor" aria-label="anchor" href="#workflow-overview"></a>
</h3>
<p>The original <code><a href="../reference/moneca.html">moneca()</a></code> function implements a
conservative, thorough approach that prioritizes accuracy and
reproducibility. Here’s the detailed workflow:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the package and create sample data with larger dimensions</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gmontaletti.github.io/MONECA/">moneca</a></span><span class="op">)</span></span>
<span><span class="va">mobility_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_mobility_data.html">generate_mobility_data</a></span><span class="op">(</span></span>
<span>  n_classes <span class="op">=</span> <span class="fl">30</span>, </span>
<span>  n_total <span class="op">=</span> <span class="fl">45000</span>,</span>
<span>  class_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Class"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%02d"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run the original algorithm</span></span>
<span><span class="va">result_original</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca.html">moneca</a></span><span class="op">(</span><span class="va">mobility_data</span>, segment.levels <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-by-step-workflow">Step-by-Step Workflow<a class="anchor" aria-label="anchor" href="#step-by-step-workflow"></a>
</h3>
<div class="section level4">
<h4 id="step-1-input-validation-and-preprocessing">Step 1: Input Validation and Preprocessing<a class="anchor" aria-label="anchor" href="#step-1-input-validation-and-preprocessing"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The function begins with input validation for 30x30 matrix</span></span>
<span><span class="va">mx</span> <span class="op">&lt;-</span> <span class="va">mobility_data</span>  <span class="co"># Input mobility table (30x30 + totals = 31x31)</span></span>
<span><span class="va">segment.levels</span> <span class="op">&lt;-</span> <span class="fl">3</span>  <span class="co"># Number of hierarchical levels</span></span>
<span><span class="va">cut.off</span> <span class="op">&lt;-</span> <span class="fl">1</span>         <span class="co"># Minimum relative risk threshold</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Processing matrix dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">mx</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Total population:"</span>, <span class="va">mx</span><span class="op">[</span><span class="fl">31</span>, <span class="fl">31</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<p>The algorithm expects a square mobility table with row and column
totals in the last row and column.</p>
</div>
<div class="section level4">
<h4 id="step-2-relative-risk-matrix-calculation">Step 2: Relative Risk Matrix Calculation<a class="anchor" aria-label="anchor" href="#step-2-relative-risk-matrix-calculation"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Internal function: weight.matrix() for 30x30 system</span></span>
<span><span class="co"># Calculates observed/expected ratios for each cell</span></span>
<span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mx</span><span class="op">)</span>  <span class="co"># 31 for 30-class system</span></span>
<span><span class="va">o.r.s</span> <span class="op">&lt;-</span> <span class="va">mx</span><span class="op">[</span><span class="op">-</span><span class="va">l</span>, <span class="va">l</span><span class="op">]</span>        <span class="co"># Origin totals (30 values)</span></span>
<span><span class="va">o.c.s</span> <span class="op">&lt;-</span> <span class="va">mx</span><span class="op">[</span><span class="va">l</span>, <span class="op">-</span><span class="va">l</span><span class="op">]</span>        <span class="co"># Destination totals (30 values)</span></span>
<span><span class="va">total.total</span> <span class="op">&lt;-</span> <span class="va">mx</span><span class="op">[</span><span class="va">l</span>,<span class="va">l</span><span class="op">]</span>    <span class="co"># Grand total</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Weight matrix calculation:\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Origin totals range:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">o.r.s</span><span class="op">)</span>, <span class="st">"-"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">o.r.s</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Destination totals range:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">o.c.s</span><span class="op">)</span>, <span class="st">"-"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">o.c.s</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Grand total:"</span>, <span class="va">total.total</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Expected values under independence</span></span>
<span><span class="va">row.share</span> <span class="op">&lt;-</span> <span class="va">o.r.s</span><span class="op">/</span><span class="va">total.total</span></span>
<span><span class="va">col.share</span> <span class="op">&lt;-</span> <span class="va">o.c.s</span><span class="op">/</span><span class="va">total.total</span></span>
<span><span class="va">total.mobility</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">mx</span><span class="op">[</span><span class="op">-</span><span class="va">l</span>,<span class="op">-</span><span class="va">l</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">mx.1_exp</span> <span class="op">&lt;-</span> <span class="va">row.share</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">col.share</span><span class="op">)</span> <span class="op">*</span> <span class="va">total.mobility</span></span>
<span></span>
<span><span class="co"># Relative risks (30x30 matrix)</span></span>
<span><span class="va">mx.1_net</span> <span class="op">&lt;-</span> <span class="va">mx</span><span class="op">[</span><span class="op">-</span><span class="va">l</span>,<span class="op">-</span><span class="va">l</span><span class="op">]</span> <span class="op">/</span> <span class="va">mx.1_exp</span></span>
<span><span class="va">mx.1i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">mx.1_net</span><span class="op">)</span></span>
<span><span class="va">mx.1i</span><span class="op">[</span><span class="va">mx.1i</span> <span class="op">&lt;</span> <span class="va">cut.off</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span>  <span class="co"># Apply threshold</span></span>
<span><span class="va">mx.1i</span> <span class="op">&lt;-</span> <span class="va">mx.1i</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mx.1i</span><span class="op">)</span>     <span class="co"># Make symmetric</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">mx.1i</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NA</span>             <span class="co"># Remove diagonal</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Significant edges (RR &gt; 1):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">mx.1i</span><span class="op">)</span><span class="op">)</span>, <span class="st">"out of"</span>, <span class="fl">30</span><span class="op">*</span><span class="fl">29</span>, <span class="st">"possible\n"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="step-3-network-construction">Step 3: Network Construction<a class="anchor" aria-label="anchor" href="#step-3-network-construction"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert to adjacency matrix for graph creation</span></span>
<span><span class="va">mx.1i.graph</span> <span class="op">&lt;-</span> <span class="va">mx.1i</span></span>
<span><span class="va">mx.1i.graph</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">mx.1i.graph</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Create undirected, weighted graph</span></span>
<span><span class="va">gra.1ii</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca_graph_from_adjacency.html">moneca_graph_from_adjacency</a></span><span class="op">(</span></span>
<span>  adjmatrix <span class="op">=</span> <span class="va">mx.1i.graph</span>, </span>
<span>  mode <span class="op">=</span> <span class="st">"undirected"</span>, </span>
<span>  weighted <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>  diag <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="step-4-clique-detection">Step 4: Clique Detection<a class="anchor" aria-label="anchor" href="#step-4-clique-detection"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find ALL cliques in the 30-node network</span></span>
<span><span class="va">clique</span> <span class="op">&lt;-</span> <span class="fu">moneca_cliques</span><span class="op">(</span><span class="va">gra.1ii</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Total cliques found:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">clique</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">clique</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">clique_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">clique</span>, <span class="va">length</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Clique size distribution:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Min size:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">clique_sizes</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Max size:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">clique_sizes</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Mean size:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">clique_sizes</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Size frequency:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">clique_sizes</span><span class="op">)</span><span class="op">)</span>, <span class="st">"nodes:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">clique_sizes</span><span class="op">)</span>, <span class="st">"cliques"</span>, collapse <span class="op">=</span> <span class="st">"; "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><strong>Key characteristic</strong>: The original algorithm finds ALL
cliques in the network, including overlapping ones. This provides
comprehensive coverage but can be computationally expensive for dense
networks.</p>
</div>
<div class="section level4">
<h4 id="step-5-edge-processing-and-segmentation">Step 5: Edge Processing and Segmentation<a class="anchor" aria-label="anchor" href="#step-5-edge-processing-and-segmentation"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The find.segments() function processes edges in order of strength</span></span>
<span><span class="co"># Extract edges and sort by weight (strongest first)</span></span>
<span><span class="va">edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">mat</span> <span class="op">&gt;</span> <span class="va">cut.off</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">edge_weights</span> <span class="op">&lt;-</span> <span class="va">mat</span><span class="op">[</span><span class="va">edges</span><span class="op">]</span></span>
<span><span class="va">edge_order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">edge_weights</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">edges</span> <span class="op">&lt;-</span> <span class="va">edges</span><span class="op">[</span><span class="va">edge_order</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Initialize group assignments</span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"numeric"</span>, length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Process each edge in order of decreasing strength</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">edges</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">edge</span> <span class="op">&lt;-</span> <span class="va">edges</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span></span>
<span>  <span class="va">current_groups</span> <span class="op">&lt;-</span> <span class="va">group</span><span class="op">[</span><span class="va">edge</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># Determine group assignment based on existing memberships</span></span>
<span>  <span class="co"># and clique constraints</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">current_groups</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Both nodes unassigned: create new group</span></span>
<span>    <span class="va">group</span><span class="op">[</span><span class="va">edge</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">i</span>  </span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="co"># At least one node assigned: test clique membership</span></span>
<span>    <span class="va">group.candidates</span> <span class="op">&lt;-</span> <span class="va">current_groups</span><span class="op">[</span><span class="va">current_groups</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">]</span> </span>
<span>    <span class="va">group.members</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">group</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">group.candidates</span><span class="op">)</span></span>
<span>    <span class="va">potential.clique</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">group.members</span>, <span class="va">edge</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Test if potential group forms a valid clique</span></span>
<span>    <span class="va">test</span> <span class="op">&lt;-</span> <span class="fu">clique.test</span><span class="op">(</span><span class="va">cliques</span>, <span class="va">potential.clique</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">test</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">group</span><span class="op">[</span><span class="va">potential.clique</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">group.assigned</span>             </span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><strong>Key characteristics</strong>: - <strong>Sequential
processing</strong>: Edges are processed one by one in order of strength
- <strong>Clique validation</strong>: Every potential group is tested
against all known cliques - <strong>Conservative grouping</strong>:
Groups are only formed if they satisfy clique constraints</p>
</div>
<div class="section level4">
<h4 id="step-6-matrix-aggregation">Step 6: Matrix Aggregation<a class="anchor" aria-label="anchor" href="#step-6-matrix-aggregation"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Aggregate the original mobility table by the identified segments</span></span>
<span><span class="va">groups.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">segments</span><span class="op">$</span><span class="va">membership</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">segments</span><span class="op">$</span><span class="va">membership</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">mx.2_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rowsum.html" class="external-link">rowsum</a></span><span class="op">(</span><span class="va">mx</span>, <span class="va">groups.1</span><span class="op">)</span></span>
<span><span class="va">mx.2_r_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mx.2_r</span><span class="op">)</span></span>
<span><span class="va">mx.2_rc_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rowsum.html" class="external-link">rowsum</a></span><span class="op">(</span><span class="va">mx.2_r_t</span>, <span class="va">groups.1</span><span class="op">)</span></span>
<span><span class="va">mx.2g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mx.2_rc_t</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="step-7-hierarchical-iteration">Step 7: Hierarchical Iteration<a class="anchor" aria-label="anchor" href="#step-7-hierarchical-iteration"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Repeat the process for the aggregated matrix</span></span>
<span><span class="co"># Continue until segment.levels is reached or no further segmentation possible</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">segment.levels</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">segments</span> <span class="op">&lt;-</span> <span class="fu">make.segments</span><span class="op">(</span><span class="va">mx.2g</span>, <span class="va">cut.off</span>, <span class="va">mode</span>, <span class="va">delete.upper.tri</span>, <span class="va">small.cell.reduction</span><span class="op">)</span></span>
<span>  <span class="va">mx.2g</span> <span class="op">&lt;-</span> <span class="fu">segment.matrix</span><span class="op">(</span><span class="va">mx.2g</span>, <span class="va">segments</span><span class="op">)</span></span>
<span>  <span class="co"># ... store results for level i</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="advantages-of-moneca">Advantages of moneca()<a class="anchor" aria-label="anchor" href="#advantages-of-moneca"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Accuracy</strong>: Finds all cliques, ensuring no potential
segments are missed</li>
<li>
<strong>Deterministic</strong>: Results are completely
reproducible</li>
<li>
<strong>Thorough</strong>: Conservative approach minimizes false
segmentation</li>
<li>
<strong>Well-tested</strong>: Extensively validated algorithm with
proven track record</li>
<li>
<strong>Comprehensive</strong>: Handles edge cases and complex
network structures reliably</li>
</ol>
</div>
<div class="section level3">
<h3 id="disadvantages-of-moneca">Disadvantages of moneca()<a class="anchor" aria-label="anchor" href="#disadvantages-of-moneca"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Computational complexity</strong>: O(3^n) in worst case for
clique enumeration</li>
<li>
<strong>Memory intensive</strong>: Stores all cliques in memory</li>
<li>
<strong>Slow for large networks</strong>: Performance degrades
significantly with network size</li>
<li>
<strong>No early stopping</strong>: Processes all edges even when
further segmentation is unlikely</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="the-optimized-moneca_fast-algorithm">The Optimized moneca_fast() Algorithm<a class="anchor" aria-label="anchor" href="#the-optimized-moneca_fast-algorithm"></a>
</h2>
<div class="section level3">
<h3 id="workflow-overview-1">Workflow Overview<a class="anchor" aria-label="anchor" href="#workflow-overview-1"></a>
</h3>
<p>The <code><a href="../reference/moneca_fast.html">moneca_fast()</a></code> function implements several
optimization strategies while maintaining the core MONECA methodology.
It prioritizes computational efficiency while preserving algorithmic
accuracy for most practical use cases.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run the optimized algorithm on 30x30 data</span></span>
<span><span class="va">result_fast</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca_fast.html">moneca_fast</a></span><span class="op">(</span></span>
<span>  <span class="va">mobility_data</span>, </span>
<span>  segment.levels <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  use.sparse <span class="op">=</span> <span class="cn">FALSE</span>,        <span class="co"># Optional sparse matrix support</span></span>
<span>  min.density <span class="op">=</span> <span class="fl">0.01</span>,        <span class="co"># Early stopping threshold</span></span>
<span>  max.clique.size <span class="op">=</span> <span class="fl">8</span>,       <span class="co"># Limit clique size for 30-node network</span></span>
<span>  progress <span class="op">=</span> <span class="cn">TRUE</span>            <span class="co"># Progress monitoring</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Fast algorithm completed for 30x30 matrix\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Levels processed:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">result_fast</span><span class="op">$</span><span class="va">segment.list</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-by-step-workflow-1">Step-by-Step Workflow<a class="anchor" aria-label="anchor" href="#step-by-step-workflow-1"></a>
</h3>
<div class="section level4">
<h4 id="step-1-enhanced-input-validation-and-configuration">Step 1: Enhanced Input Validation and Configuration<a class="anchor" aria-label="anchor" href="#step-1-enhanced-input-validation-and-configuration"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Additional parameters for optimization (tuned for 30x30 system)</span></span>
<span><span class="va">use.sparse</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span>           <span class="co"># Sparse matrix support</span></span>
<span><span class="va">min.density</span> <span class="op">&lt;-</span> <span class="fl">0.01</span>          <span class="co"># Minimum edge density for continuation</span></span>
<span><span class="va">max.clique.size</span> <span class="op">&lt;-</span> <span class="fl">10</span>        <span class="co"># Limit for computational efficiency with 30 nodes</span></span>
<span><span class="va">progress</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span>             <span class="co"># Progress bar display</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Optimization parameters for 30-class system:\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Sparse matrices:"</span>, <span class="va">use.sparse</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Min density threshold:"</span>, <span class="va">min.density</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Max clique size limit:"</span>, <span class="va">max.clique.size</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="step-2-optimized-relative-risk-calculation">Step 2: Optimized Relative Risk Calculation<a class="anchor" aria-label="anchor" href="#step-2-optimized-relative-risk-calculation"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fast weight matrix calculation with vectorized operations</span></span>
<span><span class="va">weight.matrix.fast</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mx</span>, <span class="va">cut.off</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">symmetric</span> <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                               <span class="va">diagonal</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">small.cell.reduction</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mx</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Vectorized operations for better performance</span></span>
<span>  <span class="va">o.r.s</span> <span class="op">&lt;-</span> <span class="va">mx</span><span class="op">[</span><span class="op">-</span><span class="va">l</span>, <span class="va">l</span><span class="op">]</span></span>
<span>  <span class="va">o.c.s</span> <span class="op">&lt;-</span> <span class="va">mx</span><span class="op">[</span><span class="va">l</span>, <span class="op">-</span><span class="va">l</span><span class="op">]</span></span>
<span>  <span class="va">total.total</span> <span class="op">&lt;-</span> <span class="va">mx</span><span class="op">[</span><span class="va">l</span>, <span class="va">l</span><span class="op">]</span></span>
<span>  <span class="va">row.share</span> <span class="op">&lt;-</span> <span class="va">o.r.s</span> <span class="op">/</span> <span class="va">total.total</span></span>
<span>  <span class="va">col.share</span> <span class="op">&lt;-</span> <span class="va">o.c.s</span> <span class="op">/</span> <span class="va">total.total</span></span>
<span>  <span class="va">total.mobility</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">mx</span><span class="op">[</span><span class="op">-</span><span class="va">l</span>, <span class="op">-</span><span class="va">l</span><span class="op">]</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Vectorized expected calculation using outer product</span></span>
<span>  <span class="va">mx.1_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="va">row.share</span>, <span class="va">col.share</span><span class="op">)</span> <span class="op">*</span> <span class="va">total.mobility</span></span>
<span>  </span>
<span>  <span class="co"># Continue with relative risk calculation...</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><strong>Optimization</strong>: Uses vectorized operations and
<code><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer()</a></code> for more efficient matrix calculations.</p>
</div>
<div class="section level4">
<h4 id="step-3-sparse-matrix-support-optional">Step 3: Sparse Matrix Support (Optional)<a class="anchor" aria-label="anchor" href="#step-3-sparse-matrix-support-optional"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert to sparse matrix if requested and beneficial</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">use.sparse</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"Matrix"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">mx</span>, <span class="st">"sparseMatrix"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">mx</span> <span class="op">&lt;-</span> <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/Matrix.html" class="external-link">Matrix</a></span><span class="op">(</span><span class="va">mx</span>, sparse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><strong>Optimization</strong>: Optional sparse matrix support for
large, sparse datasets.</p>
</div>
<div class="section level4">
<h4 id="step-4-maximal-clique-detection">Step 4: Maximal Clique Detection<a class="anchor" aria-label="anchor" href="#step-4-maximal-clique-detection"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use MAXIMAL cliques instead of ALL cliques (critical for 30-node networks)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">max.clique.size</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">cliques</span> <span class="op">&lt;-</span> <span class="fu">moneca_max_cliques</span><span class="op">(</span><span class="va">graph</span>, min <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Finding all maximal cliques\n"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">cliques</span> <span class="op">&lt;-</span> <span class="fu">moneca_max_cliques</span><span class="op">(</span><span class="va">graph</span>, min <span class="op">=</span> <span class="fl">2</span>, max <span class="op">=</span> <span class="va">max.clique.size</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Finding maximal cliques with size limit:"</span>, <span class="va">max.clique.size</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Maximal cliques found:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cliques</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cliques</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">max_clique_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">cliques</span>, <span class="va">length</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Maximal clique sizes - Min:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">max_clique_sizes</span><span class="op">)</span>, </span>
<span>      <span class="st">"Max:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">max_clique_sizes</span><span class="op">)</span>, </span>
<span>      <span class="st">"Mean:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">max_clique_sizes</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><strong>Key optimization</strong>: Uses maximal cliques instead of
all cliques. Maximal cliques are cliques that cannot be extended by
adding another vertex, which significantly reduces the number of cliques
to consider while maintaining algorithmic soundness.</p>
</div>
<div class="section level4">
<h4 id="step-5-early-stopping-based-on-density">Step 5: Early Stopping Based on Density<a class="anchor" aria-label="anchor" href="#step-5-early-stopping-based-on-density"></a>
</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Early stopping if graph becomes too sparse</span></span>
<span><span class="va">density</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/edge_density.html" class="external-link">edge_density</a></span><span class="op">(</span><span class="va">graph</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">density</span> <span class="op">&lt;</span> <span class="va">min.density</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    membership <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span>,</span>
<span>    cliques <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span>  <span class="co"># Return trivial segmentation</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><strong>Optimization</strong>: Stops processing when network density
falls below threshold, indicating limited potential for meaningful
segmentation.</p>
</div>
<div class="section level4">
<h4 id="step-6-vectorized-edge-processing">Step 6: Vectorized Edge Processing<a class="anchor" aria-label="anchor" href="#step-6-vectorized-edge-processing"></a>
</h4>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Vectorized edge extraction and sorting</span></span>
<span><span class="va">edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">mat</span> <span class="op">&gt;</span> <span class="va">cut.off</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">edge_weights</span> <span class="op">&lt;-</span> <span class="va">mat</span><span class="op">[</span><span class="va">edges</span><span class="op">]</span></span>
<span><span class="va">edge_order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">edge_weights</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">edges</span> <span class="op">&lt;-</span> <span class="va">edges</span><span class="op">[</span><span class="va">edge_order</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Pre-compute clique membership matrix for fast testing</span></span>
<span><span class="va">clique_membership</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">FALSE</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cliques</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">cliques</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">clique_membership</span><span class="op">[</span><span class="va">i</span>, <span class="va">cliques</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><strong>Optimization</strong>: Pre-computes clique membership matrix
for O(1) clique testing instead of repeated searches.</p>
</div>
<div class="section level4">
<h4 id="step-7-optimized-segmentation-algorithm">Step 7: Optimized Segmentation Algorithm<a class="anchor" aria-label="anchor" href="#step-7-optimized-segmentation-algorithm"></a>
</h4>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fast clique test using pre-computed membership</span></span>
<span><span class="va">is_clique</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">clique_membership</span><span class="op">[</span>, <span class="va">potential_clique</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">all</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">is_clique</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Merge groups - use the smallest group number</span></span>
<span>  <span class="va">target_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">assigned_groups</span><span class="op">)</span></span>
<span>  <span class="va">group</span><span class="op">[</span><span class="va">potential_clique</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">target_group</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><strong>Optimization</strong>: Uses matrix operations for clique
testing instead of iterative searches.</p>
</div>
<div class="section level4">
<h4 id="step-8-optimized-level-processing">Step 8: Optimized Level Processing<a class="anchor" aria-label="anchor" href="#step-8-optimized-level-processing"></a>
</h4>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Optimized level.down function with vectorized operations</span></span>
<span><span class="va">level.down.fast</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">level.current</span>, <span class="va">level.below</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Remove isolates efficiently</span></span>
<span>  <span class="va">lengths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lengths.html" class="external-link">lengths</a></span><span class="op">(</span><span class="va">level.current</span><span class="op">)</span></span>
<span>  <span class="va">level.current</span> <span class="op">&lt;-</span> <span class="va">level.current</span><span class="op">[</span><span class="va">lengths</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">level.current</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Vectorized operation using lapply</span></span>
<span>  <span class="va">ud</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">level.current</span>, <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">level.below</span><span class="op">[</span><span class="va">d</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">ud</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><strong>Optimization</strong>: Uses vectorized operations and
<code><a href="https://rdrr.io/r/base/lengths.html" class="external-link">lengths()</a></code> for more efficient processing.</p>
</div>
</div>
<div class="section level3">
<h3 id="advantages-of-moneca_fast">Advantages of moneca_fast()<a class="anchor" aria-label="anchor" href="#advantages-of-moneca_fast"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Performance</strong>: Significantly faster, especially for
larger networks</li>
<li>
<strong>Memory efficient</strong>: Uses maximal cliques to reduce
memory footprint</li>
<li>
<strong>Early stopping</strong>: Avoids unnecessary computation when
segmentation potential is low</li>
<li>
<strong>Sparse matrix support</strong>: Handles large sparse
matrices efficiently</li>
<li>
<strong>Progress monitoring</strong>: Provides feedback for
long-running analyses</li>
<li>
<strong>Scalable</strong>: Better performance scaling with network
size</li>
</ol>
</div>
<div class="section level3">
<h3 id="disadvantages-of-moneca_fast">Disadvantages of moneca_fast()<a class="anchor" aria-label="anchor" href="#disadvantages-of-moneca_fast"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Potentially less comprehensive</strong>: Maximal cliques
might miss some valid segments</li>
<li>
<strong>Early stopping trade-offs</strong>: May terminate
segmentation prematurely in some cases</li>
<li>
<strong>Complexity</strong>: More parameters to tune (density
thresholds, clique size limits)</li>
<li>
<strong>Less tested</strong>: Newer algorithm with less extensive
validation</li>
<li>
<strong>Parameter sensitivity</strong>: Results may be more
sensitive to parameter choices</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="detailed-algorithm-comparison">Detailed Algorithm Comparison<a class="anchor" aria-label="anchor" href="#detailed-algorithm-comparison"></a>
</h2>
<div class="section level3">
<h3 id="clique-detection-strategies">Clique Detection Strategies<a class="anchor" aria-label="anchor" href="#clique-detection-strategies"></a>
</h3>
<p><strong>moneca()</strong>: Uses ALL cliques</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Finds every possible clique in the network</span></span>
<span><span class="va">cliques</span> <span class="op">&lt;-</span> <span class="fu">moneca_cliques</span><span class="op">(</span><span class="va">graph</span><span class="op">)</span></span>
<span><span class="co"># For a 6-node complete graph: finds 2^6 - 6 - 1 = 57 cliques</span></span></code></pre></div>
<p><strong>moneca_fast()</strong>: Uses MAXIMAL cliques</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Finds only maximal cliques (cannot be extended)</span></span>
<span><span class="va">cliques</span> <span class="op">&lt;-</span> <span class="fu">moneca_max_cliques</span><span class="op">(</span><span class="va">graph</span>, min <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co"># For a 6-node complete graph: finds only 1 maximal clique</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="computational-complexity">Computational Complexity<a class="anchor" aria-label="anchor" href="#computational-complexity"></a>
</h3>
<table class="table">
<colgroup>
<col width="24%">
<col width="30%">
<col width="45%">
</colgroup>
<thead><tr class="header">
<th>Aspect</th>
<th>moneca()</th>
<th>moneca_fast()</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Clique enumeration</td>
<td>O(3^n) worst case</td>
<td>O(d^3) where d is degeneracy</td>
</tr>
<tr class="even">
<td>Memory usage</td>
<td>O(2^n) for storing cliques</td>
<td>O(k) where k is number of maximal cliques</td>
</tr>
<tr class="odd">
<td>Edge processing</td>
<td>O(m × c) where c is clique count</td>
<td>O(m × log(c)) with pre-computed lookup</td>
</tr>
<tr class="even">
<td>Overall complexity</td>
<td>Exponential in worst case</td>
<td>Polynomial in most practical cases</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="performance-characteristics">Performance Characteristics<a class="anchor" aria-label="anchor" href="#performance-characteristics"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Benchmarking example (not run in vignette)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshuaulrich/microbenchmark/" class="external-link">microbenchmark</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Small network (6 nodes)</span></span>
<span><span class="va">small_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_mobility_data.html">generate_mobility_data</a></span><span class="op">(</span>n_classes <span class="op">=</span> <span class="fl">6</span>, seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span></span>
<span>  original <span class="op">=</span> <span class="fu"><a href="../reference/moneca.html">moneca</a></span><span class="op">(</span><span class="va">small_data</span>, segment.levels <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  fast <span class="op">=</span> <span class="fu"><a href="../reference/moneca_fast.html">moneca_fast</a></span><span class="op">(</span><span class="va">small_data</span>, segment.levels <span class="op">=</span> <span class="fl">2</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  times <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Medium network (12 nodes)</span></span>
<span><span class="va">medium_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_mobility_data.html">generate_mobility_data</a></span><span class="op">(</span>n_classes <span class="op">=</span> <span class="fl">12</span>, seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span></span>
<span>  original <span class="op">=</span> <span class="fu"><a href="../reference/moneca.html">moneca</a></span><span class="op">(</span><span class="va">medium_data</span>, segment.levels <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  fast <span class="op">=</span> <span class="fu"><a href="../reference/moneca_fast.html">moneca_fast</a></span><span class="op">(</span><span class="va">medium_data</span>, segment.levels <span class="op">=</span> <span class="fl">2</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  times <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Expected performance differences: - <strong>Small networks (&lt; 10
nodes)</strong>: Minimal difference, sometimes original is faster due to
lower overhead - <strong>Medium networks (10-20 nodes)</strong>: Fast
version typically 2-5x faster - <strong>Large networks (&gt; 20
nodes)</strong>: Fast version can be 10-100x faster or more</p>
</div>
</div>
<div class="section level2">
<h2 id="practical-examples">Practical Examples<a class="anchor" aria-label="anchor" href="#practical-examples"></a>
</h2>
<div class="section level3">
<h3 id="example-1-small-dataset-comparison">Example 1: Small Dataset Comparison<a class="anchor" aria-label="anchor" href="#example-1-small-dataset-comparison"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gmontaletti.github.io/MONECA/">moneca</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate a medium-sized mobility dataset (30 classes) for meaningful comparison</span></span>
<span><span class="va">medium_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_mobility_data.html">generate_mobility_data</a></span><span class="op">(</span></span>
<span>  n_classes <span class="op">=</span> <span class="fl">30</span>, </span>
<span>  n_total <span class="op">=</span> <span class="fl">40000</span>,</span>
<span>  immobility_strength <span class="op">=</span> <span class="fl">0.8</span>, </span>
<span>  class_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Class"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%02d"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Generated 30x30 mobility matrix\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Generated 30x30 mobility matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">medium_data</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dimensions: 31 31</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Total population:"</span>, <span class="va">medium_data</span><span class="op">[</span><span class="fl">31</span>, <span class="fl">31</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Total population: 40000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Overall mobility rate:"</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">medium_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">medium_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Overall mobility rate: 39.5 %</span></span>
<span></span>
<span><span class="co"># Show representative portion of the matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"First 6x6 corner with totals:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; First 6x6 corner with totals:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">medium_data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">31</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">31</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;          Class 01 Class 02 Class 03 Class 04 Class 05 Class 06 Total</span></span>
<span><span class="co">#&gt; Class 01     1834      370      167        8       11       10  2589</span></span>
<span><span class="co">#&gt; Class 02       75      392       91       33        2        4   626</span></span>
<span><span class="co">#&gt; Class 03       81      127      633      118       66        3  1099</span></span>
<span><span class="co">#&gt; Class 04        2       21       31      184       47       17   318</span></span>
<span><span class="co">#&gt; Class 05        0        4       59      124      564      112   968</span></span>
<span><span class="co">#&gt; Class 06        3        2        0       25       62      350   566</span></span>
<span><span class="co">#&gt; Total        2082     1009     1049      581     1014     1068 40000</span></span>
<span></span>
<span><span class="co"># Run both algorithms</span></span>
<span><span class="va">result_original</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca.html">moneca</a></span><span class="op">(</span><span class="va">medium_data</span>, segment.levels <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  11%  |                                                                              |=========                                                             |  12%  |                                                                              |==========                                                            |  14%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  18%  |                                                                              |==============                                                        |  19%  |                                                                              |===============                                                       |  21%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  25%</span></span>
<span><span class="co">#&gt; 26% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |==================                                                    |  26%  |                                                                              |====================                                                  |  28%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |=========================                                             |  35%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  42%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  49%</span></span>
<span><span class="co">#&gt; 50% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |====================================                                  |  51%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |=======================================                               |  56%  |                                                                              |=========================================                             |  58%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  65%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  72%  |                                                                              |====================================================                  |  74%  |                                                                              |=====================================================                 |  75%</span></span>
<span><span class="co">#&gt; 76% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  81%  |                                                                              |==========================================================            |  82%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  88%  |                                                                              |===============================================================       |  89%  |                                                                              |================================================================      |  91%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  95%  |                                                                              |====================================================================  |  96%  |                                                                              |===================================================================== |  98%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; 100% ready!</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%</span></span>
<span><span class="co">#&gt; 27% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%</span></span>
<span><span class="co">#&gt; 55% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%</span></span>
<span><span class="co">#&gt; 82% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; 100% ready!</span></span>
<span><span class="va">result_fast</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca_fast.html">moneca_fast</a></span><span class="op">(</span><span class="va">medium_data</span>, segment.levels <span class="op">=</span> <span class="fl">2</span>, max.clique.size <span class="op">=</span> <span class="fl">8</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nOriginal algorithm - Level 2 segmentation:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Original algorithm - Level 2 segmentation:</span></span>
<span><span class="va">original_segments</span> <span class="op">&lt;-</span> <span class="va">result_original</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Number of segments:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">original_segments</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of segments: 10</span></span>
<span><span class="va">segment_sizes_orig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">original_segments</span>, <span class="va">length</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Segment sizes:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">segment_sizes_orig</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Segment sizes: 3, 3, 3, 3, 3, 3, 3, 3, 2, 2</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nFast algorithm - Level 2 segmentation:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fast algorithm - Level 2 segmentation:</span></span>
<span><span class="va">fast_segments</span> <span class="op">&lt;-</span> <span class="va">result_fast</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Number of segments:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fast_segments</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of segments: 10</span></span>
<span><span class="va">segment_sizes_fast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">fast_segments</span>, <span class="va">length</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Segment sizes:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">segment_sizes_fast</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Segment sizes: 3, 3, 3, 3, 3, 3, 3, 3, 2, 2</span></span>
<span></span>
<span><span class="co"># Check if results are identical</span></span>
<span><span class="va">identical_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">result_original</span><span class="op">$</span><span class="va">segment.list</span>, <span class="va">result_fast</span><span class="op">$</span><span class="va">segment.list</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nResults identical:"</span>, <span class="va">identical_results</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Results identical: FALSE</span></span>
<span></span>
<span><span class="co"># If not identical, show differences</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="va">identical_results</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nAlgorithm comparison summary:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Original - Segments:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">original_segments</span><span class="op">)</span>, <span class="st">", Avg size:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">segment_sizes_orig</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Fast - Segments:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fast_segments</span><span class="op">)</span>, <span class="st">", Avg size:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">segment_sizes_fast</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Algorithm comparison summary:</span></span>
<span><span class="co">#&gt; Original - Segments: 10 , Avg size: 2.8 </span></span>
<span><span class="co">#&gt; Fast - Segments: 10 , Avg size: 2.8</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-2-performance-comparison">Example 2: Performance Comparison<a class="anchor" aria-label="anchor" href="#example-2-performance-comparison"></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate large dataset for meaningful performance comparison (30 classes)</span></span>
<span><span class="va">large_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_mobility_data.html">generate_mobility_data</a></span><span class="op">(</span></span>
<span>  n_classes <span class="op">=</span> <span class="fl">30</span>, </span>
<span>  n_total <span class="op">=</span> <span class="fl">50000</span>,</span>
<span>  class_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Class"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%02d"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Performance test with 30x30 mobility matrix\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Performance test with 30x30 mobility matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Matrix dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">large_data</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Matrix dimensions: 31 31</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Population:"</span>, <span class="va">large_data</span><span class="op">[</span><span class="fl">31</span>, <span class="fl">31</span><span class="op">]</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Population: 50000</span></span>
<span></span>
<span><span class="co"># Time both algorithms</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Timing original algorithm...\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Timing original algorithm...</span></span>
<span><span class="va">time_original</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">result_orig</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca.html">moneca</a></span><span class="op">(</span><span class="va">large_data</span>, segment.levels <span class="op">=</span> <span class="fl">2</span>, small.cell.reduction <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  11%  |                                                                              |=========                                                             |  12%  |                                                                              |==========                                                            |  14%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  18%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |================                                                      |  23%</span></span>
<span><span class="co">#&gt; 25% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |==================                                                    |  25%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  32%  |                                                                              |========================                                              |  34%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  38%  |                                                                              |============================                                          |  39%  |                                                                              |=============================                                         |  41%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  48%  |                                                                              |===================================                                   |  50%</span></span>
<span><span class="co">#&gt; 51% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |====================================                                  |  52%  |                                                                              |======================================                                |  54%  |                                                                              |=======================================                               |  55%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  61%  |                                                                              |============================================                          |  62%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  66%  |                                                                              |================================================                      |  68%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  75%</span></span>
<span><span class="co">#&gt; 75% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |==========================================================            |  82%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |================================================================      |  91%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  95%  |                                                                              |====================================================================  |  96%  |                                                                              |===================================================================== |  98%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; 100% ready!</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |========                                                              |  11%  |                                                                              |================                                                      |  22%</span></span>
<span><span class="co">#&gt; 30% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |=======================                                               |  33%  |                                                                              |===============================                                       |  44%</span></span>
<span><span class="co">#&gt; 50% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |=======================================                               |  56%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================                |  78%</span></span>
<span><span class="co">#&gt; 80% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |==============================================================        |  89%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; 100% ready!</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Timing fast algorithm...\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Timing fast algorithm...</span></span>
<span><span class="va">time_fast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">result_fast</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca_fast.html">moneca_fast</a></span><span class="op">(</span></span>
<span>    <span class="va">large_data</span>, </span>
<span>    segment.levels <span class="op">=</span> <span class="fl">2</span>, </span>
<span>    max.clique.size <span class="op">=</span> <span class="fl">8</span>,</span>
<span>    progress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nPerformance Results:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Performance Results:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Original algorithm time:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">time_original</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"seconds\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Original algorithm time: 0.42 seconds</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Fast algorithm time:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">time_fast</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"seconds\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fast algorithm time: 0.37 seconds</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="va">time_fast</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">speedup</span> <span class="op">&lt;-</span> <span class="va">time_original</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span> <span class="op">/</span> <span class="va">time_fast</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Speedup factor:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">speedup</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"x\n"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Fast algorithm completed in &lt; 0.01 seconds\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Speedup factor: 1.13 x</span></span>
<span></span>
<span><span class="co"># Compare segmentation quality</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nSegmentation quality comparison:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Segmentation quality comparison:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Original - Segments:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">result_orig</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Original - Segments: 9</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Fast - Segments:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">result_fast</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fast - Segments: 9</span></span>
<span></span>
<span><span class="co"># Check memory usage approximation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nApproximate object sizes:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Approximate object sizes:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Original result:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/object.size.html" class="external-link">object.size</a></span><span class="op">(</span><span class="va">result_orig</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1024</span><span class="op">^</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"MB\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Original result: 0.02 MB</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Fast result:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/object.size.html" class="external-link">object.size</a></span><span class="op">(</span><span class="va">result_fast</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1024</span><span class="op">^</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"MB\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fast result: 0.02 MB</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-3-different-segmentation-outcomes">Example 3: Different Segmentation Outcomes<a class="anchor" aria-label="anchor" href="#example-3-different-segmentation-outcomes"></a>
</h3>
<p>Sometimes the algorithms may produce different results due to their
different clique detection strategies:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a complex 30-class dataset where algorithms might differ</span></span>
<span><span class="va">complex_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_mobility_data.html">generate_mobility_data</a></span><span class="op">(</span></span>
<span>  n_classes <span class="op">=</span> <span class="fl">30</span>, </span>
<span>  n_total <span class="op">=</span> <span class="fl">35000</span>,</span>
<span>  immobility_strength <span class="op">=</span> <span class="fl">0.6</span>,  <span class="co"># Lower immobility for more complex structure</span></span>
<span>  class_clustering <span class="op">=</span> <span class="fl">0.3</span>,     <span class="co"># Some clustering</span></span>
<span>  noise_level <span class="op">=</span> <span class="fl">0.1</span>,         <span class="co"># Some noise</span></span>
<span>  class_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Class"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%02d"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">789</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Complex 30-class mobility system:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Complex 30-class mobility system:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">complex_data</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dimensions: 31 31</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Population:"</span>, <span class="va">complex_data</span><span class="op">[</span><span class="fl">31</span>, <span class="fl">31</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Population: 35000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Mobility rate:"</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">complex_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">complex_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Mobility rate: 46.2 %</span></span>
<span></span>
<span><span class="co"># Run both algorithms</span></span>
<span><span class="va">seg_original</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca.html">moneca</a></span><span class="op">(</span><span class="va">complex_data</span>, segment.levels <span class="op">=</span> <span class="fl">3</span>, small.cell.reduction <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  11%  |                                                                              |=========                                                             |  12%  |                                                                              |==========                                                            |  14%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  18%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |================                                                      |  23%</span></span>
<span><span class="co">#&gt; 25% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |==================                                                    |  25%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  32%  |                                                                              |========================                                              |  34%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  38%  |                                                                              |============================                                          |  39%  |                                                                              |=============================                                         |  41%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  48%  |                                                                              |===================================                                   |  50%</span></span>
<span><span class="co">#&gt; 51% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |====================================                                  |  52%  |                                                                              |======================================                                |  54%  |                                                                              |=======================================                               |  55%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  61%  |                                                                              |============================================                          |  62%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  66%  |                                                                              |================================================                      |  68%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  75%</span></span>
<span><span class="co">#&gt; 75% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |==========================================================            |  82%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |================================================================      |  91%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  95%  |                                                                              |====================================================================  |  96%  |                                                                              |===================================================================== |  98%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; 100% ready!</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=====                                                                 |   8%  |                                                                              |===========                                                           |  15%  |                                                                              |================                                                      |  23%</span></span>
<span><span class="co">#&gt; 29% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |======================                                                |  31%  |                                                                              |===========================                                           |  38%  |                                                                              |================================                                      |  46%</span></span>
<span><span class="co">#&gt; 50% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |======================================                                |  54%  |                                                                              |===========================================                           |  62%  |                                                                              |================================================                      |  69%  |                                                                              |======================================================                |  77%</span></span>
<span><span class="co">#&gt; 79% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |===========================================================           |  85%  |                                                                              |=================================================================     |  92%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; 100% ready!</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%</span></span>
<span><span class="co">#&gt; 100% ready!</span></span>
<span><span class="va">seg_fast</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca_fast.html">moneca_fast</a></span><span class="op">(</span><span class="va">complex_data</span>, segment.levels <span class="op">=</span> <span class="fl">3</span>, max.clique.size <span class="op">=</span> <span class="fl">6</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare segment structures</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Algorithm comparison for Level 2 segmentation:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Algorithm comparison for Level 2 segmentation:</span></span>
<span><span class="va">original_level2</span> <span class="op">&lt;-</span> <span class="va">seg_original</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">fast_level2</span> <span class="op">&lt;-</span> <span class="va">seg_fast</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Original algorithm - "</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">original_level2</span><span class="op">)</span>, <span class="st">"segments:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Original algorithm -  10 segments:</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">original_level2</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">segment_classes</span> <span class="op">&lt;-</span> <span class="va">original_level2</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Segment"</span>, <span class="va">i</span>, <span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">segment_classes</span><span class="op">)</span>, <span class="st">"classes): "</span>, </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">segment_classes</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">segment_classes</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>,</span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">segment_classes</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">)</span> <span class="st">"..."</span> <span class="kw">else</span> <span class="st">""</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt;   Segment 1 ( 3 classes):  16, 17, 18  </span></span>
<span><span class="co">#&gt;   Segment 2 ( 3 classes):  24, 25, 26  </span></span>
<span><span class="co">#&gt;   Segment 3 ( 3 classes):  20, 21, 22  </span></span>
<span><span class="co">#&gt;   Segment 4 ( 3 classes):  8, 9, 10  </span></span>
<span><span class="co">#&gt;   Segment 5 ( 3 classes):  2, 3, 4  </span></span>
<span><span class="co">#&gt;   Segment 6 ( 3 classes):  5, 6, 7  </span></span>
<span><span class="co">#&gt;   Segment 7 ( 3 classes):  11, 12, 13  </span></span>
<span><span class="co">#&gt;   Segment 8 ( 2 classes):  29, 30  </span></span>
<span><span class="co">#&gt;   Segment 9 ( 2 classes):  27, 28  </span></span>
<span><span class="co">#&gt;   Segment 10 ( 2 classes):  14, 15</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nFast algorithm - "</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fast_level2</span><span class="op">)</span>, <span class="st">"segments:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fast algorithm -  10 segments:</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fast_level2</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">segment_classes</span> <span class="op">&lt;-</span> <span class="va">fast_level2</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Segment"</span>, <span class="va">i</span>, <span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">segment_classes</span><span class="op">)</span>, <span class="st">"classes): "</span>, </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">segment_classes</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">segment_classes</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>,</span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">segment_classes</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">)</span> <span class="st">"..."</span> <span class="kw">else</span> <span class="st">""</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt;   Segment 1 ( 3 classes):  16, 17, 18  </span></span>
<span><span class="co">#&gt;   Segment 2 ( 3 classes):  24, 25, 26  </span></span>
<span><span class="co">#&gt;   Segment 3 ( 3 classes):  20, 21, 22  </span></span>
<span><span class="co">#&gt;   Segment 4 ( 3 classes):  8, 9, 10  </span></span>
<span><span class="co">#&gt;   Segment 5 ( 3 classes):  2, 3, 4  </span></span>
<span><span class="co">#&gt;   Segment 6 ( 3 classes):  5, 6, 7  </span></span>
<span><span class="co">#&gt;   Segment 7 ( 3 classes):  11, 12, 13  </span></span>
<span><span class="co">#&gt;   Segment 8 ( 2 classes):  29, 30  </span></span>
<span><span class="co">#&gt;   Segment 9 ( 2 classes):  27, 28  </span></span>
<span><span class="co">#&gt;   Segment 10 ( 2 classes):  14, 15</span></span>
<span></span>
<span><span class="co"># Compare number of segments at each level</span></span>
<span><span class="va">levels_orig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">seg_original</span><span class="op">$</span><span class="va">segment.list</span>, <span class="va">length</span><span class="op">)</span></span>
<span><span class="va">levels_fast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">seg_fast</span><span class="op">$</span><span class="va">segment.list</span>, <span class="va">length</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ensure both have same length by padding with zeros</span></span>
<span><span class="va">max_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">levels_orig</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">levels_fast</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">levels_orig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">levels_orig</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">max_levels</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">levels_orig</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">levels_fast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">levels_fast</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">max_levels</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">levels_fast</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">comparison_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Level <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">max_levels</span>,</span>
<span>  Original <span class="op">=</span> <span class="va">levels_orig</span>,</span>
<span>  Fast <span class="op">=</span> <span class="va">levels_fast</span>,</span>
<span>  Difference <span class="op">=</span> <span class="va">levels_orig</span> <span class="op">-</span> <span class="va">levels_fast</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nSegmentation comparison across levels:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Segmentation comparison across levels:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comparison_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Level Original Fast Difference</span></span>
<span><span class="co">#&gt; 1     1       30   30          0</span></span>
<span><span class="co">#&gt; 2     2       10   10          0</span></span>
<span><span class="co">#&gt; 3     3        6    6          0</span></span>
<span><span class="co">#&gt; 4     4        1    1          0</span></span>
<span></span>
<span><span class="co"># Calculate segmentation statistics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nSegmentation quality metrics:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Segmentation quality metrics:</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">level</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">seg_original</span><span class="op">$</span><span class="va">segment.list</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">orig_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">seg_original</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="va">level</span><span class="op">]</span><span class="op">]</span>, <span class="va">length</span><span class="op">)</span></span>
<span>  <span class="va">fast_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">seg_fast</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="va">level</span><span class="op">]</span><span class="op">]</span>, <span class="va">length</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Level"</span>, <span class="va">level</span>, <span class="st">":\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Original - Avg size:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">orig_sizes</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>      <span class="st">", Max size:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">orig_sizes</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Fast - Avg size:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">fast_sizes</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>      <span class="st">", Max size:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">fast_sizes</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Level 2 :</span></span>
<span><span class="co">#&gt;   Original - Avg size: 2.7 , Max size: 3 </span></span>
<span><span class="co">#&gt;   Fast - Avg size: 2.7 , Max size: 3 </span></span>
<span><span class="co">#&gt; Level 3 :</span></span>
<span><span class="co">#&gt;   Original - Avg size: 5 , Max size: 7 </span></span>
<span><span class="co">#&gt;   Fast - Avg size: 5 , Max size: 7</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="parameter-tuning-for-moneca_fast">Parameter Tuning for moneca_fast()<a class="anchor" aria-label="anchor" href="#parameter-tuning-for-moneca_fast"></a>
</h2>
<p>The <code><a href="../reference/moneca_fast.html">moneca_fast()</a></code> function provides several parameters
for performance tuning:</p>
<div class="section level3">
<h3 id="min-density-parameter">min.density Parameter<a class="anchor" aria-label="anchor" href="#min-density-parameter"></a>
</h3>
<p>Controls early stopping based on network density:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Test different density thresholds with 30-class system</span></span>
<span><span class="va">data_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_mobility_data.html">generate_mobility_data</a></span><span class="op">(</span></span>
<span>  n_classes <span class="op">=</span> <span class="fl">30</span>, </span>
<span>  n_total <span class="op">=</span> <span class="fl">25000</span>,</span>
<span>  class_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Class"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%02d"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">456</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Testing density thresholds with 30-class system:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Testing density thresholds with 30-class system:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Matrix dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">data_test</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Matrix dimensions: 31 31</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Population:"</span>, <span class="va">data_test</span><span class="op">[</span><span class="fl">31</span>, <span class="fl">31</span><span class="op">]</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Population: 25000</span></span>
<span></span>
<span><span class="co"># Conservative (lower threshold - more processing)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Running conservative analysis (min.density = 0.001)...\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Running conservative analysis (min.density = 0.001)...</span></span>
<span><span class="va">result_conservative</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca_fast.html">moneca_fast</a></span><span class="op">(</span></span>
<span>  <span class="va">data_test</span>, </span>
<span>  min.density <span class="op">=</span> <span class="fl">0.001</span>, </span>
<span>  max.clique.size <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Aggressive (higher threshold - less processing)  </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Running aggressive analysis (min.density = 0.05)...\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Running aggressive analysis (min.density = 0.05)...</span></span>
<span><span class="va">result_aggressive</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca_fast.html">moneca_fast</a></span><span class="op">(</span></span>
<span>  <span class="va">data_test</span>, </span>
<span>  min.density <span class="op">=</span> <span class="fl">0.05</span>, </span>
<span>  max.clique.size <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Standard threshold for comparison</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Running standard analysis (min.density = 0.01)...\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Running standard analysis (min.density = 0.01)...</span></span>
<span><span class="va">result_standard</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca_fast.html">moneca_fast</a></span><span class="op">(</span></span>
<span>  <span class="va">data_test</span>, </span>
<span>  min.density <span class="op">=</span> <span class="fl">0.01</span>, </span>
<span>  max.clique.size <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nDensity threshold comparison:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Density threshold comparison:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Conservative (0.001) - levels:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">result_conservative</span><span class="op">$</span><span class="va">segment.list</span><span class="op">)</span>, </span>
<span>    <span class="st">", L2 segments:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">result_conservative</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Conservative (0.001) - levels: 4 , L2 segments: 11</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Standard (0.01) - levels:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">result_standard</span><span class="op">$</span><span class="va">segment.list</span><span class="op">)</span>, </span>
<span>    <span class="st">", L2 segments:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">result_standard</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Standard (0.01) - levels: 4 , L2 segments: 11</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Aggressive (0.05) - levels:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">result_aggressive</span><span class="op">$</span><span class="va">segment.list</span><span class="op">)</span>, </span>
<span>    <span class="st">", L2 segments:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">result_aggressive</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Aggressive (0.05) - levels: 4 , L2 segments: 11</span></span>
<span></span>
<span><span class="co"># Show effect on segmentation quality</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">result_conservative</span><span class="op">$</span><span class="va">segment.list</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">cons_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">result_conservative</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="va">length</span><span class="op">)</span></span>
<span>  <span class="va">std_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">result_standard</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="va">length</span><span class="op">)</span></span>
<span>  <span class="va">agg_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">result_aggressive</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="va">length</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nLevel 2 segmentation characteristics:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Conservative - Avg segment size:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">cons_sizes</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Standard - Avg segment size:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">std_sizes</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Aggressive - Avg segment size:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">agg_sizes</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Level 2 segmentation characteristics:</span></span>
<span><span class="co">#&gt; Conservative - Avg segment size: 2.7 </span></span>
<span><span class="co">#&gt; Standard - Avg segment size: 2.7 </span></span>
<span><span class="co">#&gt; Aggressive - Avg segment size: 2.7</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="max-clique-size-parameter">max.clique.size Parameter<a class="anchor" aria-label="anchor" href="#max-clique-size-parameter"></a>
</h3>
<p>Limits maximum clique size to control computation:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Test different clique size limits with 30-class system</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Testing clique size limits with 30-class system:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Testing clique size limits with 30-class system:</span></span>
<span></span>
<span><span class="co"># Unlimited clique size (computationally intensive for 30 nodes)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Running with unlimited clique size...\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Running with unlimited clique size...</span></span>
<span><span class="va">time_unlimited</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">result_unlimited</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca_fast.html">moneca_fast</a></span><span class="op">(</span><span class="va">data_test</span>, max.clique.size <span class="op">=</span> <span class="cn">NULL</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Moderately limited clique size</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Running with clique size limit = 6...\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Running with clique size limit = 6...</span></span>
<span><span class="va">time_moderate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">result_moderate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca_fast.html">moneca_fast</a></span><span class="op">(</span><span class="va">data_test</span>, max.clique.size <span class="op">=</span> <span class="fl">6</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Strictly limited clique size</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Running with clique size limit = 4...\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Running with clique size limit = 4...</span></span>
<span><span class="va">time_strict</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">result_strict</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca_fast.html">moneca_fast</a></span><span class="op">(</span><span class="va">data_test</span>, max.clique.size <span class="op">=</span> <span class="fl">4</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nClique size limit comparison:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Clique size limit comparison:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Unlimited cliques:"</span>, </span>
<span>    <span class="st">"- Time:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">time_unlimited</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"sec"</span>,</span>
<span>    <span class="st">"- L2 segments:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">result_unlimited</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Unlimited cliques: - Time: 0.55 sec - L2 segments: 11</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Moderate limit (6):"</span>, </span>
<span>    <span class="st">"- Time:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">time_moderate</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"sec"</span>,</span>
<span>    <span class="st">"- L2 segments:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">result_moderate</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Moderate limit (6): - Time: 0.55 sec - L2 segments: 11</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Strict limit (4):"</span>, </span>
<span>    <span class="st">"- Time:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">time_strict</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"sec"</span>,</span>
<span>    <span class="st">"- L2 segments:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">result_strict</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Strict limit (4): - Time: 0.57 sec - L2 segments: 11</span></span>
<span></span>
<span><span class="co"># Compare segmentation quality</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">result_unlimited</span><span class="op">$</span><span class="va">segment.list</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">unl_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">result_unlimited</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="va">length</span><span class="op">)</span></span>
<span>  <span class="va">mod_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">result_moderate</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="va">length</span><span class="op">)</span></span>
<span>  <span class="va">str_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">result_strict</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="va">length</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nSegmentation quality comparison:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Unlimited - Avg segment size:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">unl_sizes</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>      <span class="st">", Largest segment:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">unl_sizes</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Moderate - Avg segment size:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mod_sizes</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>      <span class="st">", Largest segment:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mod_sizes</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Strict - Avg segment size:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">str_sizes</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>      <span class="st">", Largest segment:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">str_sizes</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nRecommendation: For 30-class systems, clique size limit of 6-8 provides\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"good balance between computational efficiency and segmentation quality.\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Segmentation quality comparison:</span></span>
<span><span class="co">#&gt; Unlimited - Avg segment size: 2.7 , Largest segment: 3 </span></span>
<span><span class="co">#&gt; Moderate - Avg segment size: 2.7 , Largest segment: 3 </span></span>
<span><span class="co">#&gt; Strict - Avg segment size: 2.7 , Largest segment: 3 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Recommendation: For 30-class systems, clique size limit of 6-8 provides</span></span>
<span><span class="co">#&gt; good balance between computational efficiency and segmentation quality.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="sparse-matrix-support">Sparse Matrix Support<a class="anchor" aria-label="anchor" href="#sparse-matrix-support"></a>
</h3>
<p>For large, sparse matrices:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Test sparse matrix support with 30-class system</span></span>
<span><span class="co"># Sparse matrices are particularly beneficial for large, sparse datasets</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Testing sparse matrix support with 30-class system:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Testing sparse matrix support with 30-class system:</span></span>
<span></span>
<span><span class="co"># Calculate sparsity of our test data</span></span>
<span><span class="va">test_core</span> <span class="op">&lt;-</span> <span class="va">data_test</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">]</span></span>
<span><span class="va">sparsity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">test_core</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">30</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Data sparsity:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">sparsity</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Data sparsity: 17.8 %</span></span>
<span></span>
<span><span class="co"># Regular matrix processing</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Running with dense matrix representation...\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Running with dense matrix representation...</span></span>
<span><span class="va">time_dense</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">result_dense</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca_fast.html">moneca_fast</a></span><span class="op">(</span><span class="va">data_test</span>, use.sparse <span class="op">=</span> <span class="cn">FALSE</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sparse matrix processing (if Matrix package available)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"Matrix"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Running with sparse matrix representation...\n"</span><span class="op">)</span></span>
<span>  <span class="va">time_sparse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">result_sparse</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca_fast.html">moneca_fast</a></span><span class="op">(</span><span class="va">data_test</span>, use.sparse <span class="op">=</span> <span class="cn">TRUE</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nMatrix representation comparison:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Dense matrices - Time:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">time_dense</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"sec"</span>,</span>
<span>      <span class="st">"- L2 segments:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">result_dense</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Sparse matrices - Time:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">time_sparse</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"sec"</span>,</span>
<span>      <span class="st">"- L2 segments:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">result_sparse</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Compare memory usage</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nApproximate memory usage:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Dense result:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/object.size.html" class="external-link">object.size</a></span><span class="op">(</span><span class="va">result_dense</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1024</span><span class="op">^</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"MB\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Sparse result:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/object.size.html" class="external-link">object.size</a></span><span class="op">(</span><span class="va">result_sparse</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1024</span><span class="op">^</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"MB\n"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Check if results are identical</span></span>
<span>  <span class="va">identical_sparse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">result_dense</span><span class="op">$</span><span class="va">segment.list</span>, <span class="va">result_sparse</span><span class="op">$</span><span class="va">segment.list</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Results identical:"</span>, <span class="va">identical_sparse</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nNote: Sparse matrices are most beneficial when data sparsity &gt; 70%\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Current data sparsity:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">sparsity</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"% - "</span>, </span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="va">sparsity</span> <span class="op">&gt;</span> <span class="fl">70</span><span class="op">)</span> <span class="st">"Good candidate for sparse representation"</span> <span class="kw">else</span> <span class="st">"Dense representation may be sufficient"</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Matrix package not available - sparse support skipped\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Install Matrix package with: install.packages('Matrix')\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Running with sparse matrix representation...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix representation comparison:</span></span>
<span><span class="co">#&gt; Dense matrices - Time: 0.56 sec - L2 segments: 11 </span></span>
<span><span class="co">#&gt; Sparse matrices - Time: 0.56 sec - L2 segments: 11 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Approximate memory usage:</span></span>
<span><span class="co">#&gt; Dense result: 0.03 MB</span></span>
<span><span class="co">#&gt; Sparse result: 0.03 MB</span></span>
<span><span class="co">#&gt; Results identical: TRUE </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Note: Sparse matrices are most beneficial when data sparsity &gt; 70%</span></span>
<span><span class="co">#&gt; Current data sparsity: 17.8 % -  Dense representation may be sufficient</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="decision-guidelines">Decision Guidelines<a class="anchor" aria-label="anchor" href="#decision-guidelines"></a>
</h2>
<div class="section level3">
<h3 id="when-to-use-moneca">When to Use moneca()<a class="anchor" aria-label="anchor" href="#when-to-use-moneca"></a>
</h3>
<p>Choose the original <code><a href="../reference/moneca.html">moneca()</a></code> function when:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Accuracy is paramount</strong>: You need the most
comprehensive and conservative segmentation</li>
<li>
<strong>Small to medium datasets</strong>: Network size is
manageable (&lt; 15 nodes typically)</li>
<li>
<strong>Reproducibility is critical</strong>: You need identical
results across different runs and platforms</li>
<li>
<strong>Methodological consistency</strong>: You’re replicating or
extending previous research using MONECA</li>
<li>
<strong>Edge case handling</strong>: You’re working with unusual
network structures that might challenge optimizations</li>
</ol>
</div>
<div class="section level3">
<h3 id="when-to-use-moneca_fast">When to Use moneca_fast()<a class="anchor" aria-label="anchor" href="#when-to-use-moneca_fast"></a>
</h3>
<p>Choose the optimized <code><a href="../reference/moneca_fast.html">moneca_fast()</a></code> function when:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Performance is important</strong>: You’re working with
larger networks or need faster results</li>
<li>
<strong>Exploratory analysis</strong>: You’re doing initial
exploration and can accept minor differences in segmentation</li>
<li>
<strong>Production environments</strong>: You need reliable
performance characteristics for automated analyses<br>
</li>
<li>
<strong>Resource constraints</strong>: You have limited
computational resources or memory</li>
<li>
<strong>Large-scale studies</strong>: You’re processing multiple
datasets and need efficiency</li>
</ol>
</div>
<div class="section level3">
<h3 id="hybrid-approach">Hybrid Approach<a class="anchor" aria-label="anchor" href="#hybrid-approach"></a>
</h3>
<p>For comprehensive analysis, consider using both:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Demonstrate hybrid approach with 30-class system</span></span>
<span><span class="va">hybrid_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_mobility_data.html">generate_mobility_data</a></span><span class="op">(</span></span>
<span>  n_classes <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  n_total <span class="op">=</span> <span class="fl">40000</span>,</span>
<span>  class_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Class"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%02d"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">999</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Hybrid approach with 30-class system:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Hybrid approach with 30-class system:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Step 1: Fast exploration...\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Step 1: Fast exploration...</span></span>
<span></span>
<span><span class="co"># Start with fast version for exploration</span></span>
<span><span class="va">time_initial</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">initial_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca_fast.html">moneca_fast</a></span><span class="op">(</span></span>
<span>    <span class="va">hybrid_data</span>, </span>
<span>    segment.levels <span class="op">=</span> <span class="fl">3</span>, </span>
<span>    max.clique.size <span class="op">=</span> <span class="fl">6</span>,</span>
<span>    progress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Fast exploration completed in"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">time_initial</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"seconds\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fast exploration completed in 0.57 seconds</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Levels found:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">initial_result</span><span class="op">$</span><span class="va">segment.list</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Levels found: 4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Level 2 segments:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">initial_result</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Level 2 segments: 10</span></span>
<span></span>
<span><span class="co"># If results look promising and accuracy is needed, validate with original</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">initial_result</span><span class="op">$</span><span class="va">segment.list</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nStep 2: Detailed validation with original algorithm...\n"</span><span class="op">)</span></span>
<span>  <span class="va">time_validation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">final_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moneca.html">moneca</a></span><span class="op">(</span><span class="va">hybrid_data</span>, segment.levels <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Validation completed in"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">time_validation</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"seconds\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nComparison of hybrid approach results:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Fast (exploration) - L2 segments:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">initial_result</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Original (validation) - L2 segments:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">final_result</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Check agreement</span></span>
<span>  <span class="va">results_match</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">initial_result</span><span class="op">$</span><span class="va">segment.list</span>, <span class="va">final_result</span><span class="op">$</span><span class="va">segment.list</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Results match:"</span>, <span class="va">results_match</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="va">results_match</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nDifferences found - Original algorithm provides more conservative segmentation\n"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Total time for hybrid approach:"</span>, </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">time_initial</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span> <span class="op">+</span> <span class="va">time_validation</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"seconds\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nResults identical - Fast algorithm was sufficient\n"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Time saved by using fast algorithm:"</span>, </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">time_validation</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span> <span class="op">-</span> <span class="va">time_initial</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"seconds\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nHybrid approach: Fast exploration followed by selective validation\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Recommended for: Large datasets where accuracy is critical but\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"computational efficiency is also important.\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Step 2: Detailed validation with original algorithm...</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   9%  |                                                                              |========                                                              |  11%  |                                                                              |=========                                                             |  12%  |                                                                              |==========                                                            |  14%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  18%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |================                                                      |  23%</span></span>
<span><span class="co">#&gt; 25% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |==================                                                    |  25%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  32%  |                                                                              |========================                                              |  34%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  38%  |                                                                              |============================                                          |  39%  |                                                                              |=============================                                         |  41%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  46%  |                                                                              |==================================                                    |  48%  |                                                                              |===================================                                   |  50%</span></span>
<span><span class="co">#&gt; 51% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |====================================                                  |  52%  |                                                                              |======================================                                |  54%  |                                                                              |=======================================                               |  55%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  61%  |                                                                              |============================================                          |  62%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  66%  |                                                                              |================================================                      |  68%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  75%</span></span>
<span><span class="co">#&gt; 75% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |==========================================================            |  82%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |================================================================      |  91%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  95%  |                                                                              |====================================================================  |  96%  |                                                                              |===================================================================== |  98%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; 100% ready!</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |========                                                              |  11%  |                                                                              |================                                                      |  22%</span></span>
<span><span class="co">#&gt; 30% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |=======================                                               |  33%  |                                                                              |===============================                                       |  44%</span></span>
<span><span class="co">#&gt; 50% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |=======================================                               |  56%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================                |  78%</span></span>
<span><span class="co">#&gt; 80% ready!</span></span>
<span><span class="co">#&gt;   |                                                                              |==============================================================        |  89%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; 100% ready!</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%</span></span>
<span><span class="co">#&gt; 100% ready!</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Validation completed in 0.6 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparison of hybrid approach results:</span></span>
<span><span class="co">#&gt; Fast (exploration) - L2 segments: 10 </span></span>
<span><span class="co">#&gt; Original (validation) - L2 segments: 10 </span></span>
<span><span class="co">#&gt; Results match: FALSE </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Differences found - Original algorithm provides more conservative segmentation</span></span>
<span><span class="co">#&gt; Total time for hybrid approach: 1.17 seconds</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Hybrid approach: Fast exploration followed by selective validation</span></span>
<span><span class="co">#&gt; Recommended for: Large datasets where accuracy is critical but</span></span>
<span><span class="co">#&gt; computational efficiency is also important.</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="quality-assessment">Quality Assessment<a class="anchor" aria-label="anchor" href="#quality-assessment"></a>
</h2>
<p>Both algorithms should produce similar high-level segmentation
patterns, but may differ in details:</p>
<div class="section level3">
<h3 id="comparing-algorithm-outputs">Comparing Algorithm Outputs<a class="anchor" aria-label="anchor" href="#comparing-algorithm-outputs"></a>
</h3>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Enhanced function to compare segmentation quality for 30-class systems</span></span>
<span><span class="va">compare_segmentations</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">seg1</span>, <span class="va">seg2</span>, <span class="va">level</span> <span class="op">=</span> <span class="fl">2</span>, <span class="va">data_matrix</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">seg1</span><span class="op">$</span><span class="va">segment.list</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">level</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">seg2</span><span class="op">$</span><span class="va">segment.list</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">level</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="st">"Insufficient levels for comparison"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Compare number of segments</span></span>
<span>  <span class="va">n_segments_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">seg1</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="va">level</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">n_segments_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">seg2</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="va">level</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Calculate segment size distributions</span></span>
<span>  <span class="va">sizes_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">seg1</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="va">level</span><span class="op">]</span><span class="op">]</span>, <span class="va">length</span><span class="op">)</span></span>
<span>  <span class="va">sizes_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">seg2</span><span class="op">$</span><span class="va">segment.list</span><span class="op">[[</span><span class="va">level</span><span class="op">]</span><span class="op">]</span>, <span class="va">length</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Calculate additional quality metrics</span></span>
<span>  <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    n_segments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>algorithm1 <span class="op">=</span> <span class="va">n_segments_1</span>, algorithm2 <span class="op">=</span> <span class="va">n_segments_2</span><span class="op">)</span>,</span>
<span>    avg_segment_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>algorithm1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sizes_1</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, algorithm2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sizes_2</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    size_variance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>algorithm1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">sizes_1</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, algorithm2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">sizes_2</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    max_segment_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>algorithm1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">sizes_1</span><span class="op">)</span>, algorithm2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">sizes_2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    min_segment_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>algorithm1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">sizes_1</span><span class="op">)</span>, algorithm2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">sizes_2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    size_distribution_1 <span class="op">=</span> <span class="va">sizes_1</span>,</span>
<span>    size_distribution_2 <span class="op">=</span> <span class="va">sizes_2</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># If data matrix provided, calculate internal mobility</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">data_matrix</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Calculate internal mobility for each algorithm at specified level</span></span>
<span>    <span class="va">mx1</span> <span class="op">&lt;-</span> <span class="va">seg1</span><span class="op">$</span><span class="va">mat.list</span><span class="op">[[</span><span class="va">level</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">mx2</span> <span class="op">&lt;-</span> <span class="va">seg2</span><span class="op">$</span><span class="va">mat.list</span><span class="op">[[</span><span class="va">level</span><span class="op">]</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="va">l1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mx1</span><span class="op">)</span></span>
<span>    <span class="va">l2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mx2</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">internal1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">mx1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">l1</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">l1</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">mx1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">l1</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">l1</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>    <span class="va">internal2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">mx2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">l2</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">l2</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">mx2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">l2</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">l2</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>    </span>
<span>    <span class="va">results</span><span class="op">$</span><span class="va">internal_mobility</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>algorithm1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">internal1</span>, <span class="fl">1</span><span class="op">)</span>, algorithm2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">internal2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Compare algorithms using our 30-class example data</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"result_orig"</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"result_fast"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Comprehensive quality assessment for 30-class system:\n\n"</span><span class="op">)</span></span>
<span>  <span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu">compare_segmentations</span><span class="op">(</span><span class="va">result_orig</span>, <span class="va">result_fast</span>, level <span class="op">=</span> <span class="fl">2</span>, <span class="va">large_data</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Number of segments:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Original algorithm:"</span>, <span class="va">comparison</span><span class="op">$</span><span class="va">n_segments</span><span class="op">[</span><span class="st">"algorithm1"</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Fast algorithm:"</span>, <span class="va">comparison</span><span class="op">$</span><span class="va">n_segments</span><span class="op">[</span><span class="st">"algorithm2"</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nAverage segment size:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Original algorithm:"</span>, <span class="va">comparison</span><span class="op">$</span><span class="va">avg_segment_size</span><span class="op">[</span><span class="st">"algorithm1"</span><span class="op">]</span>, <span class="st">"classes\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Fast algorithm:"</span>, <span class="va">comparison</span><span class="op">$</span><span class="va">avg_segment_size</span><span class="op">[</span><span class="st">"algorithm2"</span><span class="op">]</span>, <span class="st">"classes\n"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nSegment size range:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Original algorithm:"</span>, <span class="va">comparison</span><span class="op">$</span><span class="va">min_segment_size</span><span class="op">[</span><span class="st">"algorithm1"</span><span class="op">]</span>, <span class="st">"-"</span>, </span>
<span>      <span class="va">comparison</span><span class="op">$</span><span class="va">max_segment_size</span><span class="op">[</span><span class="st">"algorithm1"</span><span class="op">]</span>, <span class="st">"classes\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Fast algorithm:"</span>, <span class="va">comparison</span><span class="op">$</span><span class="va">min_segment_size</span><span class="op">[</span><span class="st">"algorithm2"</span><span class="op">]</span>, <span class="st">"-"</span>, </span>
<span>      <span class="va">comparison</span><span class="op">$</span><span class="va">max_segment_size</span><span class="op">[</span><span class="st">"algorithm2"</span><span class="op">]</span>, <span class="st">"classes\n"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">$</span><span class="va">internal_mobility</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nInternal mobility (Level 2):\n"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Original algorithm:"</span>, <span class="va">comparison</span><span class="op">$</span><span class="va">internal_mobility</span><span class="op">[</span><span class="st">"algorithm1"</span><span class="op">]</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Fast algorithm:"</span>, <span class="va">comparison</span><span class="op">$</span><span class="va">internal_mobility</span><span class="op">[</span><span class="st">"algorithm2"</span><span class="op">]</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nSegment size distributions:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Original:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">$</span><span class="va">size_distribution_1</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Fast:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">$</span><span class="va">size_distribution_2</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Statistical comparison</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nStatistical comparison:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Size variance (lower = more balanced segmentation):\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"    Original:"</span>, <span class="va">comparison</span><span class="op">$</span><span class="va">size_variance</span><span class="op">[</span><span class="st">"algorithm1"</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"    Fast:"</span>, <span class="va">comparison</span><span class="op">$</span><span class="va">size_variance</span><span class="op">[</span><span class="st">"algorithm2"</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Overall assessment</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nOverall assessment:\n"</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">$</span><span class="va">n_segments</span><span class="op">[</span><span class="st">"algorithm1"</span><span class="op">]</span> <span class="op">-</span> <span class="va">comparison</span><span class="op">$</span><span class="va">n_segments</span><span class="op">[</span><span class="st">"algorithm2"</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Segment counts very similar - both algorithms effective\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Notable difference in segment counts - investigate further\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">$</span><span class="va">internal_mobility</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">mobility_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">$</span><span class="va">internal_mobility</span><span class="op">[</span><span class="st">"algorithm1"</span><span class="op">]</span> <span class="op">-</span> <span class="va">comparison</span><span class="op">$</span><span class="va">internal_mobility</span><span class="op">[</span><span class="st">"algorithm2"</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">mobility_diff</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Internal mobility rates very similar - consistent quality\n"</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Notable difference in internal mobility - algorithms may emphasize different patterns\n"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Previous algorithm results not available for comparison\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Run the performance comparison section first\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Comprehensive quality assessment for 30-class system:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of segments:</span></span>
<span><span class="co">#&gt;   Original algorithm: 9 </span></span>
<span><span class="co">#&gt;   Fast algorithm: 9 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Average segment size:</span></span>
<span><span class="co">#&gt;   Original algorithm: 3 classes</span></span>
<span><span class="co">#&gt;   Fast algorithm: 3 classes</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Segment size range:</span></span>
<span><span class="co">#&gt;   Original algorithm: 3 - 3 classes</span></span>
<span><span class="co">#&gt;   Fast algorithm: 3 - 3 classes</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Internal mobility (Level 2):</span></span>
<span><span class="co">#&gt;   Original algorithm: 73.5 %</span></span>
<span><span class="co">#&gt;   Fast algorithm: 73.4 %</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Segment size distributions:</span></span>
<span><span class="co">#&gt;   Original: 3, 3, 3, 3, 3, 3, 3, 3, 3 </span></span>
<span><span class="co">#&gt;   Fast: 3, 3, 3, 3, 3, 3, 3, 3, 3 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Statistical comparison:</span></span>
<span><span class="co">#&gt;   Size variance (lower = more balanced segmentation):</span></span>
<span><span class="co">#&gt;     Original: 0 </span></span>
<span><span class="co">#&gt;     Fast: 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Overall assessment:</span></span>
<span><span class="co">#&gt;   Segment counts very similar - both algorithms effective</span></span>
<span><span class="co">#&gt;   Internal mobility rates very similar - consistent quality</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="validation-strategies">Validation Strategies<a class="anchor" aria-label="anchor" href="#validation-strategies"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Cross-validation</strong>: Run both algorithms and compare
results</li>
<li>
<strong>Sensitivity analysis</strong>: Test with different
parameters</li>
<li>
<strong>Visualization</strong>: Plot results to assess segmentation
quality</li>
<li>
<strong>Domain expertise</strong>: Validate results against
substantive knowledge</li>
</ol>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Visualize results from both algorithms</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ggraph"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Note: In practice, you would create actual plots here</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Both algorithms can be visualized using plot_moneca_ggraph()\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Compare visual output for validation\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Both algorithms can be visualized using plot_moneca_ggraph()</span></span>
<span><span class="co">#&gt; Compare visual output for validation</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>Both <code><a href="../reference/moneca.html">moneca()</a></code> and <code><a href="../reference/moneca_fast.html">moneca_fast()</a></code> implement
the core MONECA methodology effectively, but with different optimization
strategies:</p>
<div class="section level3">
<h3 id="summary-of-key-differences">Summary of Key Differences<a class="anchor" aria-label="anchor" href="#summary-of-key-differences"></a>
</h3>
<table class="table">
<colgroup>
<col width="24%">
<col width="30%">
<col width="45%">
</colgroup>
<thead><tr class="header">
<th>Aspect</th>
<th>moneca()</th>
<th>moneca_fast()</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Clique Strategy</strong></td>
<td>All cliques</td>
<td>Maximal cliques</td>
</tr>
<tr class="even">
<td><strong>Performance</strong></td>
<td>Slower, thorough</td>
<td>Faster, optimized</td>
</tr>
<tr class="odd">
<td><strong>Memory Usage</strong></td>
<td>Higher</td>
<td>Lower</td>
</tr>
<tr class="even">
<td><strong>Accuracy</strong></td>
<td>Maximally conservative</td>
<td>Practically accurate</td>
</tr>
<tr class="odd">
<td><strong>Parameter Complexity</strong></td>
<td>Simple</td>
<td>More options</td>
</tr>
<tr class="even">
<td><strong>Best Use Case</strong></td>
<td>Small networks, maximum accuracy</td>
<td>Larger networks, good performance</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="recommendations">Recommendations<a class="anchor" aria-label="anchor" href="#recommendations"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Start with moneca_fast()</strong> for initial exploration
and most practical applications</li>
<li>
<strong>Use moneca()</strong> when accuracy is critical or networks
are small</li>
<li>
<strong>Compare results</strong> when in doubt about which algorithm
to trust</li>
<li>
<strong>Consider dataset characteristics</strong> - sparse
vs. dense, small vs. large</li>
<li>
<strong>Validate results</strong> using domain knowledge and
visualization</li>
</ol>
<p>The choice between algorithms should be based on your specific
requirements for accuracy, performance, and the characteristics of your
mobility data. Both algorithms are valid implementations of the MONECA
methodology and will provide valuable insights into mobility patterns
and social structure.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Toubøl, J., &amp; Larsen, A. G. (2017). Mapping the Social Class
Structure: From Occupational Mobility to Social Class Categories Using
Network Analysis. <em>Sociology</em>, 51(6), 1257-1276.</li>
</ul>
</div>
<div class="section level2">
<h2 id="session-information">Session Information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices datasets  utils     methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] moneca_0.8.3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] viridis_0.6.5      sass_0.4.10        generics_0.1.4     tidyr_1.3.1       </span></span>
<span><span class="co">#&gt;  [5] renv_1.1.4         lattice_0.22-7     digest_0.6.37      magrittr_2.0.4    </span></span>
<span><span class="co">#&gt;  [9] evaluate_1.0.5     grid_4.5.1         RColorBrewer_1.1-3 fastmap_1.2.0     </span></span>
<span><span class="co">#&gt; [13] Matrix_1.7-3       jsonlite_2.0.0     toOrdinal_1.3-0.0  ggrepel_0.9.6     </span></span>
<span><span class="co">#&gt; [17] brio_1.1.5         gridExtra_2.3      purrr_1.1.0        viridisLite_0.4.2 </span></span>
<span><span class="co">#&gt; [21] scales_1.4.0       tweenr_2.0.3       textshaping_1.0.4  jquerylib_0.1.4   </span></span>
<span><span class="co">#&gt; [25] cli_3.6.5          crayon_1.5.3       rlang_1.1.6        graphlayouts_1.2.2</span></span>
<span><span class="co">#&gt; [29] polyclip_1.10-7    tidygraph_1.3.1    withr_3.0.2        cachem_1.1.0      </span></span>
<span><span class="co">#&gt; [33] yaml_2.3.10        tools_4.5.1        memoise_2.0.1      dplyr_1.1.4       </span></span>
<span><span class="co">#&gt; [37] ggplot2_4.0.0      vctrs_0.6.5        R6_2.6.1           lifecycle_1.0.4   </span></span>
<span><span class="co">#&gt; [41] fs_1.6.6           MASS_7.3-65        ragg_1.5.0         ggraph_2.2.2      </span></span>
<span><span class="co">#&gt; [45] pkgconfig_2.0.3    desc_1.4.3         pkgdown_2.1.3      pillar_1.11.1     </span></span>
<span><span class="co">#&gt; [49] bslib_0.9.0        gtable_0.3.6       glue_1.8.0         Rcpp_1.1.0        </span></span>
<span><span class="co">#&gt; [53] ggforce_0.5.0      systemfonts_1.3.1  xfun_0.53          tibble_3.3.0      </span></span>
<span><span class="co">#&gt; [57] tidyselect_1.2.1   knitr_1.50         farver_2.1.2       htmltools_0.5.8.1 </span></span>
<span><span class="co">#&gt; [61] igraph_2.2.0       rmarkdown_2.30     testthat_3.2.3     compiler_4.5.1    </span></span>
<span><span class="co">#&gt; [65] S7_0.2.0</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Giampaolo Montaletti, Jonas Touboel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
