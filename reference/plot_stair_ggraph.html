<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Multi-Level Segmentation Visualization (Stair Plot) — plot_stair_ggraph • moneca</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multi-Level Segmentation Visualization (Stair Plot) — plot_stair_ggraph"><meta name="description" content='Creates a series of network plots showing how segmentation evolves across
hierarchical levels in a moneca analysis. This "stair plot" provides insight
into the progressive clustering of social positions.'><meta property="og:description" content='Creates a series of network plots showing how segmentation evolves across
hierarchical levels in a moneca analysis. This "stair plot" provides insight
into the progressive clustering of social positions.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">moneca</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.8.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/moneca-introduction.html">Introduction to moneca: Mobility Network Clustering Analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="dropdown-item" href="https://gmontaletti.github.io/MONECA/news/index.html#moneca-08">Version 0.8</a></li>
    <li><a class="dropdown-item" href="https://gmontaletti.github.io/MONECA/news/index.html#moneca-07">Version 0.7</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gmontaletti/MONECA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Multi-Level Segmentation Visualization (Stair Plot)</h1>
      <small class="dont-index">Source: <a href="https://github.com/gmontaletti/MONECA/blob/master/R/modern_plotting.R" class="external-link"><code>R/modern_plotting.R</code></a></small>
      <div class="d-none name"><code>plot_stair_ggraph.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates a series of network plots showing how segmentation evolves across
hierarchical levels in a moneca analysis. This "stair plot" provides insight
into the progressive clustering of social positions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_stair_ggraph</span><span class="op">(</span></span>
<span>  <span class="va">segments</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">segments</span><span class="op">$</span><span class="va">segment.list</span><span class="op">)</span>,</span>
<span>  layout <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  segment_naming <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  include_first_level <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-segments">segments<a class="anchor" aria-label="anchor" href="#arg-segments"></a></dt>
<dd><p>A moneca object returned by <code><a href="moneca.html">moneca</a></code>.</p></dd>


<dt id="arg-levels">levels<a class="anchor" aria-label="anchor" href="#arg-levels"></a></dt>
<dd><p>Integer vector specifying which hierarchical levels to visualize.
Default includes all levels.</p></dd>


<dt id="arg-layout">layout<a class="anchor" aria-label="anchor" href="#arg-layout"></a></dt>
<dd><p>Layout specification for consistency across plots. Can be:</p><ul><li><p>NULL (default): Use layout.matrix() for consistent positioning</p></li>
<li><p>Character string: Layout algorithm name ("fr", "kk", "stress", etc.)</p></li>
<li><p>Matrix: Custom coordinate matrix for node positions</p></li>
</ul></dd>


<dt id="arg-ncol">ncol<a class="anchor" aria-label="anchor" href="#arg-ncol"></a></dt>
<dd><p>Integer specifying the number of columns in the plot grid.
Default is 2. Set to 1 for vertical arrangement.</p></dd>


<dt id="arg-segment-naming">segment_naming<a class="anchor" aria-label="anchor" href="#arg-segment-naming"></a></dt>
<dd><p>Specifies how to name segments across all visualization levels. Can be:</p><ul><li><p>Character string: "auto" (default), "concat", "pattern", or "custom" -
    these are passed to <code><a href="segment.membership.enhanced.html">segment.membership.enhanced</a></code> for automatic naming</p></li>
<li><p>data.frame: Custom segment labels with columns "name" (node names from the
    mobility matrix) and "segment_label" (desired custom labels). This allows complete
    control over segment naming across all hierarchical levels</p></li>
<li><p>NULL: Uses default "auto" strategy</p></li>
</ul><p>When a data.frame is provided, custom labels override automatically generated names
consistently across all levels. The data.frame approach is particularly useful for
stair plots as it maintains consistent naming across the hierarchical progression.</p></dd>


<dt id="arg-include-first-level">include_first_level<a class="anchor" aria-label="anchor" href="#arg-include-first-level"></a></dt>
<dd><p>Logical indicating whether to include the first level
(individual classes without segmentation). Default is TRUE.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to <code><a href="plot_moneca_ggraph.html">plot_moneca_ggraph</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>combine_plots = TRUE</code>, returns a combined plot grid object.
If <code>combine_plots = FALSE</code>, returns a list of ggplot objects, one for each level.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The stair plot helps visualize the hierarchical nature of MONECA segmentation
by showing how larger segments at higher levels break down into smaller, more
specific segments at lower levels. This is particularly useful for:</p><ul><li><p>Understanding the segmentation process</p></li>
<li><p>Identifying optimal levels of analysis</p></li>
<li><p>Presenting results to different audiences</p></li>
<li><p>Comparing segmentation stability across levels</p></li>
</ul><p>When using a consistent layout across all plots, the relative positions of
nodes remain the same, making it easier to track how segments evolve.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="plot_moneca_ggraph.html">plot_moneca_ggraph</a></code> for single-level visualization,
<code><a href="plot_ego_ggraph.html">plot_ego_ggraph</a></code> for ego network analysis,
<code><a href="layout.matrix.html">layout.matrix</a></code> for consistent layouts,
<code><a href="moneca.html">moneca</a></code> for the main analysis function</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Generate synthetic data and run MONECA</span></span></span>
<span class="r-in"><span><span class="va">mobility_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate_mobility_data.html">generate_mobility_data</a></span><span class="op">(</span>n_classes <span class="op">=</span> <span class="fl">6</span>, seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">seg</span> <span class="op">&lt;-</span> <span class="fu"><a href="moneca.html">moneca</a></span><span class="op">(</span><span class="va">mobility_data</span>, segment.levels <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |==========                                                            |  14%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25% ready!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |====================                                                  |  29%  |                                                                              |==============================                                        |  43%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50% ready!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |========================================                              |  57%  |                                                                              |==================================================                    |  71%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75% ready!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |============================================================          |  86%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100% ready!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Basic stair plot</span></span></span>
<span class="r-in"><span><span class="va">stair_plots</span> <span class="op">&lt;-</span> <span class="fu">plot_stair_ggraph</span><span class="op">(</span><span class="va">seg</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Customized stair plot with specific levels</span></span></span>
<span class="r-in"><span><span class="va">custom_stair</span> <span class="op">&lt;-</span> <span class="fu">plot_stair_ggraph</span><span class="op">(</span><span class="va">seg</span>, </span></span>
<span class="r-in"><span>                                 levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                 layout <span class="op">=</span> <span class="st">"stress"</span>,</span></span>
<span class="r-in"><span>                                 ncol <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                                 node_color <span class="op">=</span> <span class="st">"mobility"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Stair plot with custom organizational labels</span></span></span>
<span class="r-in"><span><span class="va">org_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mobility_data</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mobility_data</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  segment_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C-Suite"</span>, <span class="st">"VP Level"</span>, <span class="st">"Director Level"</span>, </span></span>
<span class="r-in"><span>                    <span class="st">"Manager Level"</span>, <span class="st">"Staff Level"</span>, <span class="st">"Entry Level"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mobility_data</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mobility_data</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">org_stair</span> <span class="op">&lt;-</span> <span class="fu">plot_stair_ggraph</span><span class="op">(</span><span class="va">seg</span>, </span></span>
<span class="r-in"><span>                              segment_naming <span class="op">=</span> <span class="va">org_labels</span>,</span></span>
<span class="r-in"><span>                              ncol <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                              title <span class="op">=</span> <span class="st">"Organizational Hierarchy Evolution"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Return individual plots for further customization</span></span></span>
<span class="r-in"><span><span class="va">plot_list</span> <span class="op">&lt;-</span> <span class="fu">plot_stair_ggraph</span><span class="op">(</span><span class="va">seg</span>, combine_plots <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Modify individual plots</span></span></span>
<span class="r-in"><span><span class="va">plot_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">plot_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>subtitle <span class="op">=</span> <span class="st">"Level 2"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Display plots with custom labels</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">org_stair</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Save individual plots</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">plot_list</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"level_"</span>, <span class="va">i</span>, <span class="st">".png"</span><span class="op">)</span>, <span class="va">plot_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Giampaolo Montaletti, Jonas Touboel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

